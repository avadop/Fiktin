{"remainingRequest":"C:\\Users\\deita\\GoogleDrive\\5º\\TFG\\Fiktin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\deita\\GoogleDrive\\5º\\TFG\\Fiktin\\node_modules\\vue-upload-image\\dist\\upload_image.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\deita\\GoogleDrive\\5º\\TFG\\Fiktin\\node_modules\\vue-upload-image\\dist\\upload_image.vue","mtime":499162500000},{"path":"C:\\Users\\deita\\GoogleDrive\\5º\\TFG\\Fiktin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\deita\\GoogleDrive\\5º\\TFG\\Fiktin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\deita\\GoogleDrive\\5º\\TFG\\Fiktin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\deita\\GoogleDrive\\5º\\TFG\\Fiktin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICd1cGxvYWQtaW1hZ2UnLAogICAgcHJvcHM6IHsKICAgICAgICBpbnB1dF9pZDogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICAgICAgZGVmYXVsdDogImRlZmF1bHQiCiAgICAgICAgfSwKICAgICAgICB1cmw6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgIH0sCiAgICAgICAgbmFtZTogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICAgICAgZGVmYXVsdDogJ2ltYWdlc1tdJwogICAgICAgIH0sCiAgICAgICAgZGlzYWJsZV91cGxvYWQ6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgbWF4X2JhdGNoOiB7CiAgICAgICAgICAgIHR5cGU6IE51bWJlciwKICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICBkZWZhdWx0OiAwCiAgICAgICAgfSwKICAgICAgICBtYXhfZmlsZXM6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgICAgIGRlZmF1bHQ6IDEwCiAgICAgICAgfSwKICAgICAgICBtYXhfZmlsZXNpemU6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgICAgIGRlZmF1bHQ6IDgwMDAKICAgICAgICB9LAogICAgICAgIHJlc2l6ZV9lbmFibGVkOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICB9LAogICAgICAgIHJlc2l6ZV9tYXhfd2lkdGg6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgICAgIGRlZmF1bHQ6IDgwMAogICAgICAgIH0sCiAgICAgICAgcmVzaXplX21heF9oZWlnaHQ6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgICAgIGRlZmF1bHQ6IDYwMAogICAgICAgIH0sCiAgICAgICAgYnV0dG9uX2h0bWw6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgICAgIGRlZmF1bHQ6ICdVcGxvYWQgSW1hZ2VzJwogICAgICAgIH0sCiAgICAgICAgYnV0dG9uX2NsYXNzOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgICBkZWZhdWx0OiAnYnRuIGJ0bi1wcmltYXJ5JwogICAgICAgIH0KICAgIH0sCiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZm9ybTogbnVsbCwKICAgICAgICAgICAgaW5wdXQ6IG51bGwsCiAgICAgICAgICAgIGluZGV4OiAwLAogICAgICAgICAgICB0b3RhbDogMCwKICAgICAgICAgICAgZmlsZXM6IHt9LAogICAgICAgICAgICBpbWFnZToge30sCiAgICAgICAgICAgIGJhdGNoOiB7fSwKICAgICAgICAgICAgb25EcmFnb3ZlcjogZmFsc2UsCiAgICAgICAgICAgIG9uVXBsb2FkaW5nOiBmYWxzZQogICAgICAgIH0KICAgIH0sCiAgICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5mb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VwbG9hZF9pbWFnZV9mb3JtLS0nICsgdGhpcy5pbnB1dF9pZCk7CiAgICAgICAgdGhpcy5pbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cGxvYWRfaW1hZ2VfZm9ybV9faW5wdXQtLScgKyB0aGlzLmlucHV0X2lkKTsKCiAgICAgICAgWydkcmFnJywgJ2RyYWdzdGFydCcsICdkcmFnZW5kJywKICAgICAgICAgICAgJ2RyYWdvdmVyJywgJ2RyYWdlbnRlcicsICdkcmFnbGVhdmUnLCAnZHJvcCddLmZvckVhY2goZXZlbnQgPT4gdGhpcy5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIChlKSA9PiB7CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICB9KSk7CgogICAgICAgIFsnZHJhZ292ZXInLCAnZHJhZ2VudGVyJ10KICAgICAgICAgICAgLmZvckVhY2goZXZlbnQgPT4gdGhpcy5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIHRoaXMuZHJhZ0VudGVyKSk7CgogICAgICAgIFsnZHJhZ2xlYXZlJywgJ2RyYWdlbmQnLCAnZHJvcCddCiAgICAgICAgICAgIC5mb3JFYWNoKGV2ZW50ID0+IHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCB0aGlzLmRyYWdMZWF2ZSkpOwoKICAgICAgICBbJ2Ryb3AnXQogICAgICAgICAgICAuZm9yRWFjaChldmVudCA9PiB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5maWxlRHJvcCkpOwoKICAgICAgICBbJ2NoYW5nZSddCiAgICAgICAgICAgIC5mb3JFYWNoKGV2ZW50ID0+IHRoaXMuaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5maWxlRHJvcCkpOwoKICAgICAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgICAgICB0aGlzLmlucHV0LmNsaWNrKCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIF9jYW5feGhyKCkgewogICAgICAgICAgICBpZiAodGhpcy50b3RhbCA+PSB0aGlzLm1heF9maWxlcykgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCiAgICAgICAgX2Nhbl91cGxvYWRfZmlsZShrZXkpIHsKICAgICAgICAgICAgbGV0IGZpbGUgPSB0aGlzLmZpbGVzW2tleV07CgogICAgICAgICAgICBpZiAoZmlsZS5hdHRlbXB0ZWQgfHwgZmlsZS5iYWRfc2l6ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCiAgICAgICAgX3hocjogZnVuY3Rpb24gKGZvcm1EYXRhLCBrZXlzLCBjYWxsYmFjaykgewogICAgICAgICAgICB0aGlzLm9uVXBsb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBsb2FkLWltYWdlLWF0dGVtcHQnLCBmb3JtRGF0YSk7CgogICAgICAgICAgICBrZXlzLmZvckVhY2goKGtleSkgPT4gewogICAgICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuZmlsZXNba2V5XSwgJ2F0dGVtcHRlZCcsIHRydWUpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHRoaXMuJGh0dHAucG9zdCh0aGlzLnVybCwgZm9ybURhdGEpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICBrZXlzLmZvckVhY2goKGtleSkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmZpbGVzW2tleV0sICd1cGxvYWRlZCcsIHRydWUpOwoKICAgICAgICAgICAgICAgICAgICB0aGlzLnRvdGFsKys7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGxvYWQtaW1hZ2Utc3VjY2VzcycsIFtmb3JtRGF0YSwgcmVzcG9uc2VdKTsKICAgICAgICAgICAgfSwgKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGxvYWQtaW1hZ2UtZmFpbHVyZScsIFtmb3JtRGF0YSwgcmVzcG9uc2VdKTsKICAgICAgICAgICAgfSkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMub25VcGxvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHVwbG9hZDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoIXRoaXMuX2Nhbl94aHIoKSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuZmlsZXMpIHsKICAgICAgICAgICAgICAgIGlmICghdGhpcy5fY2FuX3VwbG9hZF9maWxlKGtleSkpIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKHRoaXMubmFtZSwgdGhpcy5maWxlc1trZXldLmZpbGUsIHRoaXMuZmlsZXNba2V5XS5uYW1lKTsKCiAgICAgICAgICAgICAgICB0aGlzLl94aHIoZm9ybURhdGEsIFtrZXldLCB0aGlzLnVwbG9hZCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHVwbG9hZF9iYXRjaDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoIXRoaXMuX2Nhbl94aHIoKSkgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuYmF0Y2gpIHsKICAgICAgICAgICAgICAgIHRoaXMuX3hocih0aGlzLmJhdGNoW2tleV0uZm9ybSwgdGhpcy5iYXRjaFtrZXldLmtleXMsIHRoaXMudXBsb2FkX2JhdGNoKTsKCiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5iYXRjaFtrZXldOwoKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjcmVhdGVfYmF0Y2g6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgbGV0IGluZGV4ID0gMDsKICAgICAgICAgICAgbGV0IGNvdW50ID0gMDsKCiAgICAgICAgICAgIHRoaXMuYmF0Y2ggPSB7fTsKCiAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLmZpbGVzKSB7CiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2Nhbl91cGxvYWRfZmlsZShrZXkpKSBjb250aW51ZTsKCiAgICAgICAgICAgICAgICBpZiAodGhpcy5iYXRjaFtpbmRleF0gPT0gbnVsbCB8fCBjb3VudCA9PSB0aGlzLm1heF9iYXRjaCkgewogICAgICAgICAgICAgICAgICAgIGluZGV4Kys7CiAgICAgICAgICAgICAgICAgICAgY291bnQgPSAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYmF0Y2hbaW5kZXhdID0ge2Zvcm06IG5ldyBGb3JtRGF0YSgpLCBrZXlzOiBbXX07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY291bnQrKzsKICAgICAgICAgICAgICAgIHRoaXMuYmF0Y2hbaW5kZXhdWydrZXlzJ10ucHVzaChrZXkpOwogICAgICAgICAgICAgICAgdGhpcy5iYXRjaFtpbmRleF1bJ2Zvcm0nXS5hcHBlbmQodGhpcy5uYW1lLCB0aGlzLmZpbGVzW2tleV0uZmlsZSwgdGhpcy5maWxlc1trZXldLm5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBzdWJtaXQ6IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKCiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwbG9hZC1pbWFnZS1zdWJtaXQnLCB0aGlzLmZpbGVzKTsKCiAgICAgICAgICAgIGlmKCF0aGlzLmRpc2FibGVfdXBsb2FkICYmICF0aGlzLm9uVXBsb2FkaW5nKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5tYXhfYmF0Y2ggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVfYmF0Y2goKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy51cGxvYWRfYmF0Y2goKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMudXBsb2FkKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGRyYWdFbnRlcjogZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICB0aGlzLm9uRHJhZ292ZXIgPSB0cnVlOwogICAgICAgIH0sCiAgICAgICAgZHJhZ0xlYXZlOiBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIHRoaXMub25EcmFnb3ZlciA9IGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgZmlsZURyb3A6IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgICAgIGxldCBuZXdGaWxlcyA9IGUudGFyZ2V0LmZpbGVzIHx8IGUuZGF0YVRyYW5zZmVyLmZpbGVzOwoKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdGaWxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuZmlsZXMsIHRoaXMuaW5kZXgsIG5ld0ZpbGVzW2ldKTsKCiAgICAgICAgICAgICAgICBpZiAobmV3RmlsZXNbaV0udHlwZS5tYXRjaCgvaW1hZ2UuKi8pKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlSW5pdCh0aGlzLmluZGV4KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVSZWFkKHRoaXMuaW5kZXgpOwoKICAgICAgICAgICAgICAgICAgICB0aGlzLmluZGV4Kys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZS50YXJnZXQudmFsdWUgPSAnJzsKICAgICAgICB9LAogICAgICAgIGZpbGVJbml0OiBmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICAgIGxldCBmaWxlID0gdGhpcy5maWxlc1trZXldOwoKICAgICAgICAgICAgdGhpcy5maWxlc1trZXldID0gewogICAgICAgICAgICAgICAgbmFtZTogdGhpcy5maWxlc1trZXldLm5hbWUsCiAgICAgICAgICAgICAgICBmaWxlOiB0aGlzLmZpbGVzW2tleV0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGlmICgoZmlsZS5zaXplICogMC4wMDEpID4gdGhpcy5tYXhfZmlsZXNpemUpIHsKICAgICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmZpbGVzW2tleV0sICdiYWRfc2l6ZScsIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmaWxlUmVhZDogZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCiAgICAgICAgICAgIHJlYWRlci5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgKGUpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmltYWdlLCBrZXksIHJlYWRlci5yZXN1bHQpOwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlc2l6ZV9lbmFibGVkKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGltYWdlciA9IG5ldyBJbWFnZSgpOwoKICAgICAgICAgICAgICAgICAgICBpbWFnZXIub25sb2FkID0gKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgd2lkdGggPSBpbWFnZXIud2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoZWlnaHQgPSBpbWFnZXIuaGVpZ2h0OwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpZHRoID4gdGhpcy5yZXNpemVfbWF4X3dpZHRoIHx8IGhlaWdodCA+IHRoaXMucmVzaXplX21heF9oZWlnaHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoaGVpZ2h0IC8gd2lkdGgpIC0gKHRoaXMucmVzaXplX21heF9oZWlnaHQgLyB0aGlzLnJlc2l6ZV9tYXhfd2lkdGgpID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gdGhpcy5yZXNpemVfbWF4X2hlaWdodCAvIGhlaWdodCAqIHdpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IHRoaXMucmVzaXplX21heF9oZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IHRoaXMucmVzaXplX21heF93aWR0aCAvIHdpZHRoICogaGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gdGhpcy5yZXNpemVfbWF4X3dpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0OwoKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKGltYWdlciwgMCwgMCwgd2lkdGgsIGhlaWdodCk7CgogICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3SW1hZ2VEYXRhID0gY2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIik7CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzZXQodGhpcy5pbWFnZSwga2V5LCBuZXdJbWFnZURhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGltZyA9IGF0b2IobmV3SW1hZ2VEYXRhLnNwbGl0KCcsJylbMV0pOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW1nX2J1ZmZlciA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChpIDwgaW1nLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nX2J1ZmZlci5wdXNoKGltZy5jaGFyQ29kZUF0KGkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgdThJbWFnZSA9IG5ldyBVaW50OEFycmF5KGltZ19idWZmZXIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuZmlsZXMsIGtleSwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5maWxlc1trZXldLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlOiBuZXcgQmxvYihbdThJbWFnZV0sIHtmaWxlbmFtZTogdGhpcy5maWxlc1trZXldLm5hbWV9KQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwbG9hZC1pbWFnZS1sb2FkZWQnLCB0aGlzLmZpbGVzW2tleV0pOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgaW1hZ2VyLnNyYyA9IHJlYWRlci5yZXN1bHQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwodGhpcy5maWxlc1trZXldLmZpbGUpOwogICAgICAgIH0sCiAgICAgICAgZmlsZURlbGV0ZTogZnVuY3Rpb24gKGUsIGtleSkgewogICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGxvYWQtaW1hZ2UtcmVtb3ZlZCcsIHRoaXMuZmlsZXNba2V5XSk7CiAgICAgICAgICAgIHRoaXMuJGRlbGV0ZSh0aGlzLmZpbGVzLCBrZXkpOwogICAgICAgICAgICB0aGlzLiRkZWxldGUodGhpcy5pbWFnZSwga2V5KTsKICAgICAgICB9LAogICAgICAgIGZpbGVDbGljazogZnVuY3Rpb24gKGUsIGtleSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwbG9hZC1pbWFnZS1jbGlja2VkJywgdGhpcy5maWxlc1trZXldKTsKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["upload_image.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"upload_image.vue","sourceRoot":"node_modules/vue-upload-image/dist","sourcesContent":["<template>\r\n    <div class=\"vue_component__upload--image\" v-bind:class=\"{ 'dragover': onDragover }\">\r\n        <form v-bind:id=\"'upload_image_form--' + input_id\" enctype=\"multipart/form-data\">\r\n            <div class=\"upload_image_form__thumbnails\">\r\n                <div v-for=\"(value, key) in files\" class=\"upload_image_form__thumbnail\"\r\n                     v-on:click=\"fileClick($event, key)\"\r\n                     v-bind:class=\"{ 'uploaded': value.uploaded, 'bad-size': value.bad_size }\">\r\n                    <span v-on:click=\"fileDelete($event, key)\">\r\n                    &#x2716;\r\n                    </span>\r\n                    <img v-bind:src=\"image[key]\" v-bind:class=\"{ 'show': image[key]}\">\r\n                </div>\r\n            </div>\r\n            <input type=\"file\" v-bind:id=\"'upload_image_form__input--' + input_id\" hidden multiple/>\r\n            <div>\r\n                <button type=\"submit\"\r\n                        v-bind:class=\"button_class\"\r\n                        v-on:click=\"submit\"\r\n                        v-bind:disabled=\"onUploading\"\r\n                        v-html=\"button_html\"></button>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: 'upload-image',\r\n        props: {\r\n            input_id: {\r\n                type: String,\r\n                required: false,\r\n                default: \"default\"\r\n            },\r\n            url: {\r\n                type: String,\r\n                required: true,\r\n                default: null\r\n            },\r\n            name: {\r\n                type: String,\r\n                required: false,\r\n                default: 'images[]'\r\n            },\r\n            disable_upload: {\r\n                type: Boolean,\r\n                required: false,\r\n                default: false\r\n            },\r\n            max_batch: {\r\n                type: Number,\r\n                required: false,\r\n                default: 0\r\n            },\r\n            max_files: {\r\n                type: Number,\r\n                required: false,\r\n                default: 10\r\n            },\r\n            max_filesize: {\r\n                type: Number,\r\n                required: false,\r\n                default: 8000\r\n            },\r\n            resize_enabled: {\r\n                type: Boolean,\r\n                required: false,\r\n                default: false\r\n            },\r\n            resize_max_width: {\r\n                type: Number,\r\n                required: false,\r\n                default: 800\r\n            },\r\n            resize_max_height: {\r\n                type: Number,\r\n                required: false,\r\n                default: 600\r\n            },\r\n            button_html: {\r\n                type: String,\r\n                required: false,\r\n                default: 'Upload Images'\r\n            },\r\n            button_class: {\r\n                type: String,\r\n                required: false,\r\n                default: 'btn btn-primary'\r\n            }\r\n        },\r\n        data: function () {\r\n            return {\r\n                form: null,\r\n                input: null,\r\n                index: 0,\r\n                total: 0,\r\n                files: {},\r\n                image: {},\r\n                batch: {},\r\n                onDragover: false,\r\n                onUploading: false\r\n            }\r\n        },\r\n        mounted: function () {\r\n            this.form = document.getElementById('upload_image_form--' + this.input_id);\r\n            this.input = document.getElementById('upload_image_form__input--' + this.input_id);\r\n\r\n            ['drag', 'dragstart', 'dragend',\r\n                'dragover', 'dragenter', 'dragleave', 'drop'].forEach(event => this.form.addEventListener(event, (e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }));\r\n\r\n            ['dragover', 'dragenter']\r\n                .forEach(event => this.form.addEventListener(event, this.dragEnter));\r\n\r\n            ['dragleave', 'dragend', 'drop']\r\n                .forEach(event => this.form.addEventListener(event, this.dragLeave));\r\n\r\n            ['drop']\r\n                .forEach(event => this.form.addEventListener(event, this.fileDrop));\r\n\r\n            ['change']\r\n                .forEach(event => this.input.addEventListener(event, this.fileDrop));\r\n\r\n            this.form.addEventListener('click', (e) => {\r\n                this.input.click();\r\n            });\r\n        },\r\n        methods: {\r\n            _can_xhr() {\r\n                if (this.total >= this.max_files) {\r\n                    return false;\r\n                }\r\n                return true;\r\n            },\r\n            _can_upload_file(key) {\r\n                let file = this.files[key];\r\n\r\n                if (file.attempted || file.bad_size) {\r\n                    return false;\r\n                }\r\n                return true;\r\n            },\r\n            _xhr: function (formData, keys, callback) {\r\n                this.onUploading = true;\r\n                this.$emit('upload-image-attempt', formData);\r\n\r\n                keys.forEach((key) => {\r\n                    this.$set(this.files[key], 'attempted', true);\r\n                });\r\n\r\n                this.$http.post(this.url, formData).then((response) => {\r\n                    keys.forEach((key) => {\r\n                        this.$set(this.files[key], 'uploaded', true);\r\n\r\n                        this.total++;\r\n                    });\r\n\r\n                    this.$emit('upload-image-success', [formData, response]);\r\n                }, (response) => {\r\n                    this.$emit('upload-image-failure', [formData, response]);\r\n                }).then((response) => {\r\n                    this.onUploading = false;\r\n\r\n                    callback();\r\n                });\r\n            },\r\n            upload: function () {\r\n                if (!this._can_xhr()) return false;\r\n\r\n                for (let key in this.files) {\r\n                    if (!this._can_upload_file(key)) continue;\r\n\r\n                    let formData = new FormData();\r\n                    formData.append(this.name, this.files[key].file, this.files[key].name);\r\n\r\n                    this._xhr(formData, [key], this.upload);\r\n\r\n                    return true;\r\n                }\r\n            },\r\n            upload_batch: function () {\r\n                if (!this._can_xhr()) return false;\r\n\r\n                for (let key in this.batch) {\r\n                    this._xhr(this.batch[key].form, this.batch[key].keys, this.upload_batch);\r\n\r\n                    delete this.batch[key];\r\n\r\n                    return true;\r\n                }\r\n            },\r\n            create_batch: function () {\r\n                let index = 0;\r\n                let count = 0;\r\n\r\n                this.batch = {};\r\n\r\n                for (let key in this.files) {\r\n                    if (!this._can_upload_file(key)) continue;\r\n\r\n                    if (this.batch[index] == null || count == this.max_batch) {\r\n                        index++;\r\n                        count = 0;\r\n                        this.batch[index] = {form: new FormData(), keys: []};\r\n                    }\r\n\r\n                    count++;\r\n                    this.batch[index]['keys'].push(key);\r\n                    this.batch[index]['form'].append(this.name, this.files[key].file, this.files[key].name);\r\n                }\r\n            },\r\n            submit: function (e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n\r\n                this.$emit('upload-image-submit', this.files);\r\n\r\n                if(!this.disable_upload && !this.onUploading) {\r\n                    if (this.max_batch > 1) {\r\n                        this.create_batch();\r\n                        return this.upload_batch();\r\n                    }\r\n                    this.upload();\r\n                }\r\n            },\r\n            dragEnter: function (e) {\r\n                e.preventDefault();\r\n                this.onDragover = true;\r\n            },\r\n            dragLeave: function (e) {\r\n                e.preventDefault();\r\n                this.onDragover = false;\r\n            },\r\n            fileDrop: function (e) {\r\n                e.preventDefault();\r\n\r\n                let newFiles = e.target.files || e.dataTransfer.files;\r\n\r\n                for (let i = 0; i < newFiles.length; i++) {\r\n                    this.$set(this.files, this.index, newFiles[i]);\r\n\r\n                    if (newFiles[i].type.match(/image.*/)) {\r\n                        this.fileInit(this.index);\r\n                        this.fileRead(this.index);\r\n\r\n                        this.index++;\r\n                    }\r\n                    ;\r\n                }\r\n                e.target.value = '';\r\n            },\r\n            fileInit: function (key) {\r\n                let file = this.files[key];\r\n\r\n                this.files[key] = {\r\n                    name: this.files[key].name,\r\n                    file: this.files[key]\r\n                };\r\n\r\n                if ((file.size * 0.001) > this.max_filesize) {\r\n                    this.$set(this.files[key], 'bad_size', true);\r\n                }\r\n            },\r\n            fileRead: function (key) {\r\n                let reader = new FileReader();\r\n\r\n                reader.addEventListener(\"load\", (e) => {\r\n                    this.$set(this.image, key, reader.result);\r\n\r\n                    if (this.resize_enabled) {\r\n                        let imager = new Image();\r\n\r\n                        imager.onload = () => {\r\n                            let width = imager.width;\r\n                            let height = imager.height;\r\n\r\n                            if (width > this.resize_max_width || height > this.resize_max_height) {\r\n                                if ((height / width) - (this.resize_max_height / this.resize_max_width) > 0) {\r\n                                    width = this.resize_max_height / height * width;\r\n                                    height = this.resize_max_height;\r\n                                } else {\r\n                                    height = this.resize_max_width / width * height;\r\n                                    width = this.resize_max_width;\r\n                                }\r\n                            }\r\n\r\n                            let canvas = document.createElement(\"canvas\");\r\n                            canvas.width = width;\r\n                            canvas.height = height;\r\n\r\n                            let ctx = canvas.getContext(\"2d\");\r\n                            ctx.drawImage(imager, 0, 0, width, height);\r\n\r\n                            let newImageData = canvas.toDataURL(\"image/png\");\r\n\r\n                            this.$set(this.image, key, newImageData);\r\n\r\n                            //\r\n                            let img = atob(newImageData.split(',')[1]);\r\n                            let img_buffer = [];\r\n                            let i = 0;\r\n                            while (i < img.length) {\r\n                                img_buffer.push(img.charCodeAt(i));\r\n                                i++;\r\n                            }\r\n                            let u8Image = new Uint8Array(img_buffer);\r\n\r\n                            this.$set(this.files, key, {\r\n                                name: this.files[key].name,\r\n                                file: new Blob([u8Image], {filename: this.files[key].name})\r\n                            });\r\n\r\n                            this.$emit('upload-image-loaded', this.files[key]);\r\n                        };\r\n                        imager.src = reader.result;\r\n                    }\r\n                });\r\n\r\n                reader.readAsDataURL(this.files[key].file);\r\n            },\r\n            fileDelete: function (e, key) {\r\n                this.$emit('upload-image-removed', this.files[key]);\r\n                this.$delete(this.files, key);\r\n                this.$delete(this.image, key);\r\n            },\r\n            fileClick: function (e, key) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this.$emit('upload-image-clicked', this.files[key]);\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"css\" scoped>\r\n    .vue_component__upload--image {\r\n        padding: 5px;\r\n        cursor: pointer;\r\n        min-height: 80px;\r\n        border-radius: 5px;\r\n    }\r\n\r\n    .vue_component__upload--image.dragover {\r\n    }\r\n\r\n    .vue_component__upload--image form > div {\r\n        text-align: center;\r\n    }\r\n\r\n    .vue_component__upload--image .upload_image_form__thumbnails {\r\n        margin-bottom: 1em;\r\n    }\r\n\r\n    .vue_component__upload--image .upload_image_form__thumbnail {\r\n        border-radius: 2.5px;\r\n        position: relative;\r\n        width: 20%;\r\n        padding: 20% 0 0;\r\n        overflow: hidden;\r\n        margin: 10px;\r\n        display: inline-block;\r\n    }\r\n\r\n    .vue_component__upload--image .upload_image_form__thumbnail img {\r\n        position: absolute;\r\n        top: 50%;\r\n        left: 50%;\r\n        min-width: 100%;\r\n        min-height: 100%;\r\n        max-height: 150%;\r\n        opacity: 0;\r\n        transform: translateX(-50%) translateY(-50%);\r\n        transition: 1s opacity;\r\n    }\r\n\r\n    .vue_component__upload--image .upload_image_form__thumbnail img.show {\r\n        opacity: 1;\r\n    }\r\n\r\n    .vue_component__upload--image .upload_image_form__thumbnail img:hover {\r\n        filter: blur(2px);\r\n    }\r\n\r\n    .vue_component__upload--image .upload_image_form__thumbnail.bad-size img {\r\n        filter: grayscale(100%);\r\n    }\r\n\r\n    .vue_component__upload--image .upload_image_form__thumbnail.uploaded img {\r\n        opacity: 0.1;\r\n    }\r\n\r\n    .vue_component__upload--image .upload_image_form__thumbnail span {\r\n        position: absolute;\r\n        top: -5px;\r\n        left: 0px;\r\n        z-index: 100;\r\n        padding: 0px 1px;\r\n        border-radius: 2px;\r\n        background-color: grey;\r\n    }\r\n</style>\r\n"]}]}