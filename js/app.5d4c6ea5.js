(function(t){function e(e){for(var n,o,r=e[0],c=e[1],l=e[2],d=0,h=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&h.push(s[o][0]),s[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(h.length)h.shift()();return a.push.apply(a,l||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],n=!0,r=1;r<i.length;r++){var c=i[r];0!==s[c]&&(n=!1)}n&&(a.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},s={app:0},a=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/Fiktin/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"025a":function(t,e,i){},"034f":function(t,e,i){"use strict";var n=i("85ec"),s=i.n(n);s.a},"0681":function(t,e,i){"use strict";var n=i("8d8f"),s=i.n(n);s.a},"096b":function(t,e,i){"use strict";var n=i("198b"),s=i.n(n);s.a},"0a98":function(t,e,i){},"0cd6":function(t,e,i){"use strict";var n=i("2d36"),s=i.n(n);s.a},"0ddc":function(t,e,i){},"13e5":function(t,e,i){"use strict";var n=i("6114"),s=i.n(n);s.a},"18e5":function(t,e,i){},"198b":function(t,e,i){},"1fbf":function(t,e,i){},"290a":function(t,e,i){"use strict";var n=i("c9bd"),s=i.n(n);s.a},"2ac2":function(t,e,i){},"2bf7":function(t,e,i){},"2d36":function(t,e,i){},"2e1f":function(t,e,i){},"31b2":function(t,e,i){"use strict";var n=i("e59b"),s=i.n(n);s.a},"324c":function(t,e,i){},"389d":function(t,e,i){"use strict";var n=i("665a"),s=i.n(n);s.a},"3f1e":function(t,e,i){},4618:function(t,e,i){},"4a83":function(t,e,i){},"4e1a":function(t,e,i){"use strict";var n=i("5de4"),s=i.n(n);s.a},5140:function(t,e,i){"use strict";var n=i("e3e7"),s=i.n(n);s.a},5337:function(t,e,i){"use strict";var n=i("0ddc"),s=i.n(n);s.a},5467:function(t,e,i){},"557e":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",[n("b-navbar",{staticClass:"navbar-color",attrs:{toggleable:"lg"}},[n("b-navbar-brand",[n("router-link",{staticClass:"main-nav-ref",attrs:{to:"/"}},[n("img",{attrs:{width:"120px",src:i("b380")}})])],1),n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),t.loggedIn?n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",[n("b-nav-item",[n("router-link",{staticClass:"nav-ref",attrs:{to:"/"}},[t._v("Inicio")])],1),n("b-nav-item",[n("router-link",{staticClass:"nav-ref",attrs:{to:"/books"}},[t._v("Mis libros")])],1),n("b-nav-item",[n("router-link",{staticClass:"nav-ref",attrs:{to:"/libraries"}},[t._v("Bibliotecas ")])],1)],1),n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item",[n("router-link",{attrs:{to:"/user"}},[n("div",{staticClass:"h4 nav-ref",staticStyle:{"font-size":"24px"}},[n("b-icon",{attrs:{icon:"person"}})],1)])],1),n("b-nav-item",[n("div",{staticClass:"h4 nav-ref",staticStyle:{"font-size":"24px"},on:{click:t.confirmLogOut}},[n("b-icon",{attrs:{icon:"power"}})],1)])],1)],1):n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",[n("b-nav-item",[n("router-link",{staticClass:"nav-ref",attrs:{to:"/"}},[t._v("Inicio")])],1),n("b-nav-item",{on:{click:function(e){return t.needLogIn("/books")}}},[n("div",{staticClass:"nav-ref"},[t._v("Mis libros")])]),n("b-nav-item",{on:{click:function(e){return t.needLogIn("/libraries")}}},[n("div",{staticClass:"nav-ref"},[t._v("Bibliotecas")])])],1),n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item",{on:{click:function(e){return t.needLogIn("/")}}},[n("div",{staticClass:"nav-ref"},[t._v("Iniciar sesión")])]),n("b-nav-item",{on:{click:function(e){return t.createUser("/")}}},[n("div",{staticClass:"nav-ref"},[t._v("Crear usuario")])])],1)],1)],1),n("router-view",{on:{deleteUser:t.deleteUser}})],1),n("b-modal",{attrs:{"hide-footer":"","hide-header":"","no-close-on-backdrop":""},model:{value:t.modalLogOut,callback:function(e){t.modalLogOut=e},expression:"modalLogOut"}},[n("div",{staticClass:"d-block text-center"},[n("h3",[t._v("Cerrar Sesión")]),n("p",[t._v("¿Está seguro que desea cerrar sesión?")])]),n("b-button",{staticClass:"mt-3",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-danger",block:""},on:{click:t.logOut}},[t._v("Si")]),n("b-button",{staticClass:"mt-2",staticStyle:{"font-size":"16px"},attrs:{variant:"primary",block:""},on:{click:function(e){t.modalLogOut=!1}}},[t._v("Cancelar")])],1),n("b-modal",{attrs:{"hide-footer":"","hide-header":"","no-close-on-backdrop":"",centered:""},model:{value:t.modalLogIn,callback:function(e){t.modalLogIn=e},expression:"modalLogIn"}},[n("start",{attrs:{urlLogIn:t.urlLogIn,optionStart:t.optionStart},on:{loggedIn:t.logIn}}),n("b-button",{staticClass:"mt-2",staticStyle:{"font-size":"14px"},attrs:{variant:"outline-secondary",size:"sm",block:""},on:{click:function(e){t.modalLogIn=!1}}},[t._v("Cancelar")])],1)],1)},a=[],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"start"},[i("div",{attrs:{id:"options-menu"}},[t.create?i("div",[i("LogIn",{attrs:{url:t.urlLogIn},on:{loggedIn:t.logIn,switchCreate:t.switchCreate}})],1):i("div",[i("NewUser",{on:{switchCreate:t.switchCreate}})],1)])])},r=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"new-user"},[i("form",[i("h3",[t._v("Registro")]),i("div",{staticClass:"form-div"},[i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"person"}}),0===t.newNick.length?i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"text",trim:"","aria-describedby":"input-live-help input-live-feedback",placeholder:"Usuario"},model:{value:t.newNick,callback:function(e){t.newNick=e},expression:"newNick"}}):i("b-form-input",{staticClass:"input-form",attrs:{type:"text",trim:"",state:!t.exists&&t.newNick.length>=4&&t.newNick.length<=10,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Usuario"},model:{value:t.newNick,callback:function(e){t.newNick=e},expression:"newNick"}}),t.exists?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Nombre se usuario ya existente ")]):t.newNick.length<4?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Mínimo 4 caracteres ")]):t.newNick.length>10?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Máximo 10 caracteres ")]):t._e()],1),i("br"),i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"person-lines-fill"}}),i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"text","aria-describedby":"input-live-help input-live-feedback",placeholder:"Nombre"},model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}})],1),i("br"),i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"envelope"}}),i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"text","aria-describedby":"input-live-help input-live-feedback",placeholder:"Email"},model:{value:t.newEmail,callback:function(e){t.newEmail=e},expression:"newEmail"}})],1),i("br"),i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"shield-lock"}}),0===t.newPassword.length?i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"password",trim:"","aria-describedby":"input-live-help input-live-feedback",placeholder:"Contraseña"},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}):i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"password",trim:"",state:t.newPassword.length>=6&&t.newPassword.length<=12,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Contraseña"},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),t.newPassword.length>0&&t.newPassword.length<6?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Mínimo 6 caracteres ")]):t.newPassword.length>0&&t.newPassword.length>12?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Máximo 12 caracteres ")]):t._e()],1),i("br"),i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"shield-lock-fill"}}),0===t.newPassword2.length?i("b-form-input",{staticClass:"ml-2 input-form",attrs:{trim:"",type:"password","aria-describedby":"input-live-help input-live-feedback",placeholder:"Confirmar contraseña"},model:{value:t.newPassword2,callback:function(e){t.newPassword2=e},expression:"newPassword2"}}):i("b-form-input",{staticClass:"ml-2 input-form",attrs:{trim:"",type:"password",state:t.newPassword2===t.newPassword,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Confirmar contraseña"},model:{value:t.newPassword2,callback:function(e){t.newPassword2=e},expression:"newPassword2"}}),t.newPassword2.length>0&&t.newPassword2!==t.newPassword?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Las contraseñas deben coincidir ")]):t._e()],1)]),i("br"),i("br"),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("b-container",{attrs:{sm:"3"}},[i("label",[t._v("Imagen de perfil:")]),null!=this.picture?i("b-button",{staticClass:"my-2",staticStyle:{"font-size":"16px"},attrs:{variant:"danger-dark"},on:{click:t.removeImg}},[i("b-icon",{attrs:{variant:"danger",icon:"x"}})],1):t._e(),i("b-form-file",{directives:[{name:"show",rawName:"v-show",value:0==this.uploadValue&&null==this.picture,expression:"this.uploadValue==0 && this.picture == null"}],staticClass:"my-2",attrs:{placeholder:"Selecciona una imagen","drop-placeholder":"Arrastra aquí la imagen...",accept:"image/*"},on:{change:t.onFileSelected}})],1),i("div",{staticClass:"card-img-box"},[i("img",{staticClass:"card-img-top",attrs:{src:this.picture,alt:"No has subido ninguna imagen"}})])],1),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light"},on:{click:t.switchCreate}},[t._v("Iniciar sesión")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"dark",type:"submit"},on:{click:t.addUser}},[t._v("Crear")])],1)])},l=[],u=(i("99af"),i("caad"),i("b0c0"),i("d3b7"),i("2532"),i("96cf"),i("59ca")),d=i.n(u),h=(i("e71f"),i("66ce"),i("588e"),{apiKey:"AIzaSyBTbP0C9dh3olwn1XowNAhKnZ02Kgsz8UI",authDomain:"fiktin-cac14.firebaseapp.com",databaseURL:"https://fiktin-cac14.firebaseio.com",projectId:"fiktin-cac14",storageBucket:"fiktin-cac14.appspot.com",messagingSenderId:"898364500542",appId:"1:898364500542:web:3dbaffbcae8951938aff6f"});d.a.initializeApp(h);var m=d.a.firestore(),p=d.a.database().ref(".info/connected"),f=d.a.storage(),b=m.collection("users"),v=m.collection("books"),x=m.collection("libraries"),g=(m.collection("tags"),m.collection("sections")),w="https://firebasestorage.googleapis.com/v0/b/fiktin-cac14.appspot.com/o/default_book_picture%2Fblack-and-white-book-cover-clip-art-book-of-images.jpg?alt=media&token=31470ce3-ad63-47c9-8b14-f19abddfde8c",y="https://firebasestorage.googleapis.com/v0/b/fiktin-cac14.appspot.com/o/default_user_picture%2Fusuario.jpg?alt=media&token=9dc00bba-5d07-4412-aef5-393e41000e4a",k={name:"NewUser",data:function(){return{newNick:"",newName:"",newEmail:"",newPassword:"",newPassword2:"",sameNick:[],exists:!1,picture:null,selectedFile:null,uploadValue:0}},watch:{newNick:{inmediate:!0,handler:function(t){this.$bind("sameNick",b.where("nick_to_search","==",this.newNick.toLowerCase()).limit(1)).then((function(t){}))}},sameNick:function(){this.exists=!(0===this.sameNick.length)}},methods:{removeImg:function(){this.picture=null,this.uploadValue=0},onFileSelected:function(t){this.selectedFile=t.target.files[0],this.onUpload()},onUpload:function(){var t=this,e=f.ref("/".concat(this.newNick.toLowerCase(),"/profile_pictures/").concat(this.selectedFile.name)),i=e.put(this.selectedFile);i.on("state_changed",(function(e){var i=e.bytesTransferred/e.totalBytes*100;t.uploadValue=i}),(function(t){console.log(t.message)}),(function(){t.uploadValue=100,i.snapshot.ref.getDownloadURL().then((function(e){t.picture=e,console.log(t.picture)}))}))},addUser:function(){var t,e;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:if(!this.correctNick){i.next=33;break}if(!this.correctPassword){i.next=30;break}if(this.exists){i.next=27;break}if(!this.validEmail){i.next=24;break}if(!this.samePasswords){i.next=21;break}return t=this.newNick.toLowerCase()+"_historial",null===this.picture&&(this.picture=y),i.next=9,regeneratorRuntime.awrap(b.add({nick:this.newNick,name:this.newName,email:this.newEmail,password:this.newPassword,profile_picture:this.picture,nick_to_search:this.newNick.toLowerCase()}));case 9:return e=i.sent,i.next=12,regeneratorRuntime.awrap(x.doc(t).set({name:"Historial",description:"(Aqui se guardaran los ultimos libros consultados de "+this.newNick+")",privacy:"private",nick:this.newNick,array_keys:[],user_id:e.id}));case 12:this.newNick="",this.newPassword="",this.newEmail="",this.newName="",this.newPassword2="",this.picture="",this.$emit("switchCreate"),i.next=22;break;case 21:window.alert("Contraseñas diferentes");case 22:i.next=25;break;case 24:window.alert("Necesitas introducir un email valido");case 25:i.next=28;break;case 27:window.alert("El usuario existe");case 28:i.next=31;break;case 30:window.alert("Longitud de contraseña inválida");case 31:i.next=34;break;case 33:window.alert("Longitud de nick inválida");case 34:case"end":return i.stop()}}),null,this)},switchCreate:function(){this.$emit("switchCreate")}},computed:{samePasswords:function(){return this.newPassword===this.newPassword2},minPassword:function(){return this.newPassword.length<6&&this.newPassword.length>0},maxPassword:function(){return this.newPassword.length>12},minNick:function(){return this.newNick.length<4&&this.newNick.length>0},maxNick:function(){return this.newNick.length>10},correctPassword:function(){return this.newPassword.length>=6&&this.newPassword.length<=12},correctNick:function(){return this.newNick.length>=4&&this.newNick.length<=10},validEmail:function(){return this.newEmail.includes("@")&&this.newEmail.includes(".")}}},S=k,_=(i("8261"),i("2877")),C=Object(_["a"])(S,c,l,!1,null,null,null),T=C.exports,P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"log-in"},[i("h3",[t._v(" Iniciar sesión ")]),i("div",{staticClass:"form-div"},[i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"person"}}),i("b-form-input",{staticClass:"ml-2 input-form",attrs:{trim:"",type:"text","aria-describedby":"input-live-help input-live-feedback",placeholder:"Usuario"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.logIn(e)}},model:{value:t.nick,callback:function(e){t.nick=e},expression:"nick"}})],1),i("br"),i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"shield-lock"}}),i("b-form-input",{staticClass:"ml-2 input-form",attrs:{trim:"",type:"password","aria-describedby":"input-live-help input-live-feedback",placeholder:"Contraseña"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.logIn(e)}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)]),i("br"),i("br"),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light"},on:{click:t.switchCreate}},[t._v("Crear Usuario")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"dark"},on:{click:t.logIn}},[t._v("Entrar")])],1)},N=[],O=i("2f62"),D=i("0e44");n["default"].use(O["a"]);var A=new O["a"].Store({state:{userID:"",userNick:"",loggedIn:!1,openBookID:"",openedBook:null,sectionID:"",sectionPreview:!1},plugins:[Object(D["a"])()],mutations:{logIn:function(t,e){t.userID=e,t.loggedIn=!0},logOut:function(t){t.userID="",t.loggedIn=!1},nickChange:function(t,e){t.userNick=e},openBookID:function(t,e){t.openBookID=e},openBook:function(t,e){t.openedBook=e},changeSection:function(t,e){t.sectionID=e},closeBook:function(t){t.openBookID="",t.openedBook="",t.sectionID=""},switchSectionPreview:function(t,e){t.sectionPreview=e}},actions:{},modules:{}}),L={name:"LogIn",props:{url:String},data:function(){return{nick:"",password:"",user:[],same_nick:!1,same_psw:!1}},methods:{logIn:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.$bind("user",b.where("nick_to_search","==",this.nick.toLowerCase()).limit(1)).then((function(t){})));case 2:0===this.user.length?window.alert("Usuario no existe"):this.user[0].password===this.password?(A.commit("logIn",this.user[0].id),A.commit("nickChange",this.user[0].nick),this.nick="",this.password="",this.$emit("loggedIn"),this.$router.push(this.url)):window.alert("Contraseña incorrecta");case 3:case"end":return t.stop()}}),null,this)},switchCreate:function(){this.$emit("switchCreate")}}},M=L,B=(i("594a"),Object(_["a"])(M,P,N,!1,null,null,null)),I=B.exports,z={name:"start",components:{NewUser:T,LogIn:I},props:{urlLogIn:String,optionStart:Boolean},data:function(){return{create:this.optionStart}},methods:{switchCreate:function(){this.create=!this.create},logIn:function(){this.$emit("loggedIn")}}},E=z,R=(i("a90d"),Object(_["a"])(E,o,r,!1,null,null,null)),W=R.exports,$={name:"App",components:{Start:W},data:function(){return{loggedIn:A.state.loggedIn,modalLogOut:!1,modalLogIn:!1,urlLogIn:"",optionStart:Boolean}},methods:{needLogIn:function(t){this.urlLogIn=t,this.modalLogIn=!0,this.optionStart=!0},createUser:function(t){this.urlLogIn=t,this.modalLogIn=!0,this.optionStart=!1},logIn:function(){this.loggedIn=!0,this.modalLogIn=!1},logOut:function(){A.commit("logOut"),this.loggedIn=!1,this.modalLogOut=!1,this.$router.push("/")},confirmLogOut:function(){this.loggedIn?this.modalLogOut=!0:window.alert("Inicie sesión primero")},deleteUser:function(){this.loggedIn=!1}}},j=$,q=(i("034f"),Object(_["a"])(j,s,a,!1,null,null,null)),U=q.exports,H=i("8c4f"),V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user"},[i("b-card",{staticClass:"background-card"},[t.loggedIn?i("div",[t.edit?i("div",[i("ModifyUser",{attrs:{email:t.email,name:t.name,userKey:t.userKey,password:t.password,picture:t.picture},on:{"new-name":t.newName,"new-email":t.newEmail,"new-password":t.newPassword,"new-picture":t.newPicture,"flip-edit":t.switchEdit,switchEdit:t.switchEdit}})],1):i("b-list-group-item",[i("div",{staticClass:"d-flex justify-content-start"},[i("div",{staticClass:"card-img-box"},[i("img",{staticClass:"card-img-top",attrs:{src:this.picture,alt:"Imgane de perfil"}})]),i("div",[i("br"),i("div",{staticClass:"d-flex justify-content-start"},[i("h4",[t._v(t._s(t.nick))])]),i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"user-name"},[t._v(t._s(t.name))])]),i("div",{staticClass:"d-flex justify-content-start"},[i("p",[i("b-icon",{attrs:{icon:"envelope"}}),t._v(" "+t._s(t.email))],1)]),i("div",{staticClass:"d-flex mr-1 buttons"},[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-dark"},on:{click:t.switchEdit}},[t._v(" Modificar")]),i("b-button",{staticClass:"mr-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"danger"},on:{click:function(e){t.modal=!0}}},[t._v(" Eliminar")])],1)])])]),i("b-modal",{attrs:{id:"modal-delete","hide-footer":"","hide-header":"","no-close-on-backdrop":""},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("div",{staticClass:"d-block text-center"},[i("h3",[t._v("Eliminar usuario")]),i("p",[t._v("¿Está seguro que desea eliminar usuario?")]),i("span",[t._v(" Una vez realizado dicha operación no se podrá volver atrás ")])]),i("div",{staticClass:"d-flex justify-content-center",attrs:{id:"buttons-layout"}},[i("b-button",{staticClass:"mt-2",staticStyle:{"font-size":"16px"},attrs:{id:"modal-buttons",variant:"primary",block:""},on:{click:function(e){t.modal=!1}}},[t._v("Cancelar")]),i("b-button",{staticClass:"mt-2",staticStyle:{"font-size":"16px"},attrs:{id:"modal-buttons",variant:"outline-danger",block:""},on:{click:t.deleteUser}},[t._v("ELIMINAR")])],1)])],1):i("div",[i("p",[t._v("No tienes la sesion iniciada")])])])],1)},F=[],G=(i("4160"),i("159b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user"},[i("b-card",[i("form",[i("br"),i("p",[t._v(" Cambia los datos que desees modificar ")]),i("div",{staticClass:"row"},[i("div",{staticClass:"col form-div"},[i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("b-container",{attrs:{sm:"3"}},[i("label",[t._v("Imagen de perfil:")]),null!=this.newPicture?i("b-button",{staticClass:"my-2",attrs:{variant:"danger-dark"},on:{click:t.removeImg}},[i("b-icon",{attrs:{variant:"danger",icon:"x"}})],1):t._e(),i("b-form-file",{directives:[{name:"show",rawName:"v-show",value:0===this.uploadValue&&null===this.newPicture,expression:"this.uploadValue===0 && this.newPicture === null"}],staticClass:"my-2",attrs:{placeholder:"Selecciona una imagen o arrastrala aquí...","drop-placeholder":"Arrastra aquí la imagen...",accept:"image/*"},on:{change:t.onFileSelected}})],1),i("div",{staticClass:"card-img-box"},[i("img",{staticClass:"card-img-top",attrs:{src:this.newPicture,alt:"No has subido ninguna imagen"}})])],1)],1),i("div",{staticClass:"center-col"},[i("div",{staticClass:"col"},[i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"person-lines-fill"}}),i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"text","aria-describedby":"input-live-help input-live-feedback",placeholder:"Nombre"},model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}})],1),i("br"),i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"envelope"}}),i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"text","aria-describedby":"input-live-help input-live-feedback",placeholder:"Email"},model:{value:t.newEmail,callback:function(e){t.newEmail=e},expression:"newEmail"}})],1),i("br"),i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"shield-lock"}}),0===t.newPassword.length?i("b-form-input",{staticClass:"ml-2 input-form",attrs:{trim:"",type:"password","aria-describedby":"input-live-help input-live-feedback",placeholder:"Contraseña"},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}):i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"password",trim:"",state:t.correctPassword,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Contraseña"},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),t.minPassword?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Mínimo 6 caracteres ")]):t.maxPassword?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Máximo 12 caracteres ")]):t._e()],1),i("br"),i("div",{staticClass:"d-flex"},[i("b-icon",{staticClass:"h4",attrs:{icon:"shield-lock-fill"}}),0===t.newPassword2.length?i("b-form-input",{staticClass:"ml-2 input-form",attrs:{trim:"",type:"password","aria-describedby":"input-live-help input-live-feedback",placeholder:"Confirmar contraseña"},model:{value:t.newPassword2,callback:function(e){t.newPassword2=e},expression:"newPassword2"}}):i("b-form-input",{staticClass:"ml-2 input-form",attrs:{type:"password",trim:"",state:t.samePasswords,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Confirmar contraseña"},model:{value:t.newPassword2,callback:function(e){t.newPassword2=e},expression:"newPassword2"}}),t.samePasswords?t._e():i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Las contraseñas deben coincidir ")])],1)])])]),i("b-button",{staticClass:"mr-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-secondary"},on:{click:t.switchEdit}},[t._v(" Cancelar")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"dark",type:"submit"},on:{click:function(e){t.modal=!0}}},[t._v(" Confirmar")])],1),i("b-modal",{attrs:{id:"modal-modify","hide-footer":"","hide-header":"","no-close-on-backdrop":""},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("div",{staticClass:"d-block text-center"},[i("p",[t._v("¿Está seguro que desea aplicar los cambios?")])]),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-2",staticStyle:{"font-size":"16px"},attrs:{id:"modal-buttons",variant:"outline-secondary",block:""},on:{click:t.switchEdit}},[t._v("Cancelar")]),i("b-button",{staticClass:"mt-2",staticStyle:{"font-size":"16px"},attrs:{id:"modal-buttons",variant:"primary",block:""},on:{click:t.update}},[t._v("Confirmar")])],1)])],1)],1)}),K=[],J={name:"ModifyUser",data:function(){return{newName:"",newEmail:"",newPassword:"",newPassword2:"",newPicture:"",uploadValue:0,modal:!1}},props:{userKey:String,email:String,name:String,password:String,picture:String},created:function(){this.newName=this.name,this.newEmail=this.email,this.newPassword=this.password,this.newPassword2=this.password,this.newPicture=this.picture},methods:{removeImg:function(){this.newPicture=null,this.uploadValue=0,this.selectedFile=""},onFileSelected:function(t){this.selectedFile=t.target.files[0],this.onUpload()},onUpload:function(){var t=this,e=f.ref("/".concat(A.state.userNick.toLowerCase(),"/profile_pictures/").concat(this.selectedFile.name)),i=e.put(this.selectedFile);i.on("state_changed",(function(e){var i=e.bytesTransferred/e.totalBytes*100;t.uploadValue=i}),(function(t){console.log(t.message)}),(function(){t.uploadValue=100,i.snapshot.ref.getDownloadURL().then((function(e){t.newPicture=e,console.log(t.newPicture)}))}))},update:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.correctPassword?this.validEmail?this.samePasswords?(b.doc(this.userKey).update({name:this.newName,email:this.newEmail,password:this.newPassword,profile_picture:this.newPicture}),this.$emit("new-name",this.newName),this.$emit("new-email",this.newEmail),this.$emit("new-password",this.newPassword),this.$emit("new-picture",this.newPicture),this.$emit("flip-edit")):window.alert("Contraseñas diferentes"):window.alert("Necesitas introducir un email valido"):window.alert("Longitud de contraseña inválida");case 1:case"end":return t.stop()}}),null,this)},switchEdit:function(){this.modal=!1,this.$emit("switchEdit")}},computed:{samePasswords:function(){return this.newPassword===this.newPassword2},minPassword:function(){return this.newPassword.length<6&&this.newPassword.length>0},maxPassword:function(){return this.newPassword.length>12},validEmail:function(){return this.newEmail.includes("@")&&this.newEmail.includes(".")},correctPassword:function(){return this.newPassword.length>=6&&this.newPassword.length<=12}}},X=J,Z=(i("703c"),Object(_["a"])(X,G,K,!1,null,null,null)),Q=Z.exports,Y={name:"User",components:{ModifyUser:Q},data:function(){return{nick:"",email:"",name:"",password:"",edit:!1,userKey:"",picture:"",modal:!1}},mounted:function(){var t=this;this.userKey=A.state.userID,b.doc(this.userKey).get().then((function(e){var i=e.data();t.nick=i.nick,t.email=i.email,t.name=i.name,t.password=i.password,t.picture=i.profile_picture}))},methods:{deleteUser:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(x.where("user_id","==",this.userKey).get().then((function(t){t.forEach((function(t){x.doc(t.id).delete()}))})));case 2:return t.next=4,regeneratorRuntime.awrap(v.where("user_id","==",this.userKey).get().then((function(t){t.forEach((function(t){v.doc(t.id).delete()}))})));case 4:b.doc(this.userKey).delete(),this.$emit("deleteUser"),A.commit("logOut"),this.$router.push("/");case 8:case"end":return t.stop()}}),null,this)},switchEdit:function(){this.edit=!this.edit},newName:function(t){this.name=t},newPicture:function(t){this.picture=t},newEmail:function(t){this.email=t},newPassword:function(t){this.password=t}},computed:{loggedIn:function(){return!(""===this.userKey)}}},tt=Y,et=(i("e16f"),i("d3de"),Object(_["a"])(tt,V,F,!1,null,"1af118c7",null)),it=et.exports,nt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"home"},[i("b-card",{staticClass:"background-card"},[i("h1",[t._v("Libros publicados")]),i("div",{staticClass:"row"},t._l(t.books,(function(e,n){return i("div",{key:n},[i("b-card",{staticClass:"mb-2",staticStyle:{"max-width":"20rem",cursor:"pointer"},attrs:{tag:"article"}},[i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mr-1 add-lib-button",staticStyle:{"font-size":"16px"},attrs:{variant:"light",title:"Añadir a biblioteca"},on:{click:function(e){return e.stopPropagation(),t.addToLibraryButton(n)}}},[i("b-icon",{attrs:{variant:"warning",icon:"bookmark-fill"}})],1),i("div",{staticClass:"card-img-box"},[i("img",{staticClass:"card-img-top",attrs:{src:e.cover,alt:"Portada"},on:{click:function(i){return t.openBook(e,n)}}})]),i("br"),i("h6",{staticClass:"card-title",on:{click:function(i){return t.openBook(e,n)}}},[t._v(" "+t._s(t.upperCase(e.title))+" ")]),i("div",{staticClass:"d-flex justify-content-start"},["Nombre"==e.author?i("h6",{staticClass:"autor-name"},[t._v(t._s(e.name)+" ")]):i("h6",{staticClass:"autor-name"},[t._v(t._s(e.nick))])]),i("div",{staticClass:"d-flex justify-content-start"},[i("b-card-text",[t._v(" "+t._s(t.description(e.description))+" ")])],1),i("br"),i("div",{staticClass:"text-small"},[t._l(e.tags.slice(0,3),(function(e,n){return i("a",{key:n,attrs:{href:""}},[t._v("#"+t._s(e)+" ")])})),e.tags.length>3?i("a",[t._v("...")]):t._e()],2),i("br"),t.showModal===n?i("AddToLibraryModal",{attrs:{bookId:t.primaryKeys[n]},on:{add:t.addToLibrary,cancel:t.addToLibraryButton}}):t._e()],1)],1)})),0)])],1)},st=[],at=(i("a4d3"),i("e01a"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-modal",{attrs:{id:"bv-modal-example",scrollable:"",centered:"","hide-header-close":"",title:"Añadir libro a...",size:"sm"},on:{hide:t.cancelButton},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{size:"mt-1",variant:"outline-danger"},on:{click:t.cancelButton}},[t._v("Cancelar")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{size:"mt-1",variant:"outline-success"},on:{click:t.readyButton}},[t._v("Guardar")])]},proxy:!0}])},[this.numberOfLibraries<0&&0===this.internetConnection?i("div",[i("b",[t._v(" Cargando bibliotecas... ")])]):0===this.numberOfLibraries&&0===this.internetConnection?i("div",[i("b",[t._v(" Vaya, parece que no tienes ninguna biblioteca creada... Prueba a crear una antes de añadir libros a ellas. ")])]):-1===this.internetConnection?i("div",[i("b",[t._v(" Vaya, parece que no tienes conexión a Internet. Revisa tu conexión y actualiza la página para solucionar el problema. ")])]):i("div",[i("b-form-checkbox-group",{attrs:{stacked:""},model:{value:t.selectedLibraries,callback:function(e){t.selectedLibraries=e},expression:"selectedLibraries"}},[t._l(t.librariesList,(function(e){return i("b-form-checkbox",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),0===t.librariesList.length?i("b",[t._v("¡Has agregado este libro a todas tus bibliotecas! :D")]):t._e()],2)],1)])}),ot=[],rt=(i("a434"),{name:"AddToLibraryModal",props:{bookId:String},data:function(){return{numberOfLibraries:-1,librariesList:[],selectedLibraries:[],internetConnection:1}},mounted:function(){var t=this;p.on("value",(function(e){!0===e.val()&&0!==t.internetConnection?(t.internetConnection=0,t.refresh()):!1===e.val()&&0!==t.internetConnection&&(t.internetConnection=-1)}))},methods:{refresh:function(){var t,e,i,n;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return this.$bvModal.show("bv-modal-example"),t=[],e=A.state.userNick,i=A.state.userNick.concat("_mis_obras").toLowerCase(),n=A.state.userNick.concat("_historial").toLowerCase(),s.next=7,regeneratorRuntime.awrap(x.where("nick","==",e).get().then((function(e){e.forEach((function(e){e.id!==i&&e.id!==n&&t.push({id:e.id,name:e.data().name,arrayKeys:e.data().array_keys})}))})));case 7:this.librariesList=t,this.numberOfLibraries=t.length,this.checkArrayKeys();case 10:case"end":return s.stop()}}),null,this)},checkArrayKeys:function(){for(var t=0;t<this.librariesList.length;++t)for(var e=this.librariesList[t].arrayKeys.length,i=0;i<e;++i)this.librariesList[t].arrayKeys[i]===this.bookId&&(this.librariesList.splice(t,1),i=e,--t)},readyButton:function(){this.$emit("add",this.selectedLibraries)},cancelButton:function(){this.$emit("cancel")}}}),ct=rt,lt=Object(_["a"])(ct,at,ot,!1,null,null,null),ut=lt.exports,dt={name:"homeBooksList",components:{AddToLibraryModal:ut},data:function(){return{books:[],primaryKeys:[],showModal:-1}},mounted:function(){this.refresh()},methods:{refresh:function(){var t=this;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return this.books=[],e.next=3,regeneratorRuntime.awrap(v.get().then((function(e){e.forEach((function(e){e.data().published&&b.doc(e.data().user_id).get().then((function(i){t.primaryKeys.push(e.id),t.books.push({author:e.data().author,title:e.data().title,description:e.data().description,cover:e.data().cover,tags:e.data().tags,published:e.data().published,userID:e.data().user_id,nick:i.data().nick,name:i.data().name,sections:e.data().sections,customBoxes:e.data().customBoxes})}))}))})));case 3:case"end":return e.stop()}}),null,this)},addToLibraryButton:function(t){this.showModal=t},addToLibrary:function(t){var e,i;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:e=0;case 1:if(!(e<t.length)){n.next=9;break}return n.next=4,regeneratorRuntime.awrap(x.doc(t[e]).get().then((function(t){t.exists&&(i=t.data().array_keys)})));case 4:i.push(this.primaryKeys[this.showModal]),x.doc(t[e]).update({array_keys:i});case 6:++e,n.next=1;break;case 9:this.addToLibraryButton(-1);case 10:case"end":return n.stop()}}),null,this)},openBook:function(t,e){A.commit("openBookID",this.primaryKeys[e]),A.commit("openBook",t),A.commit("changeSection",t.sections[0]),this.$router.push({name:"readBook"})},description:function(t){return t.length>100&&(t=t.substr(0,99)+"..."),t},upperCase:function(t){return t.toUpperCase()}}},ht=dt,mt=(i("f439"),Object(_["a"])(ht,nt,st,!1,null,"379a67b3",null)),pt=mt.exports,ft=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"books",on:{click:t.resetDels}},[i("b-modal",{attrs:{id:"modal-create",size:"xl","hide-footer":"","hide-header":"","no-close-on-backdrop":"",centered:""},model:{value:t.modalCreate,callback:function(e){t.modalCreate=e},expression:"modalCreate"}},[i("CreateBook",{on:{cancel:t.discardChangesBook,create:function(e){return t.saveChangesBook()}}})],1),i("b-card",{staticClass:"background-card"},[i("div",{staticClass:"d-flex justify-content-end"},[i("h4",{staticClass:"mr-auto"},[t._v("Mis libros")]),i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-create",modifiers:{"modal-create":!0}}],staticClass:"m-md-2",staticStyle:{"font-size":"14px"},attrs:{variant:"info",size:"sm"}},[i("b-icon",{attrs:{icon:"plus"}}),t._v(" Crear libro ")],1)],1),i("div",{staticClass:"d-flex justify-content-end"},[i("p",{staticClass:"mr-auto"},[t._v("Tienes "+t._s(t.books.length)+" libro(s).")])]),i("div",{staticClass:"row"},t._l(t.books,(function(e,n){return i("div",{key:n},[i("b-card",{staticClass:"mb-2",staticStyle:{"max-width":"20rem",cursor:"pointer"},attrs:{tag:"article"}},[i("div",{staticClass:"card-img-box"},[i("img",{staticClass:"card-img-top",attrs:{src:e.cover,alt:"Portada"},on:{click:function(i){return t.openBook(e,n)}}})]),i("br"),i("h6",{staticClass:"card-title",on:{click:function(i){return t.openBook(e,n)}}},[t._v(" "+t._s(t.upperCase(e.title))+" "),e.published?i("a",{staticClass:"h5 mb-2"},[i("b-icon",{attrs:{icon:"eye"}})],1):i("a",{staticClass:"h5 mb-2"},[i("b-icon",{attrs:{icon:"eye-slash"}})],1)]),i("div",{staticClass:"d-flex justify-content-start"},["Nombre"==e.author?i("h6",{staticClass:"autor-name"},[t._v(t._s(t.name))]):i("h6",{staticClass:"autor-name"},[t._v(t._s(t.nick))])]),i("div",{staticClass:"d-flex justify-content-start"},[i("b-card-text",[t._v(" "+t._s(t.description(e.description))+" ")])],1),i("br"),i("div",{staticClass:"text-small"},[t._l(e.tags.slice(0,3),(function(e,n){return i("a",{key:n,attrs:{href:""}},[t._v("#"+t._s(e)+" ")])})),e.tags.length>3?i("a",[t._v("...")]):t._e()],2),i("div",[i("div",{staticClass:"buttons-div"},[t.modifyID===e.ID||e.confirmDelete?e.confirmDelete?i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"16px","background-color":"#dc3545 !important"},attrs:{variant:"danger",title:"Confirmar eliminar"},on:{click:function(i){return i.stopPropagation(),t.deleteBook(e.ID,n)}}},[i("b-icon",{attrs:{icon:"trash-fill"}})],1):t._e():i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"16px"},attrs:{title:"Eliminar",variant:"light"},on:{click:function(t){t.stopPropagation(),e.confirmDelete=!0}}},[i("b-icon",{attrs:{icon:"trash-fill"}})],1),i("b-dropdown",{attrs:{size:"sm",id:"dropdown-1",variant:"light",text:"Opciones"}},[i("b-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:t.modifyID!==e.ID,expression:"modifyID !== book.ID"}],attrs:{id:"modifyButton"},on:{click:function(i){return i.stopPropagation(),t.modifyBook(e)}}},[t._v("Modificar")]),i("b-dropdown-item",{on:{click:function(e){return e.stopPropagation(),t.addToLibraryButton(n)}}},[t._v("Añadir a bibliotecas")])],1)],1)]),t.showModal===n?i("AddToLibraryModal",{attrs:{bookId:t.primaryKeys[n]},on:{add:t.addToLibrary,cancel:t.addToLibraryButton}}):t._e()],1),t.modifyID===e.ID?i("b-modal",{attrs:{size:"xl","hide-footer":"","hide-header":"","no-close-on-backdrop":""},model:{value:t.modalModify,callback:function(e){t.modalModify=e},expression:"modalModify"}},[i("ModifyBook",{attrs:{bookAux:e},on:{cancel:t.discardChangesBook,save:function(e){return t.saveChangesBook()}}})],1):t._e()],1)})),0)])],1)},bt=[],vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"modify"},[t._m(0),i("b-container",{staticClass:"row"},[i("b-container",{staticClass:"col"},[i("b-container",{staticClass:"row",attrs:{fluid:""}},[i("label",[t._v("Título")]),i("b-form-input",{attrs:{type:"text",state:!t.repited&&t.title.length>=3&&t.title.length<=50,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Título del libro"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t.repited?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Título repetido ")]):t.title.length<3?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Introduce al menos 3 caracteres ")]):t.title.length>50?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 50 caracteres ")]):t._e()],1),i("br"),i("b-container",{staticClass:"row",attrs:{fluid:""}},[i("b-form-group",[i("label",[t._v("Autor")]),i("b-form-group",[i("b-form-radio",{attrs:{value:"Nombre"},model:{value:t.author,callback:function(e){t.author=e},expression:"author"}},[t._v(" Nombre de usuario")]),i("b-form-radio",{attrs:{value:"Nick"},model:{value:t.author,callback:function(e){t.author=e},expression:"author"}},[t._v(" Nickname")])],1)],1)],1)],1),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("b-row",{staticClass:"my-1"},[i("label",[t._v("Portada")]),i("b-form-file",{staticClass:"my-2",attrs:{placeholder:"Selecciona una imagen","drop-placeholder":"Arrastra aquí la imagen...",accept:"image/*"},on:{change:t.onFileSelected}})],1),i("b-row",{staticClass:"my-1"},[i("b-img",{attrs:{src:this.cover,fluid:"",width:"250%",alt:"No has subido ninguna imagen"}}),null!=this.cover?i("b-button",{staticClass:"my-2",staticStyle:{"font-size":"16px"},attrs:{variant:"danger"},on:{click:t.removeImg}},[t._v("Eliminar")]):t._e()],1)],1)],1),i("b-container",{staticClass:"row"},[i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("div",[i("label",{attrs:{for:"tags-basic"}},[t._v("Escribe una nueva etiqueta y pulsa enter")]),i("b-form-tags",{staticClass:"mb-2",attrs:{"input-id":"tags-basic","add-button-text":"Añadir",placeholder:"Añade una etiqueta..."},model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}})],1)]),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("label",[t._v("Descripción")]),i("b-form-textarea",{attrs:{state:t.description.length<=250,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Descripción",rows:"3","max-rows":"6"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),t.description.length>=250?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 250 caracteres ")]):t._e()],1)],1),i("div",{staticClass:"d-flex justify-content-end"},[i("div",{staticClass:"custom-control custom-checkbox my-4"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.published,expression:"published"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"published_modify_id"},domProps:{checked:Array.isArray(t.published)?t._i(t.published,null)>-1:t.published},on:{change:function(e){var i=t.published,n=e.target,s=!!n.checked;if(Array.isArray(i)){var a=null,o=t._i(i,a);n.checked?o<0&&(t.published=i.concat([a])):o>-1&&(t.published=i.slice(0,o).concat(i.slice(o+1)))}else t.published=s}}}),i("label",{staticClass:"custom-control-label",attrs:{for:"published_modify_id"}},[t._v(" Publicar")])]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-secondary"},on:{click:t.cancelButton}},[t._v("Descartar")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"dark",disabled:0!=this.uploadValue&&100!=this.uploadValue||t.repited||t.title.length<3||t.title.length>50||t.description.length>250},on:{click:t.saveButton}},[t._v("Guardar")])],1)],1)},xt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex justify-content-start"},[i("h4",[t._v("Modificar libro")])])}],gt={name:"ModifyBook",props:["bookAux"],data:function(){return{title:this.bookAux.title,author:this.bookAux.author,description:this.bookAux.description,cover:this.bookAux.cover,tags:this.bookAux.tags,published:this.bookAux.published,userID:this.bookAux.userID,id:this.bookAux.ID,selectedFile:null,uploadValue:0,repitedTitle:[],repited:!1,modalModify:!1,confirmDelete:!1}},watch:{title:{inmediate:!0,handler:function(t){this.$bind("repitedTitle",v.where("title","==",this.title).limit(1)).then((function(t){}))}},repitedTitle:function(){this.repited=!(0===this.repitedTitle.length)}},methods:{removeImg:function(){this.cover=null},onFileSelected:function(t){this.selectedFile=t.target.files[0],this.onUpload()},onUpload:function(){var t=this,e=f.ref("/".concat(A.state.userNick.toLowerCase(),"/books/").concat(this.id,"/cover/").concat(this.selectedFile.name)),i=e.put(this.selectedFile);i.on("state_changed",(function(e){var i=e.bytesTransferred/e.totalBytes*100;t.uploadValue=i}),(function(t){console.log(t.message)}),(function(){t.uploadValue=100,i.snapshot.ref.getDownloadURL().then((function(e){t.cover=e}))}))},saveButton:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return this.modalModify=!1,null===this.cover&&(this.cover=w),t.next=4,regeneratorRuntime.awrap(v.doc(this.bookAux.ID).update({title:this.title,author:this.author,tags:this.tags,description:this.description,cover:this.cover,published:this.published}));case 4:this.$emit("save");case 5:case"end":return t.stop()}}),null,this)},cancelButton:function(){this.$emit("cancel")}}},wt=gt,yt=(i("5f05"),Object(_["a"])(wt,vt,xt,!1,null,"2fff59c9",null)),kt=yt.exports,St=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create"},[t._m(0),i("b-container",{staticClass:"row"},[i("b-container",{staticClass:"col"},[i("b-container",{staticClass:"row",attrs:{fluid:""}},[i("label",[t._v("Título")]),i("b-form-input",{attrs:{type:"text",state:!t.repited&&t.title.length>=3&&t.title.length<=50,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Título del libro"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),t.repited?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Título repetido ")]):t._e(),t.title.length<3?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Introduce al menos 3 caracteres ")]):i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 50 caracteres ")])],1),i("br"),i("b-container",{staticClass:"row",attrs:{fluid:""}},[i("b-form-group",[i("label",[t._v("Autor")]),i("b-form-group",[i("b-form-radio",{attrs:{value:"Nombre"},model:{value:t.author,callback:function(e){t.author=e},expression:"author"}},[t._v(" Nombre de usuario")]),i("b-form-radio",{attrs:{value:"Nick"},model:{value:t.author,callback:function(e){t.author=e},expression:"author"}},[t._v(" Nickname")])],1)],1)],1)],1),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("label",[t._v("Descripción")]),i("b-form-textarea",{attrs:{state:t.description.length<=250,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Descripción",rows:"3","max-rows":"6"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),t.description.length>=250?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 250 caracteres ")]):t._e(),i("div",[i("label",{attrs:{for:"tags-basic"}},[t._v("Etiquetas")]),i("b-form-tags",{staticClass:"mb-2",attrs:{"input-id":"tags-basic","add-button-text":"Añadir",placeholder:"Añade una etiqueta..."},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault()}},model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}})],1)],1)],1),i("div",{staticClass:"d-flex justify-content-end"},[i("div",{staticClass:"custom-control custom-checkbox my-4"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.published,expression:"published"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"published_id"},domProps:{checked:Array.isArray(t.published)?t._i(t.published,null)>-1:t.published},on:{change:function(e){var i=t.published,n=e.target,s=!!n.checked;if(Array.isArray(i)){var a=null,o=t._i(i,a);n.checked?o<0&&(t.published=i.concat([a])):o>-1&&(t.published=i.slice(0,o).concat(i.slice(o+1)))}else t.published=s}}}),i("label",{staticClass:"custom-control-label",attrs:{for:"published_id"}},[t._v(" Publicar")])]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-secondary"},on:{click:t.cancelButton}},[t._v("Cancelar")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"dark",disabled:t.repited||t.title.length<3||t.title.length>50||t.description.length>250},on:{click:t.createButton}},[t._v("Crear libro")])],1)],1)},_t=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex justify-content-start"},[i("h4",[t._v("Crear libro")])])}],Ct={name:"CreateBook",props:[],data:function(){return{title:"",author:"Nombre",tags:[],description:"",published:!1,userID:A.state.userID,repitedTitle:[],repited:!1,modalCreate:!1}},watch:{title:{inmediate:!0,handler:function(t){this.$bind("repitedTitle",v.where("title","==",this.title).limit(1)).then((function(t){}))}},repitedTitle:function(){this.repited=!(0===this.repitedTitle.length)}},methods:{createButton:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return t=[],e.t0=t,e.next=4,regeneratorRuntime.awrap(g.add({name:"Primera sección",book_author_ID:this.userID,book_title:this.title,gadgets:[{htmlText:"",component:"Normal",componentName:"Texto normal"}]}));case 4:return e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=8,regeneratorRuntime.awrap(v.add({title:this.title,author:this.author,tags:this.tags,description:this.description,published:this.published,user_id:this.userID,sections:[t[0].id],customBoxes:[],cover:w}));case 8:this.title="",this.author="",this.tags=[],this.description="",this.published="not_published",this.modalCreate=!1,this.$emit("create");case 15:case"end":return e.stop()}}),null,this)},cancelButton:function(){this.modalCreate=!1,this.title="",this.author="",this.tags=[],this.description="",this.published="not_published",this.$emit("cancel")}}},Tt=Ct,Pt=(i("290a"),Object(_["a"])(Tt,St,_t,!1,null,"22c3d53f",null)),Nt=Pt.exports,Ot={name:"booksList",data:function(){return{books:[],modifyID:null,userID:A.state.userID,nick:"",name:"",primaryKeys:[],showModal:-1,modalCreate:!1,modalModify:!1,showDropdown:!1}},components:{ModifyBook:kt,CreateBook:Nt,AddToLibraryModal:ut},mounted:function(){var t=this;this.refresh(),b.doc(this.userID).get().then((function(e){var i=e.data();t.nick=i.nick,t.name=i.name}))},methods:{resetDels:function(){this.books.forEach((function(t){return t.confirmDelete=!1}))},refresh:function(){var t=this;this.books=[],this.primaryKeys=[],v.get().then((function(e){e.forEach((function(e){e.data().user_id===t.userID&&(t.primaryKeys.push(e.id),t.books.push({author:e.data().author,title:e.data().title,description:e.data().description,cover:e.data().cover,tags:e.data().tags,published:e.data().published,userID:e.data().user_id,sections:e.data().sections,customBoxes:e.data().customBoxes,ID:e.id,confirmDelete:!1}))}))}))},deleteBook:function(t,e){var i;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:i=0;case 1:if(!(i<this.books[e].sections.length)){n.next=7;break}return n.next=4,regeneratorRuntime.awrap(g.doc(this.books[e].sections[i]).delete());case 4:++i,n.next=1;break;case 7:return n.next=9,regeneratorRuntime.awrap(v.doc(t).delete());case 9:this.refresh();case 10:case"end":return n.stop()}}),null,this)},modifyBook:function(t){this.modifyID=t.ID,this.modalModify=!0},discardChangesBook:function(){this.modalCreate=!1,this.modifyID=null,this.modalModify=!1},saveChangesBook:function(){this.modalCreate=!1,this.modalModify=!1,this.modifyID=null,this.refresh()},addToLibraryButton:function(t){this.showModal=t},addToLibrary:function(t){var e,i;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:e=0;case 1:if(!(e<t.length)){n.next=9;break}return n.next=4,regeneratorRuntime.awrap(x.doc(t[e]).get().then((function(t){t.exists&&(i=t.data().array_keys)})));case 4:i.push(this.primaryKeys[this.showModal]),x.doc(t[e]).update({array_keys:i});case 6:++e,n.next=1;break;case 9:this.addToLibraryButton(-1);case 10:case"end":return n.stop()}}),null,this)},openBook:function(t,e){A.commit("openBookID",this.primaryKeys[e]),A.commit("openBook",t),A.commit("changeSection",t.sections[0]),A.commit("switchSectionPreview",!1),this.$router.push({name:"readBook"})},description:function(t){return t.length>100&&(t=t.substr(0,99)+"..."),t},upperCase:function(t){return t.toUpperCase()},toggleDropdown:function(){this.showDropdown=!this.showDropdown}}},Dt=Ot,At=(i("bad0"),Object(_["a"])(Dt,ft,bt,!1,null,"549631b8",null)),Lt=At.exports,Mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"CreateLibrary"},[i("b-card",{staticClass:"background-card"},[i("b-modal",{attrs:{id:"modal-create",size:"xl","hide-footer":"","hide-header":"","no-close-on-backdrop":""},model:{value:t.modalCreate,callback:function(e){t.modalCreate=e},expression:"modalCreate"}},[0===this.internetConnection?i("CreateLibrary",{staticClass:"create",on:{cancel:t.discardChangesLibrary,create:t.createLibrary}}):t._e()],1),0===this.internetConnection?i("div",{staticClass:"d-flex justify-content-end"},[i("h4",{staticClass:"mr-auto"},[t._v("Mis bibliotecas")]),i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-create",modifiers:{"modal-create":!0}}],staticClass:"m-md-2",staticStyle:{"font-size":"14px"},attrs:{variant:"info",size:"sm"}},[i("b-icon",{attrs:{icon:"plus"}}),t._v(" Crear biblioteca ")],1)],1):t._e(),0===this.numberOfLibraries&&0===this.internetConnection?i("h3",[t._v("No hay bibliotecas creadas")]):-1===this.numberOfLibraries&&0===this.internetConnection?i("h3",[t._v("Cargando")]):-1===this.internetConnection?i("h3",[t._v("vaya, parece que no tienes conexión y no podemos mostrar tus bibliotecas"),i("br"),t._v("Revisa tu conexión y actualiza la página para solucionar el problema")]):i("span",t._l(t.librariesList,(function(e,n){return i("b-list-group",{key:e.name,on:{click:function(i){return t.viewLibrary(e.id,e.name,e.numberOfBooks,n)}}},[i("b-list-group-item",[i("div",[i("div",{staticClass:"row d-flex justify-content-end"},[i("h4",{staticClass:"mr-auto"},[t._v(" "+t._s(e.name)+" "),"public"===e.privacy?i("a",{staticClass:"h4 mb-2"},[i("b-icon",{attrs:{icon:"eye"}})],1):i("a",{staticClass:"h4 mb-2"},[i("b-icon",{attrs:{icon:"eye-slash"}})],1)]),i("div",{staticClass:"m-md-2"},[0===e.numberOfBooks?i("span",[t._v("Sin libros ")]):1===e.numberOfBooks?i("span",[t._v(t._s(e.numberOfBooks)+" libro ")]):i("span",[t._v(t._s(e.numberOfBooks)+" libros ")])])]),i("div",{staticClass:"row d-flex justify-content-end"},[i("div",{staticClass:"mr-auto"},[""!==e.description?i("span",[t._v(t._s(e.description))]):i("span",[t._v("Sin descripción")])]),i("div",{staticClass:"m-md-2"},[-1!==t.modifying&&t.modifying===n||e.id!=t.searchHistory?t._e():i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-dark"},on:{click:function(i){return i.stopPropagation(),t.btnEmptyHistory(e.id)}}},[t._v("Vaciar historial")]),e.id!=t.searchHistory?i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-dark"},on:{click:function(e){return e.stopPropagation(),t.btnModifyLib(n)}}},[t._v("Modificar")]):t._e(),e.id!=t.searchHistory?i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"danger"},on:{click:function(e){return e.stopPropagation(),t.btnDeleteHandler(n)}}},[t._v("Eliminar")]):t._e(),t.showModal===n?i("DeleteLibraryModal",{attrs:{name:t.librariesList[n].name,id:t.librariesList[n].id},on:{cancel:t.btnDeleteHandler,delete:t.deleteLib}}):t._e()],1)])])]),t.modifying===n?i("b-modal",{attrs:{size:"xl","hide-footer":"","hide-header":"","no-close-on-backdrop":""},model:{value:t.modalModify,callback:function(e){t.modalModify=e},expression:"modalModify"}},[i("ModifyLibrary",{attrs:{index:n,nameAux:t.librariesList[n].name,descriptionAux:t.librariesList[n].description,privacyAux:t.librariesList[n].privacy,id:t.librariesList[n].id},on:{cancel:t.btnModifyLib,modify:t.modifyLibrary}})],1):t._e()],1)})),1)],1)],1)},Bt=[],It=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create"},[t._m(0),i("b-container",{staticClass:"row"},[i("b-container",{staticClass:"col"},[i("b-container",{staticClass:"row",attrs:{fluid:""}},[i("label",[t._v("Nombre ("+t._s(t.getNameTam)+" / 50)")]),0===t.name.length?i("b-form-input",{attrs:{type:"text",state:this.name.length>0&&this.name.length<=50,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Nombre"},on:{keydown:[function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}],input:t.characterLimitName,paste:t.characterLimitName},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}):i("b-form-input",{attrs:{type:"text",state:this.name.length>0&&this.name.length<=50,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Nombre"},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:t.characterLimitName,paste:t.characterLimitName},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),this.name.length<=0?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Introduce al menos 1 caracter ")]):i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 50 caracteres ")])],1),i("br"),i("b-container",{staticClass:"row",attrs:{fluid:""}},[i("label",[t._v("¿Cómo deseas la privacidad de tu biblioteca?")]),i("b-form-group",[i("b-form-radio",{attrs:{value:"public"},model:{value:t.privacy,callback:function(e){t.privacy=e},expression:"privacy"}},[t._v(" Pública: La podrá ver todo el mundo")]),i("b-form-radio",{attrs:{value:"private"},model:{value:t.privacy,callback:function(e){t.privacy=e},expression:"privacy"}},[t._v(" Privada: Solo la podrás ver tú")])],1)],1)],1),i("b-container",{staticClass:"col"},[i("b-row",{staticClass:"my-1"},[i("b-container",{attrs:{sm:"3"}},[i("label",[t._v("Descripción "+t._s(t.getDescriptionTam)+" / 300")]),0===t.description.length?i("b-form-textarea",{attrs:{placeholder:"Descripción",rows:"3","max-rows":"6"},on:{keydown:[function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}],input:t.characterLimitDescription,paste:t.characterLimitDescription},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}):i("b-form-textarea",{attrs:{state:t.description.length<=300,"aria-describedby":"input-live-help input-live-feedback",rows:"3","max-rows":"6"},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:t.characterLimitDescription,paste:t.characterLimitDescription},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),t.description.length>=300?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 300 caracteres ")]):t._e()],1)],1)],1)],1),i("div",{staticClass:"d-flex justify-content-end"},[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.cancelButton()}}},[t._v("Cancelar")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"dark",disabled:this.name.length<=0||t.checkNames()||!t.checkDescription()},on:{click:t.createButton}},[t._v("Crear")])],1)],1)},zt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex justify-content-start"},[i("h4",[t._v("Crear biblioteca")])])}],Et=(i("fb6a"),{name:"CreateLibrary",data:function(){return{name:"",description:"",privacy:"public",librariesNamesList:[],modalCreate:!1}},mounted:function(){var t=this,e=A.state.userNick;x.where("nick","==",e).get().then((function(e){e.forEach((function(e){t.librariesNamesList.push({name:e.data().name})}))}))},computed:{getNameTam:function(){return this.name.length},getDescriptionTam:function(){return this.description.length}},methods:{characterLimitName:function(){var t=this.name,e=this.name.length;t.length>50&&(e-=50,this.name=t.slice(0,-e))},characterLimitDescription:function(){var t=this.description,e=this.description.length;t.length>300&&(e-=300,this.description=t.slice(0,-e))},checkNames:function(){for(var t=!1,e=0;e<this.librariesNamesList.length;++e)if(this.name===this.librariesNamesList[e].name){t=!0;break}return t||" "===this.name[this.name.length-1]&&(t=!0),t},checkDescription:function(){if(this.description.length>0){if(" "===this.description[this.description.length-1])return!1;for(var t=0;t<this.description.length;++t)if("\n"===this.description[t])return!1}return!0},createButton:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return t=A.state.userNick,this.modalCreate=!1,e.next=4,regeneratorRuntime.awrap(x.add({name:this.name,description:this.description,privacy:this.privacy,nick:t,user_id:A.state.userID,array_keys:[]}));case 4:this.$emit("create");case 5:case"end":return e.stop()}}),null,this)},cancelButton:function(){this.modalCreate=!1,this.$emit("cancel")}}}),Rt=Et,Wt=(i("c531"),Object(_["a"])(Rt,It,zt,!1,null,"fd522868",null)),$t=Wt.exports,jt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create",on:{click:function(t){t.stopPropagation()}}},[t._m(0),i("b-container",{staticClass:"row"},[i("b-container",{staticClass:"col"},[i("b-container",{staticClass:"row",attrs:{fluid:""}},[i("label",[t._v("Nombre ("+t._s(t.getNameTam)+" / 50)")]),0===t.name.length?i("b-form-input",{attrs:{type:"text",state:this.name.length>0&&this.name.length<=50,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Nombre"},on:{keydown:[function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}],input:t.characterLimitName,paste:t.characterLimitName},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}):i("b-form-input",{attrs:{type:"text",state:this.name.length>0&&this.name.length<=50,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Nombre"},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:t.characterLimitName,paste:t.characterLimitName},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),this.name.length<=0?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Introduce al menos 1 caracter ")]):i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 50 caracteres ")])],1),i("br"),i("b-container",{staticClass:"row",attrs:{fluid:""}},[i("label",[t._v("¿Cómo deseas la privacidad de tu biblioteca?")]),i("b-form-group",[i("b-form-radio",{attrs:{value:"public"},model:{value:t.privacy,callback:function(e){t.privacy=e},expression:"privacy"}},[t._v(" Pública: La podrá ver todo el mundo")]),i("b-form-radio",{attrs:{value:"private"},model:{value:t.privacy,callback:function(e){t.privacy=e},expression:"privacy"}},[t._v(" Privada: Solo la podrás ver tú")])],1)],1)],1),i("b-container",{staticClass:"col"},[i("b-row",{staticClass:"my-1"},[i("b-container",{attrs:{sm:"3"}},[i("label",[t._v("Descripción "+t._s(t.getDescriptionTam)+" / 300")]),0===t.description.length?i("b-form-textarea",{attrs:{placeholder:"Descripción",rows:"3","max-rows":"6"},on:{keydown:[function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}],input:t.characterLimitDescription,paste:t.characterLimitDescription},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}):i("b-form-textarea",{attrs:{state:t.description.length<=300,"aria-describedby":"input-live-help input-live-feedback",rows:"3","max-rows":"6"},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},input:t.characterLimitDescription,paste:t.characterLimitDescription},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}}),t.description.length>=300?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 300 caracteres ")]):t._e()],1)],1)],1)],1),i("div",{staticClass:"d-flex justify-content-end"},[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-secondary"},on:{click:function(e){return t.cancelButton()}}},[t._v("Descartar cambios")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"dark",disabled:this.name.length<=0||t.checkNames()||!t.checkDescription()},on:{click:t.modifyButton}},[t._v("Guardar")])],1)],1)},qt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex justify-content-start"},[i("h4",[t._v("Modificar biblioteca")])])}],Ut=(i("a9e3"),{name:"CreateLibrary",props:{index:Number,nameAux:String,descriptionAux:String,privacyAux:String,id:String},data:function(){return{name:this.nameAux,description:this.descriptionAux,privacy:this.privacyAux,librariesNamesList:[],modalModify:!1}},mounted:function(){var t=this,e=A.state.userNick;x.where("nick","==",e).get().then((function(e){e.forEach((function(e){e.data().name!==t.nameAux&&t.librariesNamesList.push({name:e.data().name})}))}))},computed:{getNameTam:function(){return this.name.length},getDescriptionTam:function(){return this.description.length}},methods:{characterLimitName:function(){var t=this.name,e=this.name.length;t.length>50&&(e-=50,this.name=t.slice(0,-e))},characterLimitDescription:function(){var t=this.description,e=this.description.length;t.length>300&&(e-=300,this.description=t.slice(0,-e))},checkNames:function(){for(var t=!1,e=0;e<this.librariesNamesList.length;++e)if(this.name===this.librariesNamesList[e].name){t=!0;break}return t||" "===this.name[this.name.length-1]&&(t=!0),t},checkDescription:function(){if(this.description.length>0){if(" "===this.description[this.description.length-1])return!1;for(var t=0;t<this.description.length;++t)if("\n"===this.description[t])return!1}return!0},modifyButton:function(){var t=this,e=A.state.userNick;this.modalModify=!1,this.nameAux!==this.name||this.descriptionAux!==this.description||this.privacyAux!==this.privacy?x.doc(this.id).update({name:this.name,description:this.description,privacy:this.privacy,nick:e}).then((function(){t.$emit("modify")})):this.$emit("modify")},cancelButton:function(){this.modalModify=!1,this.$emit("cancel",-1)}}}),Ht=Ut,Vt=(i("7c25"),Object(_["a"])(Ht,jt,qt,!1,null,"ecde3f92",null)),Ft=Vt.exports,Gt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-modal",{attrs:{id:"bv-modal-example",title:"Eliminar biblioteca",centered:"","no-close-on-backdrop":""},on:{hide:t.cancelButton},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{size:"mt-1",variant:"primary"},on:{click:t.cancelButton}},[t._v("No")]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{size:"mt-1",variant:"outline-danger"},on:{click:t.deleteButton}},[t._v("Sí")])]},proxy:!0}])},[i("span",[t._v("¿Seguro que deseas eliminar la biblioteca "+t._s(t.name)+"?")])])},Kt=[],Jt={name:"deleteLibraryModal",props:{name:String,id:String},mounted:function(){this.$bvModal.show("bv-modal-example")},methods:{cancelButton:function(){this.$emit("cancel",-1)},deleteButton:function(){this.$emit("delete",this.id)}}},Xt=Jt,Zt=Object(_["a"])(Xt,Gt,Kt,!1,null,"75aa8ccc",null),Qt=Zt.exports,Yt={name:"libraries",components:{CreateLibrary:$t,ModifyLibrary:Ft,DeleteLibraryModal:Qt},data:function(){return{librariesList:[],searchHistory:A.state.userNick.concat("_historial").toLowerCase(),showModal:-1,modifying:-1,numberOfLibraries:-3,internetConnection:1,modalCreate:!1,modalModify:!1}},mounted:function(){var t=this;p.on("value",(function(e){!0===e.val()&&0!==t.internetConnection?(t.internetConnection=0,t.refresh()):!1===e.val()&&0!==t.internetConnection&&(t.internetConnection=-1)}))},methods:{refresh:function(){var t,e,i=this;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return this.numberOfLibraries=-1,t=[],e=A.state.userID,n.next=5,regeneratorRuntime.awrap(x.where("user_id","==",e).get().then((function(e){e.forEach((function(e){e.id===i.searchHistory?t.unshift({id:e.id,name:e.data().name,description:e.data().description,privacy:e.data().privacy,numberOfBooks:e.data().array_keys.length}):t.push({id:e.id,name:e.data().name,description:e.data().description,privacy:e.data().privacy,numberOfBooks:e.data().array_keys.length})}))})));case 5:this.librariesList=t,this.numberOfLibraries=this.librariesList.length;case 7:case"end":return n.stop()}}),null,this)},btnModifyLib:function(t){this.modifying=t,this.modalModify=!0},btnDeleteHandler:function(t){this.showModal=t},btnEmptyHistory:function(t){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(x.doc(t).update({array_keys:[]}));case 2:this.refresh();case 3:case"end":return e.stop()}}),null,this)},deleteLib:function(t){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(x.doc(t).delete());case 2:this.refresh(),this.showModal=-1;case 4:case"end":return e.stop()}}),null,this)},createLibrary:function(){this.modalCreate=!1,this.refresh()},modifyLibrary:function(){this.refresh(),this.btnModifyLib(-1),this.modalModify=!1},discardChangesLibrary:function(){this.modalCreate=!1,this.modifying=-1,this.modalModify=!1},viewLibrary:function(t,e,i,n){var s=!1;this.librariesList[n].id===this.searchHistory&&(s=!0),-1!==this.modifying||this.opened||this.$router.push({name:"viewLibrary",params:{libID:t,name:e,numberOfBooks:i,idx:n,historial:s}})}}},te=Yt,ee=(i("5337"),Object(_["a"])(te,Mt,Bt,!1,null,"dd5a2e6e",null)),ie=ee.exports,ne=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"viewLibrary"},[i("b-card",{staticClass:"background-card"},[i("div",{staticClass:"d-flex justify-content-start"},[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light"},on:{click:function(e){return t.goBack()}}},[i("b-icon",{attrs:{icon:"chevron-left"}})],1),i("div",[i("h4",[t._v(t._s(t.name)+" ")]),1===t.numberOfBooks?i("h6",{staticClass:"nBooks"},[t._v(" "+t._s(t.numberOfBooks)+" libro")]):t.numberOfBooks>1?i("h6",{staticClass:"nBooks"},[t._v(" "+t._s(t.numberOfBooks)+" libros")]):t._e()])],1),i("br"),i("br"),0===this.numberOfBooks&&0===this.internetConnection?i("h3",[t._v("No hay libros en esta biblioteca")]):-1===this.numberOfBooks&&0===this.internetConnection?i("h3",[t._v("Cargando")]):-1===this.internetConnection?i("h3",[t._v("vaya, parece que no tienes conexión y no podemos mostrar los libros de esta biblioteca"),i("br"),t._v("Revisa tu conexión y actualiza la página para solucionar el problema")]):i("span",t._l(t.booksList,(function(e,n){return i("b-list-group",{key:n},[1==e.found?i("b-list-group-item",[i("div",{staticClass:"d-flex justify-content-start"},[i("div",{staticClass:"card-img-box"},[i("img",{staticClass:"card-img-top",attrs:{src:e.cover,alt:"Portada"},on:{click:function(i){return t.openBook(e,n)}}})]),i("div",[!1===t.historial?i("b-button-group",{staticClass:"mr-1 move-button"},[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light",disabled:0===n},on:{click:function(e){return e.stopPropagation(),t.upButton(n)}}},[i("b-icon",{attrs:{icon:"chevron-up"}})],1),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light",disabled:n===t.booksList.length-1},on:{click:function(e){return e.stopPropagation(),t.downButton(n)}}},[i("b-icon",{attrs:{icon:"chevron-down"}})],1)],1):t._e(),i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"card-title",on:{click:function(i){return t.openBook(e,n)}}},[t._v(t._s(t.upperCase(e.title)))])]),i("div",{staticClass:"d-flex justify-content-start"},[""!==e.description?i("b-card-text",[t._v(" "+t._s(e.description)+" ")]):i("b-card-text",[t._v(" Sin descripción ")])],1),!1===t.historial?i("div",{staticClass:"mr-1 del-button"},[i("b-button",{staticClass:"m-md-2",staticStyle:{"font-size":"16px"},attrs:{variant:"danger"},on:{click:function(e){return e.stopPropagation(),t.deleteButton(n)}}},[t._v("Eliminar")])],1):t._e()],1)])]):i("b-list-group-item",{attrs:{variant:"danger"}},[!1===t.historial?i("b-button-group",{staticClass:"mr-1 move-button"},[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light",disabled:0===n},on:{click:function(e){return e.stopPropagation(),t.upButton(n)}}},[i("b-icon",{attrs:{icon:"chevron-up"}})],1),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light",disabled:n===t.booksList.length-1},on:{click:function(e){return e.stopPropagation(),t.downButton(n)}}},[i("b-icon",{attrs:{icon:"chevron-down"}})],1)],1):t._e(),i("div",{staticClass:"d-flex justify-content-start"},[2==e.found?i("h5",[i("b-icon",{attrs:{variant:"danger",icon:"exclamation-octagon-fill"}}),t._v(" Libro no publicado")],1):i("h5",[i("b-icon",{attrs:{variant:"danger",icon:"exclamation-octagon-fill"}}),t._v(" Libro no encontrado")],1),i("h6",{staticClass:"ml-2 nBooks"},[t._v("("+t._s(e.id)+")")])]),i("div",{staticClass:"d-flex justify-content-start"},[2==e.found?i("b-card-text",[t._v(" El autor de este libro ha decidido no publicarlo. Se podrá leer cuando se publique. ")]):i("b-card-text",[t._v(" No se encuentra este libro, quizá haya sido eliminado. ")])],1),!1===t.historial?i("div",{staticClass:"mr-1 del-button"},[i("b-button",{staticClass:"m-md-2",staticStyle:{"font-size":"16px"},attrs:{variant:"danger"},on:{click:function(e){return e.stopPropagation(),t.deleteButton(n)}}},[t._v("Eliminar")])],1):t._e()],1)],1)})),1)])],1)},se=[],ae={name:"viewLibrary",props:{libID:String,name:String,idx:Number,historial:Boolean},data:function(){return{booksList:[],numberOfBooks:-3,referencesList:[],internetConnection:1}},mounted:function(){var t=this;null==this.libID?this.goBack():p.on("value",(function(e){!0===e.val()&&0!==t.internetConnection?(t.internetConnection=0,t.refresh()):!1===e.val()&&0!==t.internetConnection&&(t.internetConnection=-1)}))},methods:{refresh:function(){var t,e,i,n=this;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return this.booksList=[],this.referencesList=[],this.numberOfBooks=-1,s.next=5,regeneratorRuntime.awrap(x.doc(this.libID).get().then((function(e){t=e.data().array_keys})));case 5:e=function(e){var i;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return i=t[e],n.referencesList.push(t[e]),s.next=4,regeneratorRuntime.awrap(v.doc(i).get().then((function(t){t.exists&&(t.data().published||t.data().user_id===A.state.userID)?n.booksList.push({found:1,id:i,title:t.data().title,author:t.data().author,description:t.data().description,cover:t.data().cover}):t.exists?n.booksList.push({found:2,id:i}):n.booksList.push({found:0,id:i})})));case 4:case"end":return s.stop()}}))},i=0;case 7:if(!(i<t.length)){s.next=13;break}return s.next=10,regeneratorRuntime.awrap(e(i));case 10:++i,s.next=7;break;case 13:this.numberOfBooks=this.booksList.length;case 14:case"end":return s.stop()}}),null,this)},goBack:function(){this.$router.go(-1)},updateReferencesList:function(){x.doc(this.libID).update({array_keys:this.referencesList})},deleteButton:function(t){this.referencesList.splice(t,1),this.updateReferencesList(),this.refresh()},upButton:function(t){var e=t-1,i=this.referencesList[e];this.referencesList[e]=this.referencesList[t],this.referencesList[t]=i,this.updateReferencesList(),this.refresh()},downButton:function(t){var e=t+1,i=this.referencesList[e];this.referencesList[e]=this.referencesList[t],this.referencesList[t]=i,this.updateReferencesList(),this.refresh()},openBook:function(t,e){var i,n;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(v.doc(this.referencesList[e]).get().then((function(t){n=t.data().user_id,i={author:t.data().author,title:t.data().title,description:t.data().description,cover:t.data().cover,tags:t.data().tags,userID:t.data().user_id,sections:t.data().sections,customBoxes:t.data().customBoxes}})));case 2:return t.next=4,regeneratorRuntime.awrap(b.doc(n).get().then((function(t){i.nick=t.data().nick,i.name=t.data().name})));case 4:A.commit("openBookID",this.referencesList[e]),A.commit("openBook",i),A.commit("changeSection",i.sections[0]),this.$router.push({name:"readBook"});case 8:case"end":return t.stop()}}),null,this)},upperCase:function(t){return t.toUpperCase()}}},oe=ae,re=(i("c86d"),Object(_["a"])(oe,ne,se,!1,null,"76ee6390",null)),ce=re.exports,le=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("LoadingModal"):t._e(),t.saving?i("SavingModal"):t._e(),i("div",{staticClass:"buttons"},[i("link",{attrs:{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"}}),i("div",{staticClass:"row d-flex justify-content-end"},[i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"16px"},attrs:{title:"Salir sin guardar",variant:"light"},on:{click:function(e){return t.goBack()}}},[i("b-icon",{attrs:{icon:"chevron-left"}})],1),i("div",{staticClass:"col"},[i("h3",{staticClass:"mr-auto",staticStyle:{"padding-top":"15px"}},[t._v(t._s(t.book.title))])]),i("div",{staticClass:"col",staticStyle:{"padding-top":"15px"}},[i("b-form-select",{attrs:{options:t.sectionsData},on:{change:function(e){return t.changeSection(t.nextSectionID)}},model:{value:t.nextSectionID,callback:function(e){t.nextSectionID=e},expression:"nextSectionID"}})],1),i("div",{staticClass:"col",staticStyle:{"padding-top":"15px"}},[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light",size:"sm"},on:{click:function(e){return t.openManagementSectionModal()}}},[t._v("Gestión de secciones")])],1),i("div",{staticClass:"col",staticStyle:{"padding-top":"15px"}},[i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"light",size:"sm"},on:{click:function(e){t.showPreviewSection=!0}}},[t._v("Previsualizar libro")])],1),t.showManagementSectionModal?i("SectionManagementModal",{attrs:{name:t.sectionName,id:t.sectionID,book_title:t.book.title,book_author_ID:t.book.userID,sectionsList:t.book.sections},on:{update:t.auxUpdateBookSections,load:t.refresh,saveActual:t.auxSave,deleteCustomBoxes:t.auxDeleteCustomBoxes,cancel:t.openManagementSectionModal}}):t._e(),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"16px"},attrs:{variant:"outline-dark",title:"Descargar",hidden:""}},[i("b-icon",{attrs:{icon:"cloud-download"}})],1),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"16px"},attrs:{variant:"outline-dark",title:"Guardar"},on:{click:function(e){return t.save()}}},[i("i",{staticClass:"fa fa-save",on:{mouseup:function(e){return t.save()}}})]),i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"dark"},on:{click:function(e){return t.goBackAndSave()}}},[t._v("Guardar y salir")])],1)]),i("div",{staticClass:"row flex-xl-nowrap2"},[i("div",{staticClass:"bd-sidebar border-bottom-0 col-md-3 col-xl-2 col-12"},[i("h4",[t._v("Gadgets")]),i("hr"),i("div",[0==t.data.length?i("span",{staticStyle:{color:"red"}},[t._v("No hay gadgets creados. Para editar el documento, agrega uno primero")]):t._e(),t._l(t.data,(function(e,n){return i("div",{key:n},[t.lastPress!==n?i("div",{staticClass:"sidebarBlock",on:{click:function(e){return t.lastElementPressed(n)}}},[i("span",[t._v(t._s(e.componentName))]),i("div",{staticClass:"h5 lg, verticalLine"},[i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"marginLeftButton",attrs:{icon:"chevron-up",title:"Subir"},on:{click:function(t){t.stopPropagation()},mouseup:function(e){return t.itemUp(n)}}},[t._v("Subir gadget")]),i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"marginLeftButton",attrs:{icon:"chevron-down",title:"Bajar"},on:{click:function(t){t.stopPropagation()},mouseup:function(e){return t.itemDown(n)}}},[t._v("Bajar gadget")]),i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"marginLeftButton",attrs:{icon:"layers",title:"Duplicar"},on:{click:function(t){t.stopPropagation()},mouseup:function(e){return t.itemClone(n)}}},[t._v("Duplicar gadget")]),i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"marginLeftButton",attrs:{icon:"trash-fill",title:"Eliminar"},on:{click:function(t){t.stopPropagation()},mouseup:function(e){return t.itemDelete(n)}}},[t._v("Eliminar gaget")])],1)]):i("div",{staticClass:"sidebarBlockSelected",on:{click:function(e){return t.lastElementPressed(n)}}},[i("span",[t._v(t._s(e.componentName))]),i("div",{staticClass:"h5 lg, verticalLine"},[i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"marginLeftButtonSelected",attrs:{icon:"chevron-up",title:"Subir"},on:{click:function(t){t.stopPropagation()},mouseup:function(e){return t.itemUp(n)}}},[t._v("Subir gadget")]),i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"marginLeftButtonSelected",attrs:{icon:"chevron-down",title:"Bajar"},on:{click:function(t){t.stopPropagation()},mouseup:function(e){return t.itemDown(n)}}},[t._v("Bajar gadget")]),i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"marginLeftButtonSelected",attrs:{icon:"layers",title:"Duplicar"},on:{click:function(t){t.stopPropagation()},mouseup:function(e){return t.itemClone(n)}}},[t._v("Duplicar gadget")]),i("b-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"marginLeftButtonSelected",attrs:{icon:"trash-fill",title:"Eliminar"},on:{click:function(t){t.stopPropagation()},mouseup:function(e){return t.itemDelete(n)}}},[t._v("Eliminar gadget")])],1)])])})),i("hr")],2)]),i("div",{staticClass:"bd-content col-md-9 col-xl-8 col-12"},[i("div",{staticClass:"document",on:{keyup:t.checkStyles,keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab"))return null;e.preventDefault()}}},t._l(t.data,(function(e,n){return i("div",{key:n,staticClass:"editable",on:{click:function(e){t.lastElementPressed(n),t.checkStyles()}}},["Normal"==e.component?i("Normal",{attrs:{htmlTextAux:e.htmlText,index:n,boldUse:t.boldUse,italicUse:t.italicUse,underlineUse:t.underlineUse,strikeThroughUse:t.strikeThroughUse,lastPress:t.lastPress},on:{html:t.saveHTML,delete:t.checkDelete}}):t._e(),"Header1"==e.component?i("Header1",{attrs:{htmlTextAux:e.htmlText,plainTextAux:e.plainText,index:n},on:{html:t.savePlaneAndHTML}}):t._e(),"Header2"==e.component?i("Header2",{attrs:{htmlTextAux:e.htmlText,plainTextAux:e.plainText,index:n},on:{html:t.savePlaneAndHTML}}):t._e(),"Header3"==e.component?i("Header3",{attrs:{htmlTextAux:e.htmlText,plainTextAux:e.plainText,index:n},on:{html:t.savePlaneAndHTML}}):t._e(),"ExpandableText"==e.component?i("ExpandableText",{attrs:{index:n,mainTextAux:e.mainText,expandedTextAux:e.expandedText,lastPressed:t.lastPress},on:{html:t.saveExpandableText}}):t._e(),"PopupText"==e.component?i("PopupText",{attrs:{index:n,mainTextAux:e.mainText,popupTextAux:e.popupText,htmlTextAux:e.htmlText,pictureAux:e.picture,lastPressed:t.lastPress},on:{html:t.savePopupText}}):t._e(),"Hyperlink"==e.component?i("Hyperlink",{attrs:{index:n,mainTextAux:e.mainText,hyperlinkTextAux:e.hyperlinkText,lastPressed:t.lastPress},on:{html:t.saveHyperlink}}):t._e(),"Spoiler"==e.component?i("Spoiler",{attrs:{htmlTextAux:e.htmlText,plainTextAux:e.plainText,index:n},on:{html:t.savePlaneAndHTML}}):t._e(),"Picture"===e.component?i("PictureGadget",{attrs:{bookID:t.bookID,htmlTextAux:e.htmlText,index:n,pictureAux:e.url},on:{html:t.saveHTMLPicture}}):t._e(),"Video"===e.component?i("VideoGadget",{attrs:{index:n,htmlTextAux:e.htmlText,bookID:t.bookID,videoAux:e.url,autoplayAux:e.autoplay,loopAux:e.loop},on:{html:t.saveHTMLVideo}}):t._e(),"ChangeSection"==e.component?i("ChangeSection",{attrs:{actualSection:t.sectionID,auxSectionsData:t.sectionsData,selectedSection:e.next,textAux:e.plainText,index:n},on:{section:t.saveHTMLAndSection}}):t._e(),"RepeatSection"==e.component?i("RepeatSection",{attrs:{actualSection:t.sectionID,sectionName:t.sectionName,textAux:e.plainText,index:n},on:{html:t.savePlaneAndHTML}}):t._e(),"DecisionMaking"==e.component?i("DecisionMaking",{attrs:{actualSection:t.sectionID,auxSectionsData:t.sectionsData,auxDecisions:e.choices,auxNumberOfOptions:e.numberOfOptions,index:n},on:{section:t.saveChoices}}):t._e(),"Riddle"==e.component?i("Riddle",{attrs:{actualSection:t.sectionID,auxSectionsData:t.sectionsData,wrongSectionAux:e.wrongSection,rightSectionAux:e.rightSection,riddleTextAux:e.riddleText,answerTextAux:e.answerText,numberOfTriesAux:e.numberOfTries,changeSectionWhenWrongAux:e.changeSectionWhenWrong,index:n},on:{section:t.saveHTMLRiddle}}):t._e(),"Sequence"==e.component?i("Sequence",{attrs:{actualSection:t.sectionID,auxSectionsData:t.sectionsData,auxSequence:e.sequence,auxSolution:e.solution,auxChangeSectionWhenWrong:e.changeSectionWhenWrong,auxWrongSection:e.wrongSection,auxRightSection:e.rightSection,auxNumberOfTries:e.numberOfTries,index:n},on:{section:t.saveSequence}}):t._e(),"RandomNumber"==e.component?i("RandomNumber",{attrs:{actualSection:t.sectionID,auxSectionsData:t.sectionsData,auxConditions:e.conditions,auxNumberOfConditions:e.numberOfConditions,auxLowerLimit:e.lowerLimit,auxUpperLimit:e.upperLimit,index:n},on:{random:t.saveRandomNumbers}}):t._e(),"MemoryCards"===e.component?i("MemoryCards",{attrs:{actualSection:t.sectionID,sectionsDataAux:t.sectionsData,numberOfPairsAux:e.numberOfPairs,maxNumberOfMovesAux:e.maxNumberOfMoves,sectionNoMoreMovesAux:e.sectionNoMoreMoves,sectionSolvedAux:e.sectionSolved,changeSectionWhenWrongAux:e.changeSectionWhenWrong,customizedAux:e.customized,typeChosenAux:e.typeChosen,customWordsAux:e.customWords,customColorsAux:e.customColors,index:n},on:{save:t.saveMemoryCards}}):t._e(),"CompleteClues"===e.component?i("CompleteClues",{attrs:{actualSection:t.sectionID,auxSectionsData:t.sectionsData,auxAnswersNumber:e.answersNumber,auxAnswers:e.answers,auxCluesNumber:e.cluesNumber,auxClues:e.clues,auxOnGuess:e.onGuess,auxChangeSectionWhenWrong:e.changeSectionWhenWrong,auxOnWrong:e.onWrong,index:n},on:{clues:t.saveClues}}):t._e(),"CustomBox"===e.component?i("CustomBoxes",{attrs:{auxCustomBoxesData:t.temporalCustomBoxes,auxName:e.name,auxMode:e.mode,auxType:e.type,auxValue:e.value,auxDefaultValue:e.defaultValue,auxTitle:e.title,auxPrevText:e.prevText,auxNextText:e.nextText,index:n},on:{read:t.checkRead,write:t.checkWrite,update:t.checkUpdate,save:t.saveCustomBox,saveLimited:t.saveLimitedCustomBox}}):t._e()],1)})),0)]),i("div",{staticClass:"bd-toc col-xl-2 d-none d-xl-block"},[i("h4",[t._v("Añadir gadgets")]),i("hr"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addTitle()}}},[i("b-icon",{attrs:{icon:"fonts"}}),t._v(" Título ")],1),i("br"),i("span",[t._v("Opciones del gadget:")]),i("h5",[1!=t.header1Active?i("b-icon",{staticClass:"buttonNormal",attrs:{icon:"type-h1"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Header1")}}},[t._v("Añadir título 1")]):i("b-icon",{staticClass:"buttonPressed",attrs:{icon:"type-h1"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Header1")}}},[t._v("Añadir título 1")]),1!=t.header2Active?i("b-icon",{staticClass:"buttonNormal",attrs:{icon:"type-h2"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Header2")}}},[t._v("Añadir título 2")]):i("b-icon",{staticClass:"buttonPressed",attrs:{icon:"type-h2"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Header2")}}},[t._v("Añadir título 2")]),1!=t.header3Active?i("b-icon",{staticClass:"buttonNormalRightBorder",attrs:{icon:"type-h3"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Header3")}}},[t._v("Añadir título 3")]):i("b-icon",{staticClass:"buttonPressedRightBorder",attrs:{icon:"type-h3"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Header3")}}},[t._v("Añadir título 3")])],1),i("hr"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addNormal()}}},[i("b-icon",{attrs:{icon:"justify-left"}}),t._v(" Texto normal ")],1),i("br"),i("span",[t._v("Opciones del gadget:")]),i("h5",[1!=t.boldActive?i("b-icon",{staticClass:"buttonNormal",attrs:{icon:"type-bold"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Bold")}}},[t._v("Bold")]):i("b-icon",{staticClass:"buttonPressed",attrs:{icon:"type-bold"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Bold")}}},[t._v("Bold")]),1!=t.italicActive?i("b-icon",{staticClass:"buttonNormal",attrs:{icon:"type-italic"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Italic")}}},[t._v("Italic")]):i("b-icon",{staticClass:"buttonPressed",attrs:{icon:"type-italic"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Italic")}}},[t._v("Italic")]),1!=t.underlineActive?i("b-icon",{staticClass:"buttonNormal",attrs:{icon:"type-underline"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Underline")}}},[t._v("Underline")]):i("b-icon",{staticClass:"buttonPressed",attrs:{icon:"type-underline"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"Underline")}}},[t._v("Underline")]),1!=t.strikeThroughActive?i("b-icon",{staticClass:"buttonNormalRightBorder",attrs:{icon:"type-strikethrough"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"StrikeThrough")}}},[t._v("strikeThrough")]):i("b-icon",{staticClass:"buttonPressedRightBorder",attrs:{icon:"type-strikethrough"},on:{mousedown:function(e){return t.onLiveEditComponent(e,"StrikeThrough")}}},[t._v("strikeThrough")])],1),i("hr"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addPicture()}}},[i("b-icon",{attrs:{icon:"image-fill"}}),t._v(" Imagen ")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addVideo()}}},[i("b-icon",{attrs:{icon:"camera-video-fill"}}),t._v(" Vídeo ")],1),i("hr"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addExandableText()}}},[i("b-icon",{attrs:{icon:"layers-half"}}),t._v(" Texto expandible")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addPopupText()}}},[i("b-icon",{attrs:{icon:"files-alt"}}),t._v(" Anotaciones")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addHyperlink()}}},[i("b-icon",{attrs:{icon:"link"}}),t._v(" Hipervínculo")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addSpoiler()}}},[i("b-icon",{attrs:{icon:"Square-fill"}}),t._v(" Spoiler")],1),i("hr"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addSectionChange()}}},[i("b-icon",{attrs:{icon:"box-arrow-right"}}),t._v(" Siguiente sección")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addSectionRepeat()}}},[i("b-icon",{attrs:{icon:"arrow-repeat"}}),t._v(" Repetir sección")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addDecisionMaking()}}},[i("b-icon",{attrs:{icon:"list-task"}}),t._v(" Decisiones")],1),i("div"),i("hr"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addRiddle()}}},[i("b-icon",{attrs:{icon:"question"}}),t._v(" Adivinanzas")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addSequence()}}},[i("b-icon",{attrs:{icon:"three-dots"}}),t._v(" Secuencia")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addMemoryCards()}}},[i("b-icon",{attrs:{icon:"grid-fill"}}),t._v(" Tarjetas de memoria")],1),i("hr"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addRandomNumber()}}},[i("b-icon",{attrs:{icon:"hash"}}),t._v(" Número aleatorio")],1),i("div"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addClues()}}},[i("b-icon",{attrs:{icon:"puzzle-fill"}}),t._v(" Pistas")],1),i("hr"),i("span",{staticClass:"clickable",on:{click:function(e){return t.addCustomBox()}}},[i("b-icon",{attrs:{icon:"pencil"}}),t._v(" Casilla personalizada")],1),i("hr")])]),i("b-modal",{attrs:{centered:"","hide-header":"","hide-footer":"","no-close-on-backdrop":""},model:{value:t.showPreviewSection,callback:function(e){t.showPreviewSection=e},expression:"showPreviewSection"}},[i("h4",{staticStyle:{"padding-bottom":"8px"}},[t._v("Previsualizar sección")]),i("p",{staticStyle:{"text-align":"justify"}},[t._v("La previsualización empezará en la sección en la que se encuentra ahora mismo, para poder hacerlo es "),i("b",[t._v("necesario guardar")]),t._v(" los cambios realizados. Si no quiere guardar los cambios realizados le recomendamos que cancele hasta que esté seguro de su decisión.")]),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticStyle:{width:"150px","font-size":"16px"},attrs:{variant:"outline-secondary"},on:{click:function(e){t.showPreviewSection=!1}}},[t._v("Cancelar")]),i("b-button",{staticStyle:{width:"150px","font-size":"16px"},attrs:{variant:"primary"},on:{click:function(e){return t.sectionPreview()}}},[t._v("Aceptar")])],1)])],1)},ue=[],de=(i("ac1f"),i("5319"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-modal",{attrs:{id:"bv-modal-example",size:"lg",title:"Gestión de secciones",centered:"",scrollable:"","no-close-on-backdrop":""},on:{hide:t.closeButton},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[i("b-button",{staticClass:"size",staticStyle:{"font-size":"16px"},attrs:{size:"mt-1",variant:"outline-secondary"},on:{click:t.hide}},[t._v("Guardar y cerrar")])]},proxy:!0}])},[t.loading||t.closing?t.loading&&!t.closing?i("div",{staticStyle:{"text-align":"center"}},[i("h1",[t._v("Cargando datos de las secciones")]),i("b-spinner",{attrs:{label:"Spinning"}})],1):i("div",{staticStyle:{"text-align":"center"}},[i("h1",[t._v("Cerrando")]),i("b-spinner",{attrs:{label:"Spinning"}})],1):i("div",[i("h6",[t._v("Sección actual: "+t._s(t.id)+" - "+t._s(t.name))]),i("br"),i("span",[t._v("Nota: La sección 0 de la tabla indica la primera sección que se carga al abrir el libro")]),i("table",{attrs:{id:"customers"}},[i("thead",[i("th",{staticClass:"headerIndex"}),i("th",{staticClass:"headerID"},[t._v("ID")]),i("th",{staticClass:"headerName"},[t._v("Nombre")]),i("th",{staticClass:"headerButtons"},[t._v("Acciones")])]),t._l(t.sectionsData,(function(e,n){return i("tr",{key:n},[i("th",[t._v(t._s(n))]),i("td",[t._v(t._s(e.id))]),i("td",[0==e.name.length||e.name.length>50?i("b-form-input",{attrs:{state:!1,size:"sm",placeholder:"Escribe algo"},on:{change:function(e){t.changes=!0}},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"section.name"}}):i("b-form-input",{attrs:{size:"sm",placeholder:"Escribe algo"},on:{change:function(e){t.changes=!0}},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"section.name"}})],1),i("td",[0===n||t.busy?0==n||t.busy?i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"14px"},attrs:{variant:"outline-secondary",title:"Subir",size:"sm",disabled:""},on:{click:function(e){return t.sectionUp(n)}}},[i("b-icon",{staticClass:"marginLeftButtonSelected",attrs:{icon:"chevron-up"}})],1):t._e():i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"14px"},attrs:{variant:"outline-secondary",title:"Subir",size:"sm"},on:{click:function(e){return t.sectionUp(n)}}},[i("b-icon",{staticClass:"marginLeftButtonSelected",attrs:{icon:"chevron-up"}})],1),n===t.sectionsData.length-1||t.busy?n==t.sectionsData.length-1||t.busy?i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"14px"},attrs:{variant:"outline-secondary",title:"Bajar",size:"sm",disabled:""},on:{click:function(e){return t.sectionDown(n)}}},[i("b-icon",{staticClass:"marginLeftButtonSelected",attrs:{icon:"chevron-down"}})],1):t._e():i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"14px"},attrs:{variant:"outline-secondary",title:"Bajar",size:"sm"},on:{click:function(e){return t.sectionDown(n)}}},[i("b-icon",{staticClass:"marginLeftButtonSelected",attrs:{icon:"chevron-down"}})],1),t.busy?t.busy?i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"14px"},attrs:{variant:"outline-secondary",title:"Clonar",size:"sm",disabled:""},on:{click:function(e){return t.sectionClone(n)}}},[i("b-icon",{staticClass:"marginLeftButtonSelected",attrs:{icon:"layers"}})],1):t._e():i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"14px"},attrs:{variant:"outline-secondary",title:"Clonar",size:"sm"},on:{click:function(e){return t.sectionClone(n)}}},[i("b-icon",{staticClass:"marginLeftButtonSelected",attrs:{icon:"layers"}})],1),t.sectionsData.length>1&&!t.busy?i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"14px"},attrs:{variant:"outline-danger",title:"Eliminar",size:"sm"},on:{click:function(e){return t.sectionDelete(n)}}},[i("b-icon",{staticClass:"marginLeftButtonSelected",attrs:{icon:"trash-fill"}})],1):1==t.sectionsData.length||t.busy?i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"14px"},attrs:{variant:"outline-danger",title:"Eliminar",size:"sm",disabled:""},on:{click:function(e){return t.sectionDelete(n)}}},[i("b-icon",{staticClass:"marginLeftButtonSelected",attrs:{icon:"trash-fill"}})],1):t._e()],1)])})),i("tr",[i("td",{attrs:{colspan:"4"}},[t.busy?t.busy?i("b-button",{staticClass:"block",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-success",disabled:""},on:{click:t.newSection}},[t._v("Nueva sección")]):t._e():i("b-button",{staticClass:"block",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-success"},on:{click:t.newSection}},[t._v("Nueva sección")])],1)])],2),t.changes&&!t.busy?i("span",[t._v("Los cambios se guardarán al cerrar la ventana")]):t._e()])])}),he=[],me=(i("498a"),{name:"sectionManagementModal",props:{name:String,id:String,book_title:String,book_author_ID:String,sectionsList:Array},data:function(){return{sectionsData:[],busy:!1,loading:!1,closing:!1,changes:!1}},mounted:function(){this.$bvModal.show("bv-modal-example"),this.refresh()},methods:{refresh:function(){var t,e=this;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:this.loading=!0,t=0;case 2:if(!(t<this.sectionsList.length)){i.next=8;break}return i.next=5,regeneratorRuntime.awrap(g.doc(this.sectionsList[t]).get().then((function(t){e.sectionsData.push({id:t.id,name:t.data().name})})));case 5:++t,i.next=2;break;case 8:this.loading=!1;case 9:case"end":return i.stop()}}),null,this)},sectionUp:function(t){if(this.busy=!0,this.changes=!0,t>0){var e=this.sectionsData[t];this.$set(this.sectionsData,t,this.sectionsData[t-1]),this.$set(this.sectionsData,t-1,e)}this.busy=!1},sectionDown:function(t){if(this.busy=!0,this.changes=!0,t<this.sectionsData.length-1){var e=this.sectionsData[t];this.$set(this.sectionsData,t,this.sectionsData[t+1]),this.$set(this.sectionsData,t+1,e)}this.busy=!1},sectionClone:function(t){var e,i,n;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if(this.busy=!0,this.changes=!0,this.sectionsData.splice(t+1,0,{id:"Cargando...",name:"Cargando..."}),this.sectionsData[t].id!==this.id){s.next=6;break}return s.next=6,regeneratorRuntime.awrap(this.$emit("saveActual"));case 6:return s.next=8,regeneratorRuntime.awrap(g.doc(this.sectionsData[t].id).get().then((function(t){e={book_author_ID:t.data().book_author_ID,book_title:t.data().book_title,gadgets:t.data().gadgets,name:t.data().name+"-copia"}})));case 8:return e.gadgets=this.findCustomBoxes(e.gadgets),s.next=11,regeneratorRuntime.awrap(g.add({book_author_ID:e.book_author_ID,book_title:e.book_title,gadgets:e.gadgets,name:e.name.substring(0,50)}));case 11:return i=s.sent,this.sectionsData.splice(t+1,1),this.sectionsData.splice(t+1,0,{id:i.id,name:e.name.substring(0,50)}),n=this.extractIDs(),s.next=17,regeneratorRuntime.awrap(this.$emit("update",n));case 17:this.busy=!1;case 18:case"end":return s.stop()}}),null,this)},sectionDelete:function(t){var e,i;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:if(this.busy=!0,this.changes=!0,!(this.sectionsData.length>1)){n.next=23;break}return n.next=5,regeneratorRuntime.awrap(g.doc(this.sectionsData[t].id).get().then((function(t){i=t.data().gadgets})));case 5:return this.$emit("deleteCustomBoxes",i),n.next=8,regeneratorRuntime.awrap(g.doc(this.sectionsData[t].id).delete());case 8:if(this.sectionsData[t].id!==this.id){n.next=17;break}return this.sectionsData.splice(t,1),e=this.extractIDs(),n.next=13,regeneratorRuntime.awrap(this.$emit("update",e));case 13:return n.next=15,regeneratorRuntime.awrap(this.$emit("load",this.sectionsData[0].id));case 15:n.next=21;break;case 17:return this.sectionsData.splice(t,1),e=this.extractIDs(),n.next=21,regeneratorRuntime.awrap(this.$emit("update",e));case 21:n.next=24;break;case 23:window.alert("No se puede borrar esta sección al no haber ninguna más");case 24:this.busy=!1;case 25:case"end":return n.stop()}}),null,this)},newSection:function(){var t,e;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:return this.busy=!0,this.changes=!0,i.next=4,regeneratorRuntime.awrap(g.add({name:"Nueva sección",book_author_ID:this.book_author_ID,book_title:this.book_title,gadgets:[{htmlText:"",component:"Normal",componentName:"Texto normal"}]}));case 4:return t=i.sent,this.sectionsData.push({id:t.id,name:"Nueva sección"}),e=this.extractIDs(),i.next=9,regeneratorRuntime.awrap(this.$emit("update",e));case 9:this.busy=!1;case 10:case"end":return i.stop()}}),null,this)},closeButton:function(){var t,e,i=this;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:if(!this.checkNames()){n.next=19;break}if(!this.changes){n.next=15;break}return this.closing=!0,t=this.extractIDs(),n.next=6,regeneratorRuntime.awrap(this.$emit("update",t));case 6:e=0;case 7:if(!(e<this.sectionsData.length)){n.next=13;break}return n.next=10,regeneratorRuntime.awrap(g.doc(this.sectionsData[e].id).get().then((function(t){t.exists&&g.doc(i.sectionsData[e].id).update({name:i.sectionsData[e].name})})));case 10:++e,n.next=7;break;case 13:return n.next=15,regeneratorRuntime.awrap(this.$emit("load",this.id));case 15:return n.next=17,regeneratorRuntime.awrap(this.$emit("cancel"));case 17:n.next=22;break;case 19:return window.alert("Debes dar un nombre válido a todas las secciones (nombres vacíos o solo con espacios no son válidos). Los cambios no se guardarán"),n.next=22,regeneratorRuntime.awrap(this.$emit("cancel"));case 22:case"end":return n.stop()}}),null,this)},extractIDs:function(){for(var t=[],e=0;e<this.sectionsData.length;++e)t.push(this.sectionsData[e].id);return t},checkNames:function(){for(var t=!0,e=0;e<this.sectionsData.length&&t;++e)""===this.sectionsData[e].name.trim()&&(t=!1);return t},findCustomBoxes:function(t){for(var e=0;e<t.length;++e)"CustomBox"===t[e].component&&"write"===t[e].mode&&(t[e].mode="read",t[e].value="",t[e].prevText="",t[e].nextText="");return t},hide:function(){this.$bvModal.hide("bv-modal-example")}}}),pe=me,fe=(i("76da"),Object(_["a"])(pe,de,he,!1,null,"3c24a322",null)),be=fe.exports,ve=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-modal",{attrs:{id:"bv-modal-example",size:"sm","hide-header":"","hide-footer":"",centered:""},on:{hide:t.noClosing}},[i("div",{staticStyle:{"text-align":"center"}},[i("h1",[t._v("Cargando")]),i("b-spinner",{attrs:{label:"Spinning"}})],1)])},xe=[],ge={name:"loadingModal",mounted:function(){this.$bvModal.show("bv-modal-example")},methods:{noClosing:function(t){t.preventDefault()}}},we=ge,ye=Object(_["a"])(we,ve,xe,!1,null,null,null),ke=ye.exports,Se=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-modal",{attrs:{id:"bv-modal-example",size:"sm","hide-header":"","hide-footer":"",centered:""},on:{hide:t.noClosing}},[i("div",{staticStyle:{"text-align":"center"}},[i("h1",[t._v("Guardando")]),i("b-spinner",{attrs:{label:"Spinning"}})],1)])},_e=[],Ce={name:"savingModal",mounted:function(){this.$bvModal.show("bv-modal-example")},methods:{noClosing:function(t){t.preventDefault()}}},Te=Ce,Pe=Object(_["a"])(Te,Se,_e,!1,null,null,null),Ne=Pe.exports,Oe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("span",{staticClass:"editme",staticStyle:{"word-wrap":"break-word"},attrs:{id:"text"+t.index,contenteditable:""},domProps:{innerHTML:t._s(this.htmlTextAux)},on:{blur:function(e){return t.saveSelection(e,t.index)}}})])},De=[],Ae={name:"normal",props:{htmlTextAux:String,index:Number,boldUse:Boolean,italicUse:Boolean,underlineUse:Boolean,strikeThroughUse:Boolean,lastPress:Number},watch:{boldUse:function(){var t=document.getElementById("text"+this.lastPress);null!==t&&t.id==="text"+this.index&&(document.queryCommandState("Bold")&&!this.boldUse?document.execCommand("bold"):!document.queryCommandState("Bold")&&this.boldUse&&document.execCommand("bold"))},italicUse:function(){var t=document.getElementById("text"+this.lastPress);null!==t&&document.getElementById("text"+this.lastPress).id==="text"+this.index&&(document.queryCommandState("Italic")&&!this.italicUse?document.execCommand("italic"):!document.queryCommandState("Italic")&&this.italicUse&&document.execCommand("italic"))},underlineUse:function(){var t=document.getElementById("text"+this.lastPress);null!==t&&document.getElementById("text"+this.lastPress).id==="text"+this.index&&(document.queryCommandState("Underline")&&!this.underlineUse?document.execCommand("underline"):!document.queryCommandState("Underline")&&this.underlineUse&&document.execCommand("underline"))},strikeThroughUse:function(){var t=document.getElementById("text"+this.lastPress);null!==t&&document.getElementById("text"+this.lastPress).id==="text"+this.index&&(document.queryCommandState("StrikeThrough")&&!this.strikeThroughUse?document.execCommand("strikeThrough"):!document.queryCommandState("StrikeThrough")&&this.strikeThroughUse&&document.execCommand("strikeThrough"))}},methods:{saveSelection:function(t,e){var i=t.target.innerHTML,n=i;this.$emit("html",n,e)}}},Le=Ae,Me=(i("13e5"),Object(_["a"])(Le,Oe,De,!1,null,"6de14b34",null)),Be=Me.exports,Ie=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h1",{staticClass:"editme",staticStyle:{"word-wrap":"break-word"},attrs:{id:"header"+t.index,contenteditable:""},domProps:{innerHTML:t._s(this.plainTextAux)},on:{blur:function(e){return t.saveSelection(e)}}})])},ze=[],Ee={name:"header1",props:{htmlTextAux:String,plainTextAux:String,index:Number},methods:{saveSelection:function(t){var e=t.target.innerHTML,i=e,n="<h1>"+e+"</h1>";this.$emit("html",i,n,this.index)}}},Re=Ee,We=(i("a6ed"),Object(_["a"])(Re,Ie,ze,!1,null,"3795e7cd",null)),$e=We.exports,je=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h2",{staticClass:"editme",staticStyle:{"word-wrap":"break-word"},attrs:{id:"header"+t.index,contenteditable:""},domProps:{innerHTML:t._s(this.plainTextAux)},on:{blur:function(e){return t.saveSelection(e)}}})])},qe=[],Ue={name:"header1",props:{htmlTextAux:String,plainTextAux:String,index:Number},methods:{saveSelection:function(t){var e=t.target.innerHTML,i=e,n="<h2>"+e+"</h2>";this.$emit("html",i,n,this.index)}}},He=Ue,Ve=(i("c204"),Object(_["a"])(He,je,qe,!1,null,"14014cca",null)),Fe=Ve.exports,Ge=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h3",{staticClass:"editme",staticStyle:{"word-wrap":"break-word"},attrs:{id:"header"+t.index,contenteditable:""},domProps:{innerHTML:t._s(this.plainTextAux)},on:{blur:function(e){return t.saveSelection(e)}}})])},Ke=[],Je={name:"header1",props:{htmlTextAux:String,plainTextAux:String,index:Number},methods:{saveSelection:function(t){var e=t.target.innerHTML,i=e,n="<h3>"+e+"</h3>";this.$emit("html",i,n,this.index)}}},Xe=Je,Ze=(i("096b"),Object(_["a"])(Xe,Ge,Ke,!1,null,"d72d725a",null)),Qe=Ze.exports,Ye=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Edite su texto expandible")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){t.preview=!t.preview}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.preview,expression:"preview"}]},[i("hr"),i("p",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.show=!t.show}}},[t._v(t._s(t.mainText)+" "),t.show?i("b-icon",{attrs:{icon:"caret-up-fill"}}):i("b-icon",{attrs:{icon:"caret-down-fill"}})],1),i("p",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"container"},[t._v(t._s(t.expandedText))]),i("hr")]),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("label",[t._v("Texto principal")]),i("b-form-textarea",{attrs:{state:t.mainText.length<=2e3&&t.mainText.length>0,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Introduce el texto que quieres que se muestre...",rows:"3","max-rows":"6",formatter:t.limit},on:{change:function(e){return t.save()}},model:{value:t.mainText,callback:function(e){t.mainText=e},expression:"mainText"}}),t.mainText.length>1900?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.mainText.length)+" /2000")]):t.mainText.length<0?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" No se puede dejar este campo vacio ")]):t._e()],1),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("label",[t._v("Texto expandible")]),i("b-form-textarea",{attrs:{state:t.expandedText.length<=2e3&&t.expandedText.length>0,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Introduce el texto que se mostrara al expandir...",rows:"3","max-rows":"6",formatter:t.limit},on:{change:function(e){return t.save()}},model:{value:t.expandedText,callback:function(e){t.expandedText=e},expression:"expandedText"}}),t.expandedText.length>1900?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.expandedText.length)+" /2000")]):t.expandedText.length<0?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" No se puede dejar este campo vacio ")]):t._e()],1)],1)],1)},ti=[],ei={name:"expandableText",props:{mainTextAux:String,expandedTextAux:String,index:Number,lastPressed:Number},data:function(){return{mainText:this.mainTextAux,expandedText:this.expandedTextAux,show:!1,preview:!1}},watch:{mainTextAux:function(){this.refresh()},expandedTextAux:function(){this.refresh()},index:function(){this.refresh()}},methods:{refresh:function(){this.mainText=this.mainTextAux,this.expandedText=this.expandedTextAux},save:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.$emit("html",this.mainText,this.expandedText,this.index);case 1:case"end":return t.stop()}}),null,this)},limit:function(t){return String(t).substring(0,2e3)}}},ii=ei,ni=(i("c143"),Object(_["a"])(ii,Ye,ti,!1,null,"515b3fe8",null)),si=ni.exports,ai=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Edite su anotación")]),i("b-button",{staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info"},on:{click:function(e){t.preview=!t.preview}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.preview,expression:"preview"}]},[i("hr"),i("span",[t._v(t._s(t.mainText)),i("span",{staticStyle:{cursor:"pointer",color:"#0a8df4"},on:{click:function(e){t.openPopupTextModal=!t.openPopupTextModal}}},[t._v(" [...]")])]),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",scrollable:"",centered:""},model:{value:t.openPopupTextModal,callback:function(e){t.openPopupTextModal=e},expression:"openPopupTextModal"}},[i("p",{directives:[{name:"show",rawName:"v-show",value:t.openPopupTextModal,expression:"openPopupTextModal"}]},[t._v(t._s(t.popupText))]),i("div",{domProps:{innerHTML:t._s(t.htmlText)}})]),i("hr")],1),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("label",[t._v("Texto principal")]),i("b-form-textarea",{attrs:{state:t.mainText.length<=2e3&&t.mainText.length>0,formatter:t.limit,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Introduce el texto que quieres que se muestre...",rows:"3","max-rows":"6"},on:{change:function(e){return t.save()}},model:{value:t.mainText,callback:function(e){t.mainText=e},expression:"mainText"}}),t.mainText.length>1900?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.mainText.length)+" /2000")]):t.mainText.length<0?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" No se puede dejar este campo vacio ")]):t._e()],1),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("label",[t._v("Texto emergente")]),i("b-form-textarea",{staticStyle:{"margin-bottom":"15px"},attrs:{state:t.popupText.length<=2e3&&t.popupText.length>0,formatter:t.limit,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Introduce el texto que se mostrara al emergentemente...",rows:"3","max-rows":"6"},on:{change:function(e){return t.save()}},model:{value:t.popupText,callback:function(e){t.popupText=e},expression:"popupText"}}),t.popupText.length>1900?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.popupText.length)+" /2000")]):t.popupText.length<0?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" No se puede dejar este campo vacio ")]):t._e(),!1===t.addPicture&&""===this.picture?i("p",{staticStyle:{color:"darkblue","font-weight":"bold",cursor:"pointer"},on:{click:function(e){t.addPicture=!0}}},[t._v("Añadir imagen al final del texto")]):t._e(),!0===t.addPicture||""!==this.picture?i("div",[i("div",{staticClass:"d-block text-center"},[i("h5",[t._v("Elija la imagen que desea añadir")])]),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("b-form-file",{staticClass:"my-2",attrs:{placeholder:"Selecciona una imagen o arrastrala aquí...","drop-placeholder":"Arrastra aquí la imagen...",accept:"image/*"},on:{change:t.onFileSelected}}),i("b-row",{staticClass:"my-1"},[""!==this.selectedFile&&""===this.picture?i("p",[t._v("Espere a que cargue la imagen")]):t._e(),""!==this.picture?i("b-img",{staticStyle:{"min-height":"200px","max-height":"200px",width:"auto","padding-top":"13px","padding-bottom":"13px"},attrs:{src:this.picture}}):t._e()],1)],1),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-return",variant:"outline-secondary",block:""},on:{click:function(e){return t.cancel()}}},[t._v("Cancelar")]),i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-accept",variant:"primary",block:"",disabled:""===t.picture},on:{click:function(e){return t.uploadPicture()}}},[t._v("Confirmar")])],1)],1):t._e()],1)],1)],1)},oi=[],ri={name:"popupText",props:{mainTextAux:String,popupTextAux:String,index:Number,lastPressed:Number,htmlTextAux:String,pictureAux:String},data:function(){return{mainText:this.mainTextAux,popupText:this.popupTextAux,htmlText:this.htmlTextAux,openPopupTextModal:!1,preview:!1,addPicture:!1,picture:this.pictureAux,selectedFile:""}},watch:{mainTextAux:function(){this.refresh()},popupTextAux:function(){this.refresh()},htmlTextAux:function(){this.refresh()},pictureAux:function(){this.refresh()},index:function(){this.refresh()}},methods:{refresh:function(){this.mainText=this.mainTextAux,this.popupText=this.popupTextAux,this.htmlText=this.htmlTextAux,this.picture=this.pictureAux},onFileSelected:function(){if(""!==this.selectedFile&&this.selectedFile!==event.target.files[0]){var t=f.ref("/".concat(A.state.userNick.toLowerCase(),"/books/").concat(A.state.openBookID,"/popUpTextPictures/").concat(this.index+"_gadget_"+this.selectedFile.name));t.delete(),this.selectedFile=event.target.files[0],this.onUpload()}else this.selectedFile=event.target.files[0],this.onUpload()},onUpload:function(){var t=this,e=f.ref("/".concat(A.state.userNick.toLowerCase(),"/books/").concat(A.state.openBookID,"/popUpTextPictures/").concat(this.index+"_gadget_"+this.selectedFile.name)),i=e.put(this.selectedFile);i.on("state_changed",(function(e){var i=e.bytesTransferred/e.totalBytes*100;t.uploadValue=i}),(function(t){console.log(t.message)}),(function(){t.uploadValue=100,i.snapshot.ref.getDownloadURL().then((function(e){t.picture=e}))}))},uploadPicture:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.htmlText='<img src="'+this.picture+'" style="min-height: 200px; max-height: 200px; width: auto;padding-top: 13px; padding-bottom: 13px;">',this.save();case 2:case"end":return t.stop()}}),null,this)},cancel:function(){this.addPicture=!1,this.htmlText="",this.picture="",this.selectedFile="",this.save()},save:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.$emit("html",this.mainText,this.popupText,this.htmlText,this.picture,this.index);case 1:case"end":return t.stop()}}),null,this)},limit:function(t){return String(t).substring(0,2e3)}}},ci=ri,li=(i("9825"),Object(_["a"])(ci,ai,oi,!1,null,null,null)),ui=li.exports,di=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Edite su hipervínculo")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){t.preview=!t.preview}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.preview,expression:"preview"}]},[i("hr"),i("a",{attrs:{href:t.hyperlinkText,target:"_blank"}},[t._v(t._s(t.mainText))]),i("hr")]),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("label",[t._v("Hipervínculo")]),i("b-form-input",{attrs:{type:"text",state:t.hyperlinkText.length>=3&&t.hyperlinkText.length<=200,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Enlace del hipervínculo"},on:{change:function(e){return t.save()}},model:{value:t.hyperlinkText,callback:function(e){t.hyperlinkText=e},expression:"hyperlinkText"}}),t.mainText.length>=200?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" Superada longitud máxima de 200 caracteres ")]):t.mainText.length<0?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" No se puede dejar este campo vacio ")]):t._e()],1),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("label",[t._v("Texto principal")]),i("b-form-textarea",{attrs:{state:t.mainText.length<=1e3&&t.mainText.length>0,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Introduce el texto que se mostrará...",rows:"3","max-rows":"6",formatter:t.limit},on:{change:function(e){return t.save()}},model:{value:t.mainText,callback:function(e){t.mainText=e},expression:"mainText"}}),t.mainText.length>900?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.mainText.length)+" /1000")]):t.mainText.length<0?i("b-form-invalid-feedback",{attrs:{id:"input-live-feedback"}},[t._v(" No se puede dejar este campo vacio ")]):t._e()],1)],1)],1)},hi=[],mi={name:"hyperlinkText",props:{mainTextAux:String,hyperlinkTextAux:String,index:Number,lastPressed:Number},data:function(){return{mainText:this.mainTextAux,hyperlinkText:this.hyperlinkTextAux,preview:!1}},watch:{mainTextAux:function(){this.refresh()},hyperlinkTextAux:function(){this.refresh()},index:function(){this.refresh()}},methods:{refresh:function(){this.mainText=this.mainTextAux,this.hyperlinkText=this.hyperlinkTextAux},save:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:t='<a href="'+this.hyperlinkText+'" target="_blank">'+this.mainText+"</a>",this.$emit("html",t,this.mainText,this.hyperlinkText,this.index);case 2:case"end":return e.stop()}}),null,this)},limit:function(t){return String(t).substring(0,1e3)}}},pi=mi,fi=(i("c463"),Object(_["a"])(pi,di,hi,!1,null,null,null)),bi=fi.exports,vi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Spoiler")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{title:"Previsualizar gadget",variant:"outline-info"},on:{click:function(e){t.preview=!t.preview}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.preview,expression:"preview"}]},[i("hr"),i("div",{staticClass:"spoiler",domProps:{innerHTML:t._s(t.htmlTextAux)}}),i("hr")]),i("span",{staticClass:"editme",attrs:{id:"spoiler"+t.index,contenteditable:""},domProps:{innerHTML:t._s(t.plainTextAux)},on:{blur:function(e){return t.saveSelection(e)}}})])},xi=[],gi={name:"spoiler",props:{htmlTextAux:String,plainTextAux:String,index:Number},data:function(){return{preview:!1}},methods:{saveSelection:function(t){var e=t.target.innerHTML,i=e,n="<span>"+e+"</span>";this.$emit("html",i,n,this.index)}}},wi=gi,yi=(i("71ee"),Object(_["a"])(wi,vi,xi,!1,null,"5f066002",null)),ki=yi.exports,Si=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Elija la imagen que desea añadir")])]),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("b-form-file",{staticClass:"my-2",attrs:{placeholder:"Selecciona una imagen","drop-placeholder":"Arrastra aquí la imagen...",accept:"image/*"},on:{change:t.onFileSelected}}),i("b-row",{staticClass:"my-1"},[""!==this.selectedFile&&""===this.picture?i("p",[t._v("Espere a que cargue la imagen")]):t._e(),""!==this.picture?i("b-img",{staticStyle:{"min-width":"710px","max-width":"710px",height:"auto","padding-top":"13px","padding-bottom":"13px"},attrs:{src:this.picture}}):t._e()],1)],1)],1)],1)},_i=[],Ci={name:"pictureGadget",props:{index:Number,bookID:String,htmlTextAux:String,pictureAux:String},data:function(){return{selectedFile:"",picture:this.pictureAux}},watch:{picture:function(){this.save()}},methods:{onFileSelected:function(){if(""!==this.selectedFile&&this.selectedFile!==event.target.files[0]){var t=f.ref("/".concat(A.state.userNick.toLowerCase(),"/books/").concat(this.bookID,"/multimedia/").concat(this.index+"_gadget_"+this.selectedFile.name));t.delete(),this.selectedFile=event.target.files[0],this.onUpload()}else this.selectedFile=event.target.files[0],this.onUpload()},onUpload:function(){var t=this,e=f.ref("/".concat(A.state.userNick.toLowerCase(),"/books/").concat(this.bookID,"/multimedia/").concat(this.index+"_gadget_"+this.selectedFile.name)),i=e.put(this.selectedFile);i.on("state_changed",(function(e){var i=e.bytesTransferred/e.totalBytes*100;t.uploadValue=i}),(function(t){console.log(t.message)}),(function(){t.uploadValue=100,i.snapshot.ref.getDownloadURL().then((function(e){t.picture=e}))}))},save:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:t='<img src="'+this.picture+'" style="min-width: 751.7px; max-width: 751.7px; height: auto;padding-top: 13px; padding-bottom: 13px;">',this.$emit("html",t,this.picture,this.index);case 2:case"end":return e.stop()}}),null,this)}}},Ti=Ci,Pi=(i("a244"),i("f283"),Object(_["a"])(Ti,Si,_i,!1,null,"f40629b4",null)),Ni=Pi.exports,Oi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Elija el video que desea añadir")])]),i("b-container",{staticClass:"col",attrs:{fluid:""}},[i("b-form-file",{staticClass:"my-2",attrs:{placeholder:"Selecciona un video","drop-placeholder":"Arrastra aquí el video...",accept:"video/*"},on:{change:t.onFileSelected}}),i("div",{attrs:{id:"optionsCheckbox",label:"Opciones de reproduccion"}},[i("b-form-checkbox",{attrs:{value:"true","unchecked-value":"false"},model:{value:t.autoplay,callback:function(e){t.autoplay=e},expression:"autoplay"}},[t._v(" Autorreproducción ")]),i("b-form-checkbox",{attrs:{value:"true","unchecked-value":"false"},model:{value:t.loop,callback:function(e){t.loop=e},expression:"loop"}},[t._v(" Bucle ")])],1),i("b-row",{staticClass:"my-1"},[""!==this.selectedFile&&""===this.video?i("p",[t._v("Espere a que cargue el video")]):t._e(),""!==this.video?i("iframe",{attrs:{src:this.video}}):t._e()])],1)],1)],1)},Di=[],Ai={name:"videoGadget",props:{index:Number,bookID:String,htmlTextAux:String,videoAux:String,autoplayAux:String,loopAux:String},data:function(){return{selectedFile:"",video:this.videoAux,autoplay:this.autoplayAux,loop:this.loopAux}},watch:{autoplay:function(){this.save()},loop:function(){this.save()},autoplayAux:function(){this.refresh()},loopAux:function(){this.refresh()},videoAux:function(){this.refresh()}},methods:{refresh:function(){this.autoplay=this.autoplayAux,this.loop=this.loopAux,this.video=this.videoAux},onFileSelected:function(){if(""!==this.selectedFile&&this.selectedFile!==event.target.files[0]){var t=f.ref("/".concat(A.state.userNick.toLowerCase(),"/books/").concat(this.bookID,"/multimedia/").concat(this.index+"_gadget_"+this.selectedFile.name));t.delete(),this.selectedFile=event.target.files[0],this.onUpload()}else this.selectedFile=event.target.files[0],this.onUpload()},onUpload:function(){var t=this,e=f.ref("/".concat(A.state.userNick.toLowerCase(),"/books/").concat(this.bookID,"/multimedia/").concat(this.index+"_gadget_"+this.selectedFile.name)),i=e.put(this.selectedFile);i.on("state_changed",(function(e){var i=e.bytesTransferred/e.totalBytes*100;t.uploadValue=i}),(function(t){console.log(t.message)}),(function(){t.uploadValue=100,i.snapshot.ref.getDownloadURL().then((function(e){t.video=e,t.save()}))}))},save:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:t='<video width="460" height="300" style="padding-top: 13px; padding-bottom: 13px;" controls',"true"===this.autoplay&&(t+=" autoplay "),"true"===this.loop&&(t+=" loop "),t=t+'><source src="'+this.video+'">No se puede reproducir el video en este navegador</video>',this.$emit("html",t,this.video,this.autoplay,this.loop,this.index);case 5:case"end":return e.stop()}}),null,this)}}},Li=Ai,Mi=(i("0cd6"),i("d82ff"),Object(_["a"])(Li,Oi,Di,!1,null,"83f3902c",null)),Bi=Mi.exports,Ii=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title",staticStyle:{"margin-top":"10px","margin-left":"10px"}},[t._v("Cambio de sección")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){return t.preparePreview()}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("br"),t.valid?t._e():i("span",{staticStyle:{color:"red"}},[t._v("No hay más secciones a las que saltar. Este gadget no se verá al leer el libro")]),i("b-row",[i("b-col",[i("span",[t._v("Texto (opcional): ")])]),i("b-col",[i("span",[t._v("Sección:")])])],1),i("b-row",[i("b-col",[i("b-form-input",{staticStyle:{"margin-bottom":"6px"},attrs:{size:"sm",formatter:t.formatMaxText,placeholder:"Escribe un mensaje si quieres (max 2000 caracteres)"},on:{blur:function(e){return t.save()}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),t.text.length>1800?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.text.length)+" /2000")]):t._e()],1),i("b-col",[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:t.selectedSectionID,callback:function(e){t.selectedSectionID=e},expression:"selectedSectionID"}})],1)],1),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",centered:""},model:{value:t.showPreview,callback:function(e){t.showPreview=e},expression:"showPreview"}},[i("h5",[t._v("Cambio de seccion")]),i("div",{staticClass:"d-flex justify-content-center"},[i("span",{staticClass:"clickable",domProps:{innerHTML:t._s(t.htmlTextPreview)},on:{click:function(e){return t.changePreview()}}}),i("span",[13!==t.htmlTextPreview.length?i("b-icon",{staticClass:"h4 clickable",staticStyle:{"margin-left":"10px"},attrs:{variant:"info",icon:"box-arrow-right"},on:{click:function(e){return t.changePreview()}}}):i("b-icon",{staticClass:"h4 clickable",attrs:{variant:"info",icon:"box-arrow-right"},on:{click:function(e){return t.changePreview()}}})],1)]),!0===t.clicked?i("p",{staticStyle:{"padding-left":"15px"}},[t._v("Cambio a seccion: "+t._s(t.sectionNamePreview)+" ")]):t._e(),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-ok",variant:"secondary",block:""},on:{click:function(e){t.showPreview=!1}}},[t._v("Ok")])],1)])],1)},zi=[],Ei={name:"changeSection",props:{actualSection:String,auxSectionsData:Array,selectedSection:String,textAux:String,index:Number},data:function(){return{aux:[],text:this.textAux,selectedSectionID:this.selectedSection,valid:!0,sectionNamePreview:"",htmlTextPreview:"",showPreview:!1,clicked:!1}},watch:{auxSectionsData:function(){this.refresh()},actualSection:function(){this.refresh()},selectedSection:function(){this.refresh()},textAux:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){this.aux=[],this.valid=!1,this.selectedSectionID=this.selectedSection,this.text=this.textAux,this.deepClone(),this.checkContent(this.aux);for(var t=!1,e=0;e<this.aux.length&&!t;++e)this.aux[e].value===this.actualSection&&(0===e&&this.aux[e].value===this.selectedSectionID&&this.aux.length>1&&(this.selectedSectionID=this.aux[1].value),this.aux.splice(e,1),t=!0);this.aux.length>0&&(this.valid=!0),this.valid||(this.selectedSectionID=""),this.save()},deepClone:function(){for(var t=0;t<this.auxSectionsData.length;++t)this.aux.push(this.auxSectionsData[t])},checkContent:function(t){if((""===this.selectedSectionID||void 0===this.selectedSectionID)&&this.auxSectionsData.length>1)this.selectedSectionID=this.auxSectionsData[0].value;else{for(var e=!1,i=0;i<t.length&&!e;++i)this.selectedSectionID===t[i].value&&(e=!0);!e&&this.auxSectionsData.length>1?this.selectedSectionID=this.auxSectionsData[0].value:e||(this.selectedSectionID="")}},save:function(){var t=this.text,e="<span>"+t+"</span>";void 0===this.selectedSectionID&&(this.selectedSectionID=""),this.$emit("section",e,t,this.selectedSectionID,this.index)},formatMaxText:function(t){return String(t).substring(0,2e3)},preparePreview:function(){this.htmlTextPreview="<span>"+this.text+"</span>",this.sectionNamePreview="",this.showPreview=!0,this.clicked=!1},changePreview:function(){var t=this;g.doc(this.selectedSectionID).get().then((function(e){e.exists?t.sectionNamePreview=e.data().name:t.sectionNamePreview="No has seleccionado ninguna seccion"})),this.clicked=!0}}},Ri=Ei,Wi=(i("4e1a"),Object(_["a"])(Ri,Ii,zi,!1,null,"64043180",null)),$i=Wi.exports,ji=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Repetición de sección")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){return t.preparePreview()}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"3"}},[i("span",[t._v("Texto (opcional): ")])]),i("b-col",[i("b-form-input",{attrs:{size:"sm",formatter:t.limit,placeholder:"Escribe un mensaje si quieres (max 2000 caracteres)"},on:{blur:function(e){return t.save()}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1)],1),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",centered:""},model:{value:t.showPreview,callback:function(e){t.showPreview=e},expression:"showPreview"}},[i("h5",[t._v("Repetir seccion")]),i("div",{staticClass:"d-flex justify-content-center"},[i("span",{staticClass:"clickable",domProps:{innerHTML:t._s(t.htmlTextPreview)},on:{click:function(e){t.clicked=!0}}}),i("span",[13!==t.htmlTextPreview.length?i("b-icon",{staticClass:"h4 clickable",staticStyle:{"margin-left":"10px"},attrs:{variant:"info",icon:"arrow-repeat"},on:{click:function(e){t.clicked=!0}}}):i("b-icon",{staticClass:"h4 clickable",attrs:{variant:"info",icon:"arrow-repeat"},on:{click:function(e){t.clicked=!0}}})],1)]),!0===t.clicked?i("p",{staticStyle:{"padding-left":"15px"}},[t._v("recarga de seccion: "+t._s(t.sectionName)+" ")]):t._e(),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-ok",variant:"secondary",block:""},on:{click:function(e){t.showPreview=!1}}},[t._v("Ok")])],1)])],1)},qi=[],Ui={name:"changeSection",props:{actualSection:String,sectionName:String,textAux:String,index:Number},data:function(){return{aux:[],text:this.textAux,showPreview:!1,htmlTextPreview:"",clicked:!1}},watch:{actualSection:function(){this.refresh()},textAux:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){this.text=this.textAux},save:function(){var t=this.text.substring(0,2e3),e="<span>"+t+"</span>";this.$emit("html",t,e,this.index)},preparePreview:function(){this.showPreview=!0,this.clicked=!1,this.htmlTextPreview="<span>"+this.text+"</span>"},limit:function(t){return String(t).substring(0,2e3)}}},Hi=Ui,Vi=(i("655c"),Object(_["a"])(Hi,ji,qi,!1,null,"62967ea6",null)),Fi=Vi.exports,Gi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Toma de decisiones")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){return t.preparePreview()}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("br"),t.valid?t._e():i("span",{staticStyle:{color:"red"}},[t._v("No hay más secciones a las que saltar. Este gadget no se verá al leer el libro")]),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Nº de opciones: "+t._s(t.numberOfOptions))])]),i("b-col",[t.aux.length>0?i("b-form-input",{attrs:{type:"range",min:"2",max:"10"},on:{change:function(e){t.modify(),t.save()}},model:{value:t.numberOfOptions,callback:function(e){t.numberOfOptions=e},expression:"numberOfOptions"}}):i("b-form-input",{attrs:{disabled:"",type:"range",min:"2",max:"10"},on:{change:function(e){t.modify(),t.save()}},model:{value:t.numberOfOptions,callback:function(e){t.numberOfOptions=e},expression:"numberOfOptions"}})],1)],1),i("hr"),i("b-row",[i("b-col",{attrs:{cols:"3"}}),i("b-col",[i("span",[t._v("Texto (opcional):")])]),i("b-col",[i("span",[t._v("Sección:")])])],1),t._l(t.decisions,(function(e,n){return i("div",{key:n},[i("b-row",[i("b-col",{attrs:{cols:"3"}},[i("span",[t._v("Decisión "+t._s(n)+":")])]),i("b-col",[i("b-form-input",{staticStyle:{"margin-bottom":"6px"},attrs:{size:"sm",formatter:t.formatMaxText,placeholder:"Escribe un mensaje si quieres (max 2000 caracteres)"},on:{blur:function(e){return t.save()}},model:{value:e.plainText,callback:function(i){t.$set(e,"plainText",i)},expression:"element.plainText"}}),e.plainText.length>1800?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(e.plainText.length)+" /2000")]):t._e()],1),i("b-col",[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:e.action,callback:function(i){t.$set(e,"action",i)},expression:"element.action"}})],1)],1)],1)})),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",centered:""},model:{value:t.showPreview,callback:function(e){t.showPreview=e},expression:"showPreview"}},[i("h5",[t._v("Toma de decisiones")]),i("div",{staticStyle:{"margin-bottom":"15px"}},[i("b-form-radio-group",{attrs:{options:t.optionsPreview,stacked:""},on:{change:t.changePreview},model:{value:t.selectedPreview,callback:function(e){t.selectedPreview=e},expression:"selectedPreview"}})],1),!0===t.clicked?i("p",{staticStyle:{"padding-left":"15px"}},[t._v("Cambio a seccion: "+t._s(t.sectionNamePreview)+" ")]):t._e(),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-ok",variant:"secondary",block:""},on:{click:function(e){t.showPreview=!1}}},[t._v("Ok")])],1)])],2)},Ki=[],Ji=(i("e25e"),{name:"decisionMaking",props:{actualSection:String,auxSectionsData:Array,auxDecisions:Array,auxNumberOfOptions:Number,index:Number},data:function(){return{aux:[],decisions:[],numberOfOptions:2,valid:!0,showPreview:!1,selectedPreview:"",sectionNamePreview:"",clicked:!1,optionsPreview:[]}},watch:{auxSectionsData:function(){this.refresh()},actualSection:function(){this.refresh()},auxNumberOfOptions:function(){this.refresh()},auxDecisions:function(){this.refresh()},index:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){this.aux=[],this.decisions=[],this.numberOfOptions=this.auxNumberOfOptions,this.valid=!1,this.deepClone(),this.checkContent(),this.hardRefresh()},hardRefresh:function(){for(var t=!1,e=-1,i=0;i<this.decisions.length;++i){for(var n=!1,s=0;s<this.aux.length&&!n;++s)this.aux[s].value===this.actualSection&&(0===s&&this.aux[s].value===this.decisions[i].action&&this.aux.length>1&&(this.decisions[i].action=this.aux[1].value),t=!0,e=s,n=!0);this.aux.length>1&&(this.valid=!0)}t&&this.aux.splice(e,1)},modify:function(){if(this.numberOfOptions>this.decisions.length)for(var t=this.decisions.length;t<this.numberOfOptions;++t)this.decisions.push({plainText:"",htmlText:"<span></span>",choice:"Section",action:this.aux[0].value});else if(this.numberOfOptions<this.decisions.length)for(var e=this.decisions.length;e>this.numberOfOptions;--e)this.decisions.pop();this.numberOfOptions=this.decisions.length,this.hardRefresh()},deepClone:function(){for(var t=0;t<this.auxSectionsData.length;++t)this.aux.push(this.auxSectionsData[t]);for(var e=0;e<this.auxDecisions.length;++e)this.decisions.push(this.auxDecisions[e])},checkContent:function(){for(var t=0;t<this.decisions.length;++t)if("Section"===this.decisions[t].choice)if((""===this.decisions[t].action||void 0===this.decisions[t].action)&&this.auxSectionsData.length>1)this.decisions[t].action=this.auxSectionsData[0].value;else{for(var e=!1,i=0;i<this.aux.length&&!e;++i)this.decisions[t].action===this.aux[i].value&&(e=!0);!e&&this.auxSectionsData.length>1?this.decisions[t].action=this.auxSectionsData[0].value:e||(this.decisions[t].action="")}},save:function(){for(var t=0;t<this.decisions.length;++t){var e=this.decisions[t].plainText,i="<span>"+e+"</span>";this.decisions[t].htmlText=i,void 0===this.decisions[t].action&&(this.decisions[t].action="")}this.numberOfOptions=parseInt(this.numberOfOptions,10),this.$emit("section",this.decisions,this.numberOfOptions,this.index)},formatMaxText:function(t){return String(t).substring(0,2e3)},preparePreview:function(){this.showPreview=!0,this.selectedPreview="",this.sectionNamePreview="",this.clicked=!1,this.optionsPreview=[];for(var t=0;t<this.decisions.length;++t)this.optionsPreview.push({value:this.decisions[t].action,html:this.decisions[t].htmlText})},changePreview:function(t){var e=this;g.doc(t).get().then((function(t){t.exists?e.sectionNamePreview=t.data().name:e.sectionNamePreview="No has seleccionado ninguna seccion"})),this.clicked=!0}}}),Xi=Ji,Zi=(i("8dab"),Object(_["a"])(Xi,Gi,Ki,!1,null,"5826295c",null)),Qi=Zi.exports,Yi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Adivinanza")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){t.show=!0,t.numberOfTriesPreview=parseInt(t.numberOfTries,10)}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),t.valid?t._e():i("span",{staticStyle:{color:"red"}},[t._v("No hay más secciones a las que saltar. Este gadget no se verá al leer el libro")]),i("br"),i("b-row",[i("b-col",{attrs:{cols:"5"}},[i("span",[t._v("Cambio de sección al acertar: ")])]),i("b-col",[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:t.rightSectionID,callback:function(e){t.rightSectionID=e},expression:"rightSectionID"}})],1)],1),i("b-row",{staticClass:"right",staticStyle:{"padding-left":"10px"}},[i("b-col",{attrs:{cols:"5"}},[t.changeSectionWhenWrong?i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){return t.noWrongSection()}}},[t._v("Continuar lectura al fallar")]):i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){t.changeSectionWhenWrong=!0,t.save()}}},[t._v("Cambiar de sección al fallar")])],1),t.changeSectionWhenWrong?i("b-col",{staticStyle:{"padding-top":"5px"}},[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:t.wrongSectionID,callback:function(e){t.wrongSectionID=e},expression:"wrongSectionID"}})],1):t._e()],1),i("hr"),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Nº de intentos: "+t._s(t.numberOfTries))])]),i("b-col",[t.aux.length>0?i("b-form-input",{attrs:{type:"range",min:"1",max:"10"},on:{change:function(e){return t.save()}},model:{value:t.numberOfTries,callback:function(e){t.numberOfTries=e},expression:"numberOfTries"}}):i("b-form-input",{attrs:{disabled:"",type:"range",min:"1",max:"10"},on:{change:function(e){return t.save()}},model:{value:t.numberOfTries,callback:function(e){t.numberOfTries=e},expression:"numberOfTries"}})],1)],1),i("hr"),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"2"}},[i("span",[t._v("Pregunta: ")])]),i("b-col",[i("b-form-textarea",{staticStyle:{"margin-bottom":"10px"},attrs:{rows:"3",formatter:t.formatMaxRiddle,placeholder:"Escribe el texto de la adivinanza (max 2000 caracteres)"},on:{blur:function(e){return t.save()}},model:{value:t.riddleText,callback:function(e){t.riddleText=e},expression:"riddleText"}}),t.riddleText.length>1800?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.riddleText.length)+" /2000")]):t._e()],1)],1),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"3"}},[i("span",[t._v("Respuesta: ")])]),i("b-col",[i("b-form-input",{staticStyle:{"margin-bottom":"10px"},attrs:{trim:"",formatter:t.formatAnswer,placeholder:"Escribe la respuesta a tu adivinanza (max 30 caracteres)"},on:{blur:function(e){return t.save()}},model:{value:t.answerText,callback:function(e){t.answerText=e},expression:"answerText"}}),t.answerText.length>24?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.answerText.length)+" /30")]):t._e()],1)],1)],1),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",centered:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("div",{staticClass:"d-block text-left"},[i("h5",{staticStyle:{"margin-bottom":"10px"}},[t._v("Adivinanza")])]),i("div",{staticClass:"d-block text-center"},[i("p",[t._v(" "+t._s(t.riddleText))]),i("div",{staticClass:"d-flex"},[i("b-form-input",{staticStyle:{"margin-top":"5px"},attrs:{trim:"",formatter:t.formatAnswer,placeholder:"Respuesta"},model:{value:t.tryText,callback:function(e){t.tryText=e},expression:"tryText"}}),t.tryText.length>24?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.tryText.length)+" /30")]):t._e(),i("b-button",{staticStyle:{width:"150px","font-size":"16px"},attrs:{disabled:0===t.numberOfTriesPreview,variant:"primary",block:""},on:{click:function(e){return t.tryAnswer()}}},[t._v("Probar")])],1),i("p",[t._v("Te quedan "+t._s(t.numberOfTriesPreview)+" intentos")]),!0===t.correctPreview?i("p",{staticStyle:{"font-weight":"bold"}},[t._v("¡Enhorabuena! ¡has acertado!")]):t._e(),!1===t.correctPreview?i("p",{staticStyle:{"font-weight":"bold"}},[t._v("Has fallado :(")]):t._e()]),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-ok",variant:"secondary",block:""},on:{click:function(e){t.show=!1,t.correctPreview=null}}},[t._v("Ok")])],1)])],1)},tn=[],en={name:"riddle",props:{actualSection:String,auxSectionsData:Array,riddleTextAux:String,answerTextAux:String,rightSectionAux:String,wrongSectionAux:String,numberOfTriesAux:String,changeSectionWhenWrongAux:Boolean,index:Number},data:function(){return{aux:[],riddleText:this.riddleTextAux,answerText:this.answerTextAux,tryText:"",rightSectionID:this.rightSectionAux,wrongSectionID:this.wrongSectionAux,numberOfTries:this.numberOfTriesAux,valid:!0,show:!1,numberOfTriesPreview:0,changeSectionWhenWrong:this.changeSectionWhenWrongAux,correctPreview:null}},watch:{auxSectionsData:function(){this.refresh()},actualSection:function(){this.refresh()},rightSectionAux:function(){this.refresh()},wrongSectionAux:function(){this.refresh()},riddleTextAux:function(){this.refresh()},answerTextAux:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){this.aux=[],this.valid=!1,this.rightSectionID=this.rightSectionAux,this.wrongSectionID=this.wrongSectionAux,this.riddleText=this.riddleTextAux,this.answerText=this.answerTextAux,this.deepClone(),this.checkContent(this.aux);for(var t=!1,e=0;e<this.aux.length&&!t;++e)this.aux[e].value===this.actualSection&&(0===e&&this.aux[e].value===this.rightSectionID&&this.aux.length>1&&(this.rightSectionID=this.aux[1].value),this.aux.splice(e,1),t=!0);this.aux.length>0&&(this.valid=!0),this.valid||(this.rightSectionID=""),this.save()},deepClone:function(){for(var t=0;t<this.auxSectionsData.length;++t)this.aux.push(this.auxSectionsData[t])},checkContent:function(t){if((""===this.rightSectionID||void 0===this.rightSectionID)&&this.auxSectionsData.length>1)this.rightSectionID=this.auxSectionsData[0].value;else{for(var e=!1,i=0;i<t.length&&!e;++i)this.rightSectionID===t[i].value&&(e=!0);!e&&this.auxSectionsData.length>1?this.rightSectionID=this.auxSectionsData[0].value:e||(this.rightSectionID="")}},save:function(){void 0===this.wrongSectionID&&(this.wrongSectionID=""),void 0===this.rightSectionID&&(this.rightSectionID=""),this.$emit("section",this.changeSectionWhenWrong,this.riddleText,this.answerText,this.rightSectionID,this.wrongSectionID,this.numberOfTries,this.index)},tryAnswer:function(){this.numberOfTriesPreview>0&&(this.numberOfTriesPreview--,this.tryText===this.answerText?this.correctPreview=!0:this.correctPreview=!1)},noWrongSection:function(){this.changeSectionWhenWrong=!1,this.wrongSectionID="",this.save()},formatMaxRiddle:function(t){return String(t).substring(0,2e3)},formatAnswer:function(t){var e=String(t).substring(0,30);return e.toLowerCase()}}},nn=en,sn=(i("850d"),i("7d9c"),Object(_["a"])(nn,Yi,tn,!1,null,"436a867a",null)),an=sn.exports,on=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Completar la secuencia")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){return t.preparePreview()}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),t.valid?t._e():i("span",{staticStyle:{color:"red"}},[t._v("No hay más secciones a las que saltar. Este gadget solo mostrará la secuencia en la lectura")]),i("br"),i("b-row",{staticClass:"right"},[i("b-col",{attrs:{cols:"5"}},[i("span",[t._v("Cambio de sección al acertar: ")])]),i("b-col",[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:t.rightSection,callback:function(e){t.rightSection=e},expression:"rightSection"}})],1)],1),i("b-row",{staticClass:"right",staticStyle:{"padding-left":"10px"}},[t.changeSectionWhenWrong?i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){t.wrong(),t.save()}}},[t._v("Continuar lectura al fallar")]):i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){t.wrong(),t.save()}}},[t._v("Cambiar de sección al fallar")]),t.changeSectionWhenWrong?i("b-col",{staticStyle:{"padding-top":"5px"}},[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:t.wrongSection,callback:function(e){t.wrongSection=e},expression:"wrongSection"}})],1):t._e()],1),i("hr"),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Nº de intentos: "+t._s(t.numberOfTries))])]),i("b-col",[t.aux.length>0?i("b-form-input",{attrs:{type:"range",min:"1",max:"10"},on:{change:function(e){return t.save()}},model:{value:t.numberOfTries,callback:function(e){t.numberOfTries=e},expression:"numberOfTries"}}):i("b-form-input",{attrs:{disabled:"",type:"range",min:"1",max:"10"},on:{change:function(e){return t.save()}},model:{value:t.numberOfTries,callback:function(e){t.numberOfTries=e},expression:"numberOfTries"}})],1)],1),i("hr"),i("div",[i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"6"}},[i("span",[t._v("Nº de campos dados: "+t._s(t.sequence.length))])]),i("b-col",[i("b-form-input",{attrs:{type:"range",min:"1",max:"8"},on:{change:function(e){t.modifySequence(),t.save()}},model:{value:t.numberOfSequence,callback:function(e){t.numberOfSequence=e},expression:"numberOfSequence"}})],1)],1),t._l(t.sequence,(function(e,n){return i("b-row",{key:n,staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"3"}},[i("span",[t._v("Elemento "+t._s(n+1)+": ")])]),i("b-col",[i("b-form-input",{attrs:{size:"sm",formatter:t.limit,placeholder:"Texto dado máximo de 20 caracteres"},on:{blur:function(e){return t.save()}},model:{value:e.text,callback:function(i){t.$set(e,"text",i)},expression:"element.text"}})],1)],1)}))],2),i("hr"),i("div",[i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"6"}},[i("span",[t._v("Nº de campos a solucionar: "+t._s(t.solution.length))])]),i("b-col",[i("b-form-input",{attrs:{type:"range",min:"1",max:"5"},on:{change:function(e){t.modifySolution(),t.save()}},model:{value:t.numberOfSolution,callback:function(e){t.numberOfSolution=e},expression:"numberOfSolution"}})],1)],1),t._l(t.solution,(function(e,n){return i("b-row",{key:n,staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"3"}},[i("span",[t._v("Solución "+t._s(n+1)+": ")])]),i("b-col",[i("b-form-input",{attrs:{size:"sm",trim:"",formatter:t.limit,placeholder:"Solución de máximo de 20 caracteres"},on:{blur:function(e){return t.save()}},model:{value:e.text,callback:function(i){t.$set(e,"text",i)},expression:"element.text"}})],1)],1)}))],2),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",centered:""},model:{value:t.showPreview,callback:function(e){t.showPreview=e},expression:"showPreview"}},[i("div",{staticStyle:{margin:"10px"}},[i("h5",[t._v("Completa la secuencia: ")]),i("div",{staticClass:"d-block text-center"},[i("div",[i("div",{staticClass:"row"},t._l(t.sequence,(function(e,n){return i("span",{key:n,staticStyle:{"margin-right":"10px","margin-left":"10px","font-size":"22px"}},[t._v(" "+t._s(e.text)+" ")])})),0),i("div",{staticClass:"row"},[t._l(t.solution,(function(e,n){return i("b-form-input",{key:n,staticStyle:{"margin-top":"5px","margin-right":"5px","margin-left":"5px",width:"115px"},attrs:{trim:"",formatter:t.limit,placeholder:"Respuesta"},model:{value:t.answersPreview[n],callback:function(e){t.$set(t.answersPreview,n,e)},expression:"answersPreview[answerIndex]"}})})),i("b-button",{staticStyle:{width:"100px","font-size":"16px"},attrs:{disabled:0===t.numberOfTriesPreview||t.answersPreview.length!==t.solution.length,variant:"primary",block:""},on:{click:function(e){return t.tryPreview()}}},[t._v("Probar")])],2)]),!1===t.correctPreview?i("span",{staticStyle:{color:"red"}},[t._v(" ¡Has fallado! ")]):!0===t.correctPreview?i("span",{staticStyle:{color:"green"}},[t._v(" ¡Has acertado! ")]):t._e(),i("span",[t._v(" Te quedan "+t._s(t.numberOfTriesPreview)+" intentos")]),i("br")])]),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-ok",variant:"secondary",block:""},on:{click:function(e){t.showPreview=!1,t.correctPreview=null}}},[t._v("Ok")])],1)])],1)},rn=[],cn={name:"sequence",props:{actualSection:String,auxSectionsData:Array,auxSequence:Array,auxSolution:Array,auxChangeSectionWhenWrong:Boolean,auxWrongSection:String,auxRightSection:String,auxNumberOfTries:Number,index:Number},data:function(){return{aux:[],sequence:[],numberOfSequence:1,solution:[],numberOfSolution:1,changeSectionWhenWrong:!1,wrongSection:"",rightSection:"",numberOfTries:1,valid:!1,answersPreview:[],numberOfTriesPreview:0,correctPreview:null,showPreview:!1}},watch:{auxSectionsData:function(){this.refresh()},actualSection:function(){this.refresh()},auxSequence:function(){this.refresh()},auxSolution:function(){this.refresh()},auxChangeSectionWhenWrong:function(){this.refresh()},auxWrongSection:function(){this.refresh()},auxRightSection:function(){this.refresh()},auxNumberOfTries:function(){this.refresh()},index:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){this.aux=[],this.sequence=[],this.solution=[],this.changeSectionWhenWrong=this.auxChangeSectionWhenWrong,this.numberOfTries=this.auxNumberOfTries,this.wrongSection=this.auxWrongSection,this.rightSection=this.auxRightSection,this.valid=!1,this.deepClone(),this.numberOfSequence=this.sequence.length,this.numberOfSolution=this.solution.length,this.checkContent(),this.hardRefresh()},hardRefresh:function(){for(var t=!1,e=-1,i=!1,n=0;n<this.aux.length&&!i;++n)this.aux[n].value===this.actualSection&&(0===n&&this.aux[n].value===this.wrongSection&&this.aux.length>1&&(this.wrongSection=this.aux[1].value),0===n&&this.aux[n].value===this.rightSection&&this.aux.length>1&&(this.rightSection=this.aux[1].value),t=!0,e=n,i=!0);this.aux.length>1&&(this.valid=!0),t&&this.aux.splice(e,1)},modifySequence:function(){if(this.numberOfSequence=parseInt(this.numberOfSequence,10),this.numberOfSequence>this.sequence.length)for(var t=this.sequence.length;t<this.numberOfSequence;++t)this.sequence.push({text:""});else if(this.numberOfSequence<this.sequence.length)for(var e=this.sequence.length;e>this.numberOfSequence;--e)this.sequence.pop();this.numberOfSequence=this.sequence.length,this.hardRefresh()},modifySolution:function(){if(this.numberOfSolution=parseInt(this.numberOfSolution,10),this.numberOfSolution>this.solution.length)for(var t=this.solution.length;t<this.numberOfSolution;++t)this.solution.push({text:""});else if(this.numberOfSolution<this.solution.length)for(var e=this.solution.length;e>this.numberOfSolution;--e)this.solution.pop();this.numberOfSolution=this.solution.length,this.hardRefresh()},deepClone:function(){for(var t=0;t<this.auxSectionsData.length;++t)this.aux.push(this.auxSectionsData[t]);for(var e=0;e<this.auxSequence.length;++e)this.sequence.push(this.auxSequence[e]);for(var i=0;i<this.auxSolution.length;++i)this.solution.push(this.auxSolution[i])},checkContent:function(){if((""===this.wrongSection||void 0===this.wrongSection)&&this.auxSectionsData.length>1)this.wrongSection=this.auxSectionsData[0].value;else{for(var t=!1,e=0;e<this.aux.length&&!t;++e)this.wrongSection===this.aux[e].value&&(t=!0);!t&&this.auxSectionsData.length>1?this.wrongSection=this.auxSectionsData[0].value:t||(this.wrongSection="")}if((""===this.rightSection||void 0===this.rightSection)&&this.auxSectionsData.length>1)this.rightSection=this.auxSectionsData[0].value;else{for(var i=!1,n=0;n<this.aux.length&&!i;++n)this.rightSection===this.aux[n].value&&(i=!0);!i&&this.auxSectionsData.length>1?this.rightSection=this.auxSectionsData[0].value:i||(this.rightSection="")}},limit:function(t){return String(t).substring(0,20)},wrong:function(){this.changeSectionWhenWrong=!this.changeSectionWhenWrong},save:function(){this.numberOfTries=parseInt(this.numberOfTries,10),this.$emit("section",this.sequence,this.solution,this.changeSectionWhenWrong,this.wrongSection,this.rightSection,this.numberOfTries,this.index)},preparePreview:function(){this.answersPreview=[],this.numberOfTriesPreview=this.numberOfTries,this.correctPreview=null,this.showPreview=!0},tryPreview:function(){if(this.numberOfTriesPreview>0){this.numberOfTriesPreview--;for(var t=!0,e=0;e<this.solution.length;++e)this.answersPreview[e]!==this.solution[e].text&&(t=!1);!0===t?this.correctPreview=!0:(this.correctPreview=!1,this.answersPreview=[])}}}},ln=cn,un=(i("0681"),Object(_["a"])(ln,on,rn,!1,null,"6cd37d8f",null)),dn=un.exports,hn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Número aleatorio")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){return t.preparePreview()}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("br"),t.valid?t._e():i("span",{staticStyle:{color:"red"}},[t._v("No hay más secciones a las que saltar. Este gadget solo calculará el número aleatorio en la lectura")]),i("b-col",[i("b-row",[i("b-col",[i("span",[t._v("Límite inferior:")])]),i("b-col",[i("span",[t._v("Límite superior:")])])],1)],1),i("b-col",[i("b-row",[i("b-col",[i("b-form-input",{attrs:{type:"number",placeholder:"máximo 4 números"},on:{change:function(e){t.modifyLimits(),t.modifyChangeNumber(),t.save()}},model:{value:t.lowerLimit,callback:function(e){t.lowerLimit=e},expression:"lowerLimit"}})],1),i("b-col",[i("b-form-input",{attrs:{type:"number",placeholder:"máximo 4 números"},on:{change:function(e){t.modifyLimits(),t.modifyChangeNumber(),t.save()}},model:{value:t.upperLimit,callback:function(e){t.upperLimit=e},expression:"upperLimit"}})],1)],1)],1),i("hr"),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Nº de condiciones: "+t._s(t.numberOfConditions))])]),i("b-col",[t.aux.length>0?i("b-form-input",{attrs:{type:"range",min:"0",max:"4"},on:{change:function(e){t.modify(),t.save()}},model:{value:t.numberOfConditions,callback:function(e){t.numberOfConditions=e},expression:"numberOfConditions"}}):i("b-form-input",{attrs:{disabled:"",type:"range",min:"0",max:"4"},on:{change:function(e){t.modify(),t.save()}},model:{value:t.numberOfConditions,callback:function(e){t.numberOfConditions=e},expression:"numberOfConditions"}})],1)],1),i("b-row",[i("b-col",[i("span",[t._v("Condición")])]),i("b-col",[i("span",[t._v("Valor")])]),i("b-col",[i("span",[t._v("Sección")])])],1),t._l(t.conditions,(function(e,n){return i("b-row",{key:n,staticStyle:{"padding-bottom":"10px"}},[i("b-col",[i("b-form-select",{attrs:{options:t.options,size:"sm"},model:{value:e.condition,callback:function(i){t.$set(e,"condition",i)},expression:"element.condition"}})],1),i("b-col",[i("b-form-input",{attrs:{type:"number",size:"sm"},on:{change:function(e){t.modifyChangeNumber(),t.save()}},model:{value:e.number,callback:function(i){t.$set(e,"number",i)},expression:"element.number"}})],1),i("b-col",[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:e.section,callback:function(i){t.$set(e,"section",i)},expression:"element.section"}})],1)],1)})),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",centered:""},model:{value:t.showPreview,callback:function(e){t.showPreview=e},expression:"showPreview"}},[i("div",{staticStyle:{"margin-bottom":"15px"}},[i("h5",[t._v("Numero aleatorio")]),t.pressedPreview?i("span",[t._v("El número generado es "+t._s(this.numberPreview))]):i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info"},on:{click:function(e){return t.generateRandomPreview()}}},[i("b-icon",{attrs:{icon:"question-diamond"}})],1)],1),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-ok",variant:"secondary",block:""},on:{click:function(e){t.showPreview=!1}}},[t._v("Ok")])],1)])],2)},mn=[],pn={name:"randomNumber",props:{actualSection:String,auxSectionsData:Array,auxConditions:Array,auxLowerLimit:Number,auxUpperLimit:Number,auxNumberOfConditions:Number,index:Number},data:function(){return{aux:[],conditions:[],options:[{value:">",text:"Mayor"},{value:">=",text:"Mayor o igual"},{value:"<",text:"Menor"},{value:"<=",text:"Menor o igual"},{value:"==",text:"igual"}],numberOfConditions:0,lowerLimit:0,upperLimit:0,valid:!0,numberPreview:0,pressedPreview:!1,showPreview:!1}},watch:{auxSectionsData:function(){this.refresh()},actualSection:function(){this.refresh()},auxConditions:function(){this.refresh()},auxLowerLimit:function(){this.refresh()},auxUpperLimit:function(){this.refresh()},index:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){this.aux=[],this.conditions=[],this.numberOfConditions=this.auxNumberOfConditions,this.lowerLimit=this.auxLowerLimit,this.lowerLimit=parseInt(this.lowerLimit,10),this.upperLimit=this.auxUpperLimit,this.upperLimit=parseInt(this.upperLimit,10),this.valid=!1,this.deepClone(),this.checkContent(),this.hardRefresh()},hardRefresh:function(){var t=!1,e=-1;0===this.conditions.length&&1===this.auxSectionsData.length&&(this.aux=[]);for(var i=0;i<this.conditions.length;++i)for(var n=!1,s=0;s<this.aux.length&&!n;++s)this.aux[s].value===this.actualSection&&(0===s&&this.aux[s].value===this.conditions[i].section&&this.aux.length>1&&(this.conditions[i].section=this.aux[1].value),t=!0,e=s,n=!0);this.aux.length>1&&(this.valid=!0),t&&this.aux.splice(e,1)},modifyLimits:function(){if(this.lowerLimit=parseInt(this.lowerLimit,10),this.upperLimit=parseInt(this.upperLimit,10),isNaN(this.lowerLimit)?this.lowerLimit=0:isNaN(this.upperLimit)&&(this.upperLimit=0),this.lowerLimit<-9999?this.lowerLimit=-9999:this.lowerLimit>9999&&(this.lowerLimit=9999),this.upperLimit<-9999?this.upperLimit=-9999:this.upperLimit>9999&&(this.upperLimit=9999),this.upperLimit<this.lowerLimit){var t=this.lowerLimit;this.lowerLimit=this.upperLimit,this.upperLimit=t}},modifyChangeNumber:function(){for(var t=0;t<this.conditions.length;++t)this.conditions[t].number=parseInt(this.conditions[t].number,10),isNaN(this.conditions[t].number)?this.conditions[t].number=this.lowerLimit:this.conditions[t].number<this.lowerLimit?this.conditions[t].number=this.lowerLimit:this.conditions[t].number>this.upperLimit&&(this.conditions[t].number=this.upperLimit)},modify:function(){if(this.numberOfConditions=parseInt(this.numberOfConditions,10),this.numberOfConditions>this.conditions.length)for(var t=this.conditions.length;t<this.numberOfConditions;++t)this.conditions.push({condition:">",number:this.lowerLimit,section:this.aux[0].value});else if(this.numberOfConditions<this.conditions.length)for(var e=this.conditions.length;e>this.numberOfConditions;--e)this.conditions.pop();this.numberOfConditions=this.conditions.length,this.hardRefresh()},deepClone:function(){for(var t=0;t<this.auxSectionsData.length;++t)this.aux.push(this.auxSectionsData[t]);for(var e=0;e<this.auxConditions.length;++e)this.conditions.push(this.auxConditions[e])},checkContent:function(){for(var t=0;t<this.conditions.length;++t)if((""===this.conditions[t].section||void 0===this.conditions[t].section)&&this.auxSectionsData.length>1)this.conditions[t].section=this.auxSectionsData[0].value;else{for(var e=!1,i=0;i<this.aux.length&&!e;++i)this.conditions[t].section===this.aux[i].value&&(e=!0);!e&&this.auxSectionsData.length>1?this.conditions[t].section=this.auxSectionsData[0].value:e||(this.conditions[t].section="")}},save:function(){this.lowerLimit=parseInt(this.lowerLimit,10),this.upperLimit=parseInt(this.upperLimit,10),this.numberOfConditions=parseInt(this.numberOfConditions,10),this.$emit("random",this.conditions,this.numberOfConditions,this.lowerLimit,this.upperLimit,this.index)},preparePreview:function(){this.numberPreview=0,this.pressedPreview=!1,this.showPreview=!0},generateRandomPreview:function(){this.numberPreview=Math.floor(Math.random()*(parseInt(this.upperLimit,10)-parseInt(this.lowerLimit,10)+1)+parseInt(this.lowerLimit,10)),this.numberPreview=parseInt(this.numberPreview,10),this.pressedPreview=!0}}},fn=pn,bn=(i("c252"),Object(_["a"])(fn,hn,mn,!1,null,"d345766e",null)),vn=bn.exports,xn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Tarjetas de memoria")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){t.show=!0,t.shufflePreview()}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),i("br"),t.valid?t._e():i("span",{staticStyle:{color:"red"}},[t._v("No hay más secciones a las que saltar. Este gadget no llevará a ninguna sección al resolver el puzzle")]),i("b-row",[i("b-col",{attrs:{cols:"5"}},[i("span",[t._v("Cambio de sección al acertar: ")])]),i("b-col",[i("b-form-select",{attrs:{size:"sm",options:t.sections},on:{change:function(e){return t.save()}},model:{value:t.sectionSolved,callback:function(e){t.sectionSolved=e},expression:"sectionSolved"}})],1)],1),i("b-row",{staticClass:"right",staticStyle:{"padding-left":"10px"}},[i("b-col",{attrs:{cols:"5"}},[t.changeSectionWhenWrong?i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){return t.noWrongSection()}}},[t._v("Continuar lectura al fallar")]):i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){t.changeSectionWhenWrong=!0,t.save()}}},[t._v("Cambiar de sección al fallar")])],1),t.changeSectionWhenWrong?i("b-col",{staticStyle:{"padding-top":"5px"}},[i("b-form-select",{attrs:{size:"sm",options:t.sections},on:{change:function(e){return t.save()}},model:{value:t.sectionNoMoreMoves,callback:function(e){t.sectionNoMoreMoves=e},expression:"sectionNoMoreMoves"}})],1):t._e()],1),i("hr"),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Nº de parejas: "+t._s(t.numberOfPairs))])]),i("b-col",[i("b-form-input",{attrs:{type:"range",min:"2",max:"12"},on:{change:function(e){return t.save()}},model:{value:t.numberOfPairs,callback:function(e){t.numberOfPairs=e},expression:"numberOfPairs"}})],1)],1),i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Nº de movimientos: "+t._s(t.maxNumberOfMoves))])]),i("b-col",[i("b-form-input",{attrs:{type:"range",step:2,min:t.minMovesValue(),max:"200"},on:{change:function(e){return t.save()}},model:{value:t.maxNumberOfMoves,callback:function(e){t.maxNumberOfMoves=e},expression:"maxNumberOfMoves"}})],1)],1),i("hr"),i("b-row",{staticClass:"right",staticStyle:{"padding-left":"10px"}},[!0===t.customized?i("b-col",{staticStyle:{"padding-top":"10px"}},[i("span",[t._v("Tipo de customización")])]):t._e(),!0===t.customized?i("b-col",{staticStyle:{"padding-top":"5px"}},[i("b-form-select",{staticStyle:{width:"200px"},attrs:{size:"sm",options:t.customizationTypes},on:{change:function(e){return t.save()}},model:{value:t.typeChosen,callback:function(e){t.typeChosen=e},expression:"typeChosen"}})],1):t._e(),t.customized?i("b-col",{attrs:{cols:"3"}},[i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){return t.cardsNotCustomized()}}},[t._v("Cancelar")])],1):i("b-col",{attrs:{cols:"4"}},[i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){t.customized=!0,t.save()}}},[t._v("Customizar tarjetas")])],1)],1),!0===t.customized?i("div",{staticStyle:{"padding-top":"5px"}},["words"===t.typeChosen?i("div",t._l(t.numberOfPairs,(function(e,n){return i("div",{key:n},[i("b-row",{staticStyle:{"margin-left":"2px"}},[i("span",{staticStyle:{"padding-top":"15px"}},[t._v("Pareja "+t._s(e))]),i("b-form-input",{staticStyle:{width:"230px","margin-left":"20px","margin-top":"10px"},attrs:{formatter:t.limit,placeholder:"Tarjeta 1"},on:{change:function(e){return t.save()}},model:{value:t.customWords[2*n],callback:function(e){t.$set(t.customWords,2*n,e)},expression:"customWords[index*2]"}}),i("b-form-input",{staticStyle:{width:"230px","margin-left":"20px","margin-top":"10px"},attrs:{formatter:t.limit,placeholder:"Tarjeta 2"},on:{change:function(e){return t.save()}},model:{value:t.customWords[2*n+1],callback:function(e){t.$set(t.customWords,2*n+1,e)},expression:"customWords[index*2+1]"}})],1)],1)})),0):t._e(),"color"===t.typeChosen?i("div",t._l(t.numberOfPairs,(function(e,n){return i("div",{key:n},[i("b-row",{staticStyle:{"margin-left":"2px"}},[i("span",{staticStyle:{"padding-top":"15px"}},[t._v("Pareja "+t._s(e))]),void 0===t.customColors[n]?i("b-form-input",{staticStyle:{width:"57%","margin-left":"20px","margin-top":"10px"},attrs:{type:"color"},on:{change:function(e){return t.save()}},model:{value:t.customColors[n],callback:function(e){t.$set(t.customColors,n,e)},expression:"customColors[index]"}}):i("b-form-input",{staticStyle:{width:"78%","margin-left":"20px","margin-top":"10px"},attrs:{type:"color"},on:{change:function(e){return t.save()}},model:{value:t.customColors[n],callback:function(e){t.$set(t.customColors,n,e)},expression:"customColors[index]"}}),void 0===t.customColors[n]?i("span",{staticStyle:{color:"red","padding-left":"8px","padding-top":"15px"}},[t._v("Elige algún color")]):t._e()],1)],1)})),0):t._e()]):t._e(),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",centered:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("div",{staticClass:"d-block text-left"},[i("h5",[t._v("Tarjetas de memoria")]),i("p",[t._v("¡Intenta emparejar todas las tarjetas!")])]),!0===t.customized&&"words"===t.typeChosen?i("b-row",{staticStyle:{"margin-left":"15px"}},t._l(t.cards,(function(e,n){return i("div",{key:n},[!1===e.flipped?i("b-button",{staticClass:"card-text",staticStyle:{"margin-bottom":"10px"},attrs:{disabled:2===t.numberOfCardsFlipped||t.numberOfMovesPreview===t.maxNumberOfMoves},on:{click:function(e){return t.flipCardPreview(n)}}}):i("b-button",{staticClass:"memory-card-text",staticStyle:{"margin-bottom":"10px","font-weight":"bold","font-size":"20px"},attrs:{variant:"info"}},[t._v(t._s(e.text))])],1)})),0):i("b-row",{staticStyle:{"margin-left":"15px"}},t._l(t.cards,(function(e,n){return i("div",{key:n},[!1===e.flipped?i("b-button",{staticStyle:{height:"75px",width:"75px",margin:"10px","margin-top":"0px"},attrs:{disabled:2===t.numberOfCardsFlipped||t.numberOfMovesPreview===t.maxNumberOfMoves},on:{click:function(e){return t.flipCardPreview(n)}}}):i("b-button",{staticClass:"memory-card-color",style:e.color})],1)})),0),t.numberOfMovesPreview===t.maxNumberOfMoves&&this.pairsMissing>0?i("p",{staticStyle:{color:"red"}},[t._v("Te has quedado sin movimientos :(")]):i("p",[t._v("Llevas "+t._s(t.numberOfMovesPreview)+" movimientos de "+t._s(t.maxNumberOfMoves)+" disponibles! Te quedan "+t._s(t.maxNumberOfMoves-t.numberOfMovesPreview)+"!! ")]),!0===t.solved?i("p",{staticStyle:{color:"green"}},[t._v("¡Has resuelto el puzzle!")]):t._e(),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-ok",variant:"secondary",block:""},on:{click:function(e){t.show=!1}}},[t._v("Ok")])],1)],1)],1)},gn=[],wn={name:"memoryCards",props:{actualSection:String,sectionsDataAux:Array,numberOfPairsAux:Number,maxNumberOfMovesAux:Number,sectionNoMoreMovesAux:String,sectionSolvedAux:String,changeSectionWhenWrongAux:Boolean,index:Number,customizedAux:Boolean,typeChosenAux:String,customWordsAux:Array,customColorsAux:Array},data:function(){return{sections:[],valid:!0,numberOfPairs:this.numberOfPairsAux,maxNumberOfMoves:this.maxNumberOfMovesAux,sectionNoMoreMoves:this.sectionNoMoreMovesAux,sectionSolved:this.sectionSolvedAux,changeSectionWhenWrong:this.changeSectionWhenWrongAux,customized:this.customizedAux,customizationTypes:[{value:"color",text:"Colores"},{value:"words",text:"Palabras"}],typeChosen:this.typeChosenAux,customWords:this.customWordsAux,customColors:this.customColorsAux,show:!1,numberOfMovesPreview:0,pairsMissing:this.numberOfPairs,cardTypes:[{color:"#4CAF50"},{color:"#008CBA"},{color:"#FF9713"},{color:"#EE2A1C"},{color:"#A97FCB"},{color:"#F12CDF"},{color:"#18FCC5"},{color:"#5E22F1"},{color:"#F0A899"},{color:"#074F1D"},{color:"#5F380A"},{color:"#DEF122"}],cards:[],numberOfCardsFlipped:0,cardClickedBefore:"",solved:!1}},watch:{sectionsDataAux:function(){this.refresh()},actualSection:function(){this.refresh()},numberOfPairsAux:function(){this.refresh()},numberOfPairs:function(){this.maxNumberOfMoves<2*parseInt(this.numberOfPairs,10)+parseInt(this.numberOfPairs,10)+parseInt(this.numberOfPairs,10)%2&&(this.maxNumberOfMoves=2*parseInt(this.numberOfPairs,10)+parseInt(this.numberOfPairs,10)+parseInt(this.numberOfPairs,10)%2)},maxNumberOfMovesAux:function(){this.refresh()},sectionNoMoreMovesAux:function(){this.refresh()},sectionSolvedAux:function(){this.refresh()},changeSectionWhenWrongAux:function(){this.refresh()},customizedAux:function(){this.refresh()},typeChosenAux:function(){this.refresh()},customWordsAux:function(){this.refresh()},customColorsAux:function(){this.refresh()},index:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){this.sections=[],this.valid=!1,this.numberOfPairs=this.numberOfPairsAux,this.maxNumberOfMoves=this.maxNumberOfMovesAux,this.sectionNoMoreMoves=this.sectionNoMoreMovesAux,this.sectionSolved=this.sectionSolvedAux,this.changeSectionWhenWrong=this.changeSectionWhenWrongAux,this.customized=this.customizedAux,this.typeChosen=this.typeChosenAux,this.customWords=this.customWordsAux,this.customColors=this.customColorsAux,this.deepClone(),this.checkContent();for(var t=!1,e=0;e<this.sections.length&&!t;++e)this.sections[e].value===this.actualSection&&(0===e&&this.sections[e].value===this.sectionSolved&&this.sections.length>1&&(this.sectionSolved=this.sections[1].value),this.sections.splice(e,1),t=!0);this.sections.length>0&&(this.valid=!0),this.valid||(this.sectionSolved="",this.sectionNoMoreMoves=""),this.save()},deepClone:function(){for(var t=0;t<this.sectionsDataAux.length;++t)this.sections.push(this.sectionsDataAux[t])},checkContent:function(){if((""===this.sectionNoMoreMoves||void 0===this.sectionNoMoreMoves)&&this.sectionsDataAux.length>1)this.sectionNoMoreMoves=this.sectionsDataAux[0].value;else{for(var t=!1,e=0;e<this.sections.length&&!t;++e)this.sectionNoMoreMoves===this.sections[e].value&&(t=!0);!t&&this.sectionsDataAux.length>1?this.sectionNoMoreMoves=this.sectionsDataAux[0].value:t||(this.sectionNoMoreMoves="")}if((""===this.sectionSolved||void 0===this.sectionSolved)&&this.sectionsDataAux.length>1)this.sectionSolved=this.sectionsDataAux[0].value;else{for(var i=!1,n=0;n<this.sections.length&&!i;++n)this.sectionSolved===this.sections[n].value&&(i=!0);!i&&this.sectionsDataAux.length>1?this.sectionSolved=this.sectionsDataAux[0].value:i||(this.sectionSolved="")}},save:function(){void 0===this.sectionNoMoreMoves&&(this.sectionNoMoreMoves=""),void 0===this.sectionSolved&&(this.sectionSolved=""),this.maxNumberOfMoves>200&&(this.maxNumberOfMoves="200"),this.$emit("save",parseInt(this.numberOfPairs,10),parseInt(this.maxNumberOfMoves,10),this.sectionNoMoreMoves,this.sectionSolved,this.changeSectionWhenWrong,this.customized,this.typeChosen,this.customWords,this.customColors,this.index)},noWrongSection:function(){this.changeSectionWhenWrong=!1,this.sectionNoMoreMoves="",this.save()},cardsNotCustomized:function(){this.customized=!1,this.typeChosen="",this.save()},shufflePreview:function(){this.pairsMissing=this.numberOfPairs,this.solved=!1,this.numberOfMovesPreview=0,this.numberOfCardsFlipped=0,this.cards=[];for(var t=0;t<2*this.numberOfPairs;++t)this.cards.push({color:"",flipped:Boolean,text:"",value:0});var e=1,i=0;while(i<2*this.numberOfPairs){var n=Math.floor(Math.random()*(2*this.numberOfPairs));0===this.cards[n].value&&(this.customized&&"words"===this.typeChosen?this.cards[n].text=this.customWords[i]:this.customized&&"color"===this.typeChosen?this.cards[n].color="background-color: "+this.customColors[e-1]+";":this.cards[n].color="background-color: "+this.cardTypes[e-1].color+";",this.cards[n].flipped=!1,this.cards[n].value=e,i++,i%2===0&&e++)}},flipCardPreview:function(t){var e=this;this.numberOfCardsFlipped++,this.cards[t].flipped=!this.cards[t].flipped,this.numberOfMovesPreview++,1===this.numberOfCardsFlipped&&(this.cardClickedBefore=t),2===this.numberOfCardsFlipped&&this.cards[t].value===this.cards[this.cardClickedBefore].value&&(this.numberOfCardsFlipped=0,this.pairsMissing--,0===this.pairsMissing&&(this.solved=!0)),2===this.numberOfCardsFlipped&&this.cards[t].value!==this.cards[this.cardClickedBefore].value&&setTimeout((function(){e.refreshPreview(t)}),1e3)},refreshPreview:function(t){this.cards[t].flipped=!1,this.cards[this.cardClickedBefore].flipped=!1,this.numberOfCardsFlipped=0},limit:function(t){return String(t).substring(0,15)},minMovesValue:function(){return 2*parseInt(this.numberOfPairs,10)+parseInt(this.numberOfPairs,10)+parseInt(this.numberOfPairs,10)%2}}},yn=wn,kn=(i("fa9c"),i("baad"),Object(_["a"])(yn,xn,gn,!1,null,"7dd9347f",null)),Sn=kn.exports,_n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Completar pistas")]),i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-auto",staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info",title:"Previsualizar gadget"},on:{click:function(e){return t.preparePreview()}}},[i("b-icon",{attrs:{icon:"eye"}})],1)],1),t.valid?t._e():i("span",{staticStyle:{color:"red"}},[t._v("No hay más secciones a las que saltar. Este gadget no cambiará de secciones en la lectura en la lectura")]),i("br"),i("b-row",{staticClass:"right"},[i("b-col",{attrs:{cols:"5"}},[i("span",[t._v("Cambio de sección al acertar: ")])]),i("b-col",[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:t.onGuess,callback:function(e){t.onGuess=e},expression:"onGuess"}})],1)],1),i("b-row",{staticClass:"right",staticStyle:{"padding-left":"10px"}},[t.changeSectionWhenWrong?i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){t.wrong(),t.save()}}},[t._v("Continuar lectura al fallar")]):i("b-button",{staticStyle:{"font-size":"14px"},attrs:{variant:"outline-dark",size:"sm"},on:{click:function(e){t.wrong(),t.save()}}},[t._v("Cambiar de sección al fallar")]),t.changeSectionWhenWrong?i("b-col",{staticStyle:{"padding-top":"5px"}},[i("b-form-select",{attrs:{size:"sm",options:t.aux},on:{change:function(e){return t.save()}},model:{value:t.onWrong,callback:function(e){t.onWrong=e},expression:"onWrong"}})],1):t._e()],1),i("hr"),i("div",[i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Nº de pistas: "+t._s(t.cluesNumber))])]),i("b-col",[t.aux.length>0?i("b-form-input",{attrs:{type:"range",min:"1",max:"5"},on:{change:function(e){t.modifyClues(),t.save()},blur:function(e){return t.modifyOptions()}},model:{value:t.cluesNumber,callback:function(e){t.cluesNumber=e},expression:"cluesNumber"}}):t._e()],1)],1),t._l(t.clues,(function(e,n){return i("div",{key:n,staticStyle:{"padding-bottom":"10px"}},[i("b-row",[i("b-col",{attrs:{cols:"3"}},[i("span",[t._v("Valor pista "+t._s(n+1)+": ")])]),i("b-col",[i("b-form-input",{attrs:{type:"text",size:"sm"},on:{change:function(e){return t.save()},blur:function(e){return t.modifyOptions()}},model:{value:e.clue,callback:function(i){t.$set(e,"clue",i)},expression:"element.clue"}})],1)],1)],1)}))],2),i("hr"),i("div",[i("b-row",{staticStyle:{"padding-bottom":"10px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Nº de respuestas: "+t._s(t.answersNumber))])]),i("b-col",[t.aux.length>0?i("b-form-input",{attrs:{type:"range",min:"1",max:"5"},on:{change:function(e){t.modifyAnswers(),t.save()}},model:{value:t.answersNumber,callback:function(e){t.answersNumber=e},expression:"answersNumber"}}):t._e()],1)],1),t._l(t.answers,(function(e,n){return i("div",{key:n,staticStyle:{"padding-bottom":"10px"}},[i("b-row",[i("b-col",{attrs:{cols:"3"}},[i("span",[t._v("Respuesta "+t._s(n+1)+": ")])]),i("b-col",[i("b-form-select",{attrs:{options:t.options,size:"sm"},on:{change:function(e){return t.save()}},model:{value:e.answer,callback:function(i){t.$set(e,"answer",i)},expression:"element.answer"}})],1)],1)],1)}))],2),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",centered:""},model:{value:t.showPreview,callback:function(e){t.showPreview=e},expression:"showPreview"}},[t._l(t.dataPreview,(function(e,n){return i("div",{key:n,staticStyle:{"min-width":"200px",width:"200px","margin-top":"10px"}},[i("b-form-select",{attrs:{options:t.optionsPreview,size:"sm"},model:{value:t.dataPreview[n],callback:function(e){t.$set(t.dataPreview,n,e)},expression:"dataPreview[index]"}})],1)})),i("p",{staticStyle:{"font-size":"14px"}},[t._v("Selecciona las repuestas correcatas y pulsa solucionar")]),i("div",[t.valid?i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-dark"},on:{click:function(e){return t.checkPreview()}}},[t._v("Solucionar")]):t._e(),!0===t.solvedPreview?i("p",{staticStyle:{"padding-top":"10px",color:"green"}},[t._v(" ¡Has resuelto el problema!")]):t._e(),!1===t.solvedPreview?i("p",{staticStyle:{"padding-top":"10px",color:"red"}},[t._v(" ¡Fallaste! Más suerte la próxima vez")]):t._e()],1),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticClass:"mt-1",staticStyle:{"font-size":"16px"},attrs:{id:"button-modal-ok",variant:"secondary",block:""},on:{click:function(e){t.showPreview=!1,t.solvedPreview=null}}},[t._v("Ok")])],1)],2)],1)},Cn=[],Tn={name:"completeClues",props:{actualSection:String,auxSectionsData:Array,auxAnswersNumber:Number,auxAnswers:Array,auxCluesNumber:Number,auxClues:Array,auxOnGuess:String,auxChangeSectionWhenWrong:Boolean,auxOnWrong:String,index:Number},data:function(){return{aux:[],answersNumber:1,answers:[],cluesNumber:1,clues:[],onGuess:"",changeSectionWhenWrong:!1,onWrong:"",options:[],valid:!0,showPreview:!1,dataPreview:[],optionsPreview:[],solvedPreview:null}},watch:{auxSectionsData:function(){this.refresh()},actualSection:function(){this.refresh()},auxAnswersNumber:function(){this.refresh()},auxAnswers:function(){this.refresh()},auxCluesNumber:function(){this.refresh()},auxClues:function(){this.refresh()},auxOnGuess:function(){this.refresh()},auxChangeSectionWhenWrong:function(){this.refresh()},auxOnWrong:function(){this.refresh()},index:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){this.aux=[],this.answers=[],this.answersNumber=this.auxAnswersNumber,this.clues=[],this.cluesNumber=this.auxCluesNumber,this.onGuess=this.auxOnGuess,this.changeSectionWhenWrong=this.auxChangeSectionWhenWrong,this.onWrong=this.auxOnWrong,this.options=[],this.valid=!1,this.deepClone(),this.checkContent(),this.hardRefresh()},hardRefresh:function(){for(var t=!1,e=-1,i=!1,n=0;n<this.aux.length&&!i;++n)this.aux[n].value===this.actualSection&&(0===n&&this.aux[n].value===this.onWrong&&this.aux.length>1&&(this.onWrong=this.aux[1].value),0===n&&this.aux[n].value===this.onGuess&&this.aux.length>1&&(this.onGuess=this.aux[1].value),t=!0,e=n,i=!0);this.aux.length>1&&(this.valid=!0),t&&this.aux.splice(e,1)},modifyAnswers:function(){if(this.answersNumber=parseInt(this.answersNumber,10),this.answersNumber>this.answers.length)for(var t=this.answers.length;t<this.answersNumber;++t)this.answers.push({answer:this.clues[0].clue});else if(this.answersNumber<this.answers.length)for(var e=this.answers.length;e>this.answersNumber;--e)this.answers.pop();this.answersNumber=this.answers.length,this.hardRefresh()},modifyClues:function(){if(this.cluesNumber=parseInt(this.cluesNumber,10),this.cluesNumber>this.clues.length)for(var t=this.clues.length;t<this.cluesNumber;++t)this.clues.push({clue:""});else if(this.cluesNumber<this.clues.length)for(var e=this.clues.length;e>this.cluesNumber;--e)this.clues.pop();this.cluesNumber=this.clues.length,this.modifyOptions(),this.hardRefresh()},modifyOptions:function(){this.options=[];for(var t=0;t<this.clues.length;++t)this.options.push({value:this.clues[t].clue,text:this.clues[t].clue});for(var e=0;e<this.answers.length;++e){for(var i=!1,n=0;n<this.options.length&&!i;++n)this.answers[e].answer===this.options[n].value&&(i=!0);i||(this.answers[e].answer=this.options[0].value)}},deepClone:function(){for(var t=0;t<this.auxSectionsData.length;++t)this.aux.push(this.auxSectionsData[t]);for(var e=0;e<this.auxClues.length;++e)this.clues.push(this.auxClues[e]),this.options.push({value:this.auxClues[e].clue,text:this.auxClues[e].clue});for(var i=0;i<this.auxAnswers.length;++i)this.answers.push(this.auxAnswers[i])},checkContent:function(){if((""===this.onWrong||void 0===this.onWrong)&&this.auxSectionsData.length>1)this.onWrong=this.auxSectionsData[0].value;else{for(var t=!1,e=0;e<this.aux.length&&!t;++e)this.onWrong===this.aux[e].value&&(t=!0);!t&&this.auxSectionsData.length>1?this.onWrong=this.auxSectionsData[0].value:t||(this.onWrong="")}if((""===this.onGuess||void 0===this.onGuess)&&this.auxSectionsData.length>1)this.onGuess=this.auxSectionsData[0].value;else{for(var i=!1,n=0;n<this.aux.length&&!i;++n)this.onGuess===this.aux[n].value&&(i=!0);!i&&this.auxSectionsData.length>1?this.onGuess=this.auxSectionsData[0].value:i||(this.onGuess="")}},wrong:function(){this.changeSectionWhenWrong=!this.changeSectionWhenWrong},save:function(){this.answersNumber=parseInt(this.answersNumber,10),this.cluesNumber=parseInt(this.cluesNumber,10),this.numberOfConditions=parseInt(this.numberOfConditions,10),this.$emit("clues",this.answers,this.answersNumber,this.clues,this.cluesNumber,this.onGuess,this.changeSectionWhenWrong,this.onWrong,this.index)},preparePreview:function(){this.showPreview=!0,this.dataPreview=[],this.optionsPreview=[];for(var t=0;t<this.clues.length;++t)this.optionsPreview.push({value:this.clues[t].clue,text:this.clues[t].clue});for(var e=0;e<this.answers.length;++e)this.dataPreview.push(this.clues[0].clue)},checkPreview:function(){for(var t=!1,e=0;e<this.answers.length&&!t;++e)this.answers[e].answer!==this.dataPreview[e]&&(t=!0);t?t&&(this.solvedPreview=!1):this.solvedPreview=!0}}},Pn=Tn,Nn=(i("9d28"),Object(_["a"])(Pn,_n,Cn,!1,null,"49fb49fb",null)),On=Nn.exports,Dn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",[i("div",{staticClass:"d-flex justify-content-start"},[i("h6",{staticClass:"title"},[t._v("Casilla personalizada")]),i("span",[i("b-icon",{staticClass:"h4 clickable",staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{variant:"info",icon:"question-circle"},on:{click:function(e){t.customBoxesInfoModal=!0}}})],1)]),i("br"),t.validName?t._e():i("span",{staticStyle:{color:"red"}},[t._v("Aviso: Si el nombre de la casilla no es válido, no se verá en la lectura")]),i("b-form-group",[i("span",[t._v("Uso de la casilla: ")]),t.aux.length>0?i("b-form-radio-group",{attrs:{id:"radio-modes",options:t.modeOptions,buttons:"","button-variant":"outline-primary",size:"sm"},on:{change:t.checkMode},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}}):i("b-form-radio-group",{attrs:{id:"radio-modes",options:t.modeOptionsDisabled,buttons:"","button-variant":"outline-primary",size:"sm"},on:{change:t.checkMode},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}})],1),i("hr"),"read"==t.mode?i("div",[i("b-row",{staticStyle:{"margin-bottom":"5px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Texto anterior: ")])]),i("b-col",[i("b-form-textarea",{attrs:{rows:"3","no-resize":"",placeholder:"Texto anterior (opcional)",formatter:t.formatText},nativeOn:{blur:function(e){return t.save(e)}},model:{value:t.prevText,callback:function(e){t.prevText=e},expression:"prevText"}})],1)],1),i("b-row",{staticStyle:{"margin-bottom":"5px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Leer de casilla: ")])]),i("b-col",[i("b-form-select",{attrs:{id:"select-read",options:t.aux},on:{change:t.save},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),i("b-row",[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Texto posterior: ")])]),i("b-col",[i("b-form-textarea",{attrs:{rows:"3","no-resize":"",placeholder:"Texto posterior (opcional)",formatter:t.formatText},on:{blur:t.save},model:{value:t.nextText,callback:function(e){t.nextText=e},expression:"nextText"}})],1)],1)],1):"write"==t.mode?i("div",[i("b-row",{staticStyle:{"margin-bottom":"5px"}},[i("b-col",{attrs:{cols:"6"}},[i("span",[t._v("Identificador único: ")])]),i("b-col",[i("b-form-input",{attrs:{state:t.nameState,placeholder:"Nombre de la casilla",formatter:t.formatName,size:"sm"},on:{blur:t.updateAux},nativeOn:{input:function(e){return t.nameStateAux(e)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),i("b-row",{staticStyle:{"margin-bottom":"5px"}},[i("b-col",[i("span",[t._v("Nombre para la lectura: ")])]),i("b-col",[i("b-form-input",{attrs:{type:"text",placeholder:"Título",formatter:t.formatTitle,size:"sm"},on:{blur:t.save},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)],1),i("hr"),"write"==t.mode?i("b-form-group",[i("span",[t._v("Tipo de contenido: ")]),i("b-form-radio-group",{attrs:{id:"radio-type",options:t.typeOptions,buttons:"","button-variant":"outline-primary",size:"sm"},on:{change:t.changeType},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1):t._e(),i("b-row",[i("b-col",{attrs:{cols:"6"}},["string"==t.type?i("span",[t._v("Valor por defecto: ")]):"number"==t.type?i("span",[t._v("Valor por defecto: ")]):t._e()]),i("b-col",["string"==t.type?i("b-form-input",{attrs:{type:"text",placeholder:"Texto por defecto",formatter:t.formatString,size:"sm"},on:{blur:t.updateAux},model:{value:t.defaultValue,callback:function(e){t.defaultValue=e},expression:"defaultValue"}}):"number"==t.type?i("b-form-input",{attrs:{type:"number",placeholder:"Número por defecto",formatter:t.formatNumber,size:"sm"},on:{blur:t.updateAux},model:{value:t.defaultValue,callback:function(e){t.defaultValue=e},expression:"defaultValue"}}):t._e()],1)],1)],1):"modifyWrite"==t.mode?i("div",[i("b-row",{staticStyle:{"margin-bottom":"5px"}},[i("b-col",{attrs:{cols:"4"}},[i("span",[t._v("Modificar la casilla: ")])]),i("b-col",[i("b-form-select",{attrs:{id:"select-read",options:t.aux},on:{change:t.save},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),i("b-row",{staticStyle:{"margin-bottom":"5px"}},[i("b-col",[i("span",[t._v("Nombre para la lectura: ")])]),i("b-col",[i("b-form-input",{attrs:{type:"text",placeholder:"Título",formatter:t.formatTitle,size:"sm"},on:{blur:t.save},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)],1)],1):t._e()],1),i("b-modal",{attrs:{size:"lg","hide-header":"","hide-footer":"",centered:""},model:{value:t.customBoxesInfoModal,callback:function(e){t.customBoxesInfoModal=e},expression:"customBoxesInfoModal"}},[i("h4",[t._v("Información sobre el gadget")]),i("div",{staticStyle:{"text-align":"justify"}},[i("p",{staticStyle:{"margin-top":"20px"}},[t._v("Para la utilización de este gadget es necesario saber ciertas cosas de su funcionamiento:")]),i("ul",{staticStyle:{"padding-right":"20px"}},[i("li",[t._v("Es necesario tener "),i("b",[t._v("mínimo dos gadgets")]),t._v(" de casilla personalizada, uno para permitir al lector escribir su parámetro personalizado y otro para mostrar este parámetro en la lectura.")]),i("li",[t._v("El "),i("b",[t._v("identificador único ")]),t._v(" o nombre de la casilla en el modo de escribir representa a qué casilla personalizada harán referencia las de lectura o modificar. En caso de tener varias casillas personalizadas (en modo escritura), permitirá diferenciarlas a la hora de mostrar el contenido en la lectura del libro.")])]),i("p",{staticStyle:{"margin-top":"20px"}},[t._v("Información más detallada sobre los usos de las casillas: ")]),i("ul",{staticStyle:{"padding-right":"20px"}},[i("li",[i("b",[t._v("Leer: ")]),t._v("Este uso se puede utilizar solamente cuando haya al menos una casilla con el uso de escribir definida, ya que se encargará de mostrar en cualquier parte del libro el contenido que el lector haya indicado en la casilla personaliza con el uso de escribir.")]),i("li",[i("b",[t._v("Escribir: ")]),t._v("Esta es el tipo de casilla personalizada básica, donde indicarás en el libro qué contenido está siendo personalizado y le permitirás al lector introducir aquí el dato que quiera durante la lectura del libro. Se da la opción de que sea texto o números.")]),i("li",[i("b",[t._v("Modificar escribir: ")]),t._v("Si en algún momento del libro te gustaría darle la posibilidad al lector de cambiar el valor que introdujo durante algún momento de la lectura, esta es la casilla indicada, es igual que la casilla de escritura sólo que modifica el valor sobre una ya existente, cambiando también el valor de todas las apariciones personalizadas durante el libro.")])])])])],1)},An=[],Ln=(i("0d03"),i("25f0"),{name:"customBox",props:{auxCustomBoxesData:Array,auxName:String,auxMode:String,auxType:String,auxValue:String,auxDefaultValue:String,auxTitle:String,auxPrevText:String,auxNextText:String,index:Number},data:function(){return{aux:[],name:"",oldName:"",mode:"write",oldMode:"write",modeOptions:[{value:"read",text:"Leer"},{value:"write",text:"Escribir"},{value:"modifyWrite",text:"Modificar escribir"}],modeOptionsDisabled:[{value:"read",text:"Leer",disabled:!0},{value:"write",text:"Escribir"},{value:"modifyWrite",text:"Modificar escribir",disabled:!0}],type:"string",oldType:"string",typeOptions:[{value:"string",text:"Texto"},{value:"number",text:"Número"}],value:"",defaultValue:"",title:"",prevText:"",nextText:"",validName:!0,customBoxesInfoModal:!1}},watch:{auxCustomBoxesData:function(){this.refresh()},auxName:function(){this.refresh()},auxMode:function(){this.refresh()},auxType:function(){this.refresh()},auxValue:function(){this.refresh()},auxDefaultValue:function(){this.refresh()},auxTitle:function(){this.refresh()},auxPrevText:function(){this.refresh()},auxNextText:function(){this.refresh()},index:function(){this.refresh()}},computed:{nameState:function(){for(var t=0;t<this.aux.length;++t)if(""===this.name||this.name===this.aux[t].value&&this.name!==this.oldName)return!1;return 0!==this.aux.length||""!==this.name}},mounted:function(){this.refresh(),this.nameStateAux()},methods:{refresh:function(){this.aux=[],this.name=this.auxName,this.oldName=this.auxName,this.mode=this.auxMode,this.oldMode=this.auxMode,this.type=this.auxType,this.oldType=this.auxType,this.value=this.auxValue,this.defaultValue=this.auxDefaultValue,this.title=this.auxTitle,this.prevText=this.auxPrevText,this.nextText=this.auxNextText,this.deepClone(),this.hardRefresh(),this.nameStateAux()},hardRefresh:function(){if(this.auxCustomBoxesData.length<=0&&("read"===this.mode||"modifyWrite"===this.mode))this.name="",this.oldName="",this.mode="write",this.type="string",this.value="";else if(this.auxCustomBoxesData.length>0&&("read"===this.mode||"modifyWrite"===this.mode)){this.oldName="";for(var t=!0,e=0;e<this.aux.length&&t;++e)this.name===this.aux[e].value&&(t=!1);t&&(this.name=this.aux[0].value)}this.save()},deepClone:function(){if("write"===this.mode)for(var t=0;t<this.auxCustomBoxesData.length;++t)this.name!==this.auxCustomBoxesData[t].name&&this.aux.push({value:this.auxCustomBoxesData[t].name,text:this.auxCustomBoxesData[t].name});else if("read"===this.mode||"modifyWrite"===this.mode)for(var e=0;e<this.auxCustomBoxesData.length;++e)this.aux.push({value:this.auxCustomBoxesData[e].name,text:this.auxCustomBoxesData[e].name})},nameStateAux:function(){if("write"===this.mode){for(var t=0;t<this.aux.length;++t)if(""===this.name||this.name===this.aux[t].value&&this.name!==this.oldName)return this.validName=!1,!1;if(0===this.aux.length&&""===this.name)return this.validName=!1,!1}return this.validName=!0,!0},checkMode:function(t){"read"===t&&"read"!==this.oldMode?(this.validName=!0,this.$emit("read",this.oldName),this.value="",this.defaultValue="",this.title="",this.name=this.aux[0].value,this.prevText="",this.nextText="",this.oldName="",this.mode="read",this.oldMode="read",0===this.auxCustomBoxesData.length&&(this.mode="write",this.name="",this.type="string",this.value="",this.defaultValue="",this.validName=!1),this.save()):"write"===t&&"write"!==this.oldMode?(this.name="",this.validName&&this.$emit("write",this.name,this.type,this.value,this.defaultValue),this.oldName=this.name,this.type="string",this.value="",this.defaultValue="",this.title="",this.prevText="",this.nextText="",this.mode="write",this.oldMode="write",this.validName=!1,this.save()):"modifyWrite"===t&&"modifyWrite"!==this.oldMode&&(this.validName=!0,this.$emit("read",this.oldName),this.value="",this.defaultValue=this.aux[0].defaultValue,this.title="",this.name=this.aux[0].value,this.prevText="",this.nextText="",this.oldName="",this.mode="modifyWrite",this.oldMode="modifyWrite",0===this.auxCustomBoxesData.length&&(this.mode="write",this.name="",this.type="string",this.value="",this.defaultValue="",this.validName=!1),this.save())},updateAux:function(){""!==this.oldName?(this.saveSafe(),this.validName?(this.$emit("update",this.oldName,this.name,this.type,this.value,this.defaultValue),this.oldName=this.name):this.name=this.oldName):(this.saveSafe(),this.validName?this.$emit("write",this.name,this.type,this.value,this.defaultValue):this.name=this.oldName),this.nameStateAux()},changeType:function(t){"string"===t&&"number"===this.oldType?(this.defaultValue="",this.oldType="string"):"number"===t&&"string"===this.oldType&&(this.defaultValue=0,this.oldType="number"),this.saveLimited(t),this.$emit("update",this.oldName,this.name,t,this.value,this.defaultValue)},findValues:function(){for(var t=!1,e=0;e<this.auxCustomBoxesData.length&&!t;++e)this.auxCustomBoxesData[e].name===this.name&&(this.defaultValue=this.auxCustomBoxesData[e].defaultValue,this.type=this.auxCustomBoxesData[e].type,t=!0)},formatName:function(t){return String(t).substring(0,20)},formatString:function(t){return String(t).substring(0,30)},formatNumber:function(t){return""===t?0:parseInt(String(t).substring(0,4))},formatTitle:function(t){return String(t).substring(0,50)},formatText:function(t){return String(t).substring(0,1e3)},save:function(){"modifyWrite"===this.mode?this.findValues():"number"===this.type&&(this.defaultValue=this.defaultValue.toString()),""===this.title&&(this.title=this.name),this.$emit("save",this.name,this.mode,this.type,this.value,this.defaultValue,this.title,this.prevText,this.nextText,this.index)},saveSafe:function(){"number"===this.type&&(this.defaultValue=this.defaultValue.toString()),this.validName&&this.$emit("save",this.name,this.mode,this.type,this.value,this.defaultValue,this.title,this.prevText,this.nextText,this.index)},saveLimited:function(t){"number"===t&&(this.defaultValue=this.defaultValue.toString()),this.$emit("saveLimited",this.mode,t,this.value,this.defaultValue,this.index)}}}),Mn=Ln,Bn=(i("7759"),Object(_["a"])(Mn,Dn,An,!1,null,"5b77d7c2",null)),In=Bn.exports,zn={name:"editBook",components:{SectionManagementModal:be,LoadingModal:ke,SavingModal:Ne,Normal:Be,Header1:$e,Header2:Fe,Header3:Qe,ExpandableText:si,PopupText:ui,Hyperlink:bi,Spoiler:ki,PictureGadget:Ni,VideoGadget:Bi,ChangeSection:$i,RepeatSection:Fi,DecisionMaking:Qi,Riddle:an,Sequence:dn,RandomNumber:vn,MemoryCards:Sn,CompleteClues:On,CustomBoxes:In},data:function(){return{book:A.state.openedBook,bookID:A.state.openBookID,sectionName:"",sectionID:"",nextSectionID:A.state.openedBook.sections[0],sectionsData:[],temporalCustomBoxes:[],loading:!1,saving:!1,showManagementSectionModal:!1,boldActive:0,boldUse:!1,italicActive:0,italicUse:!1,underlineActive:0,underlineUse:!1,strikeThroughActive:0,strikeThroughUse:!1,header1Active:0,header2Active:0,header3Active:0,lastPress:-1,data:[],showPreviewSection:!1}},mounted:function(){this.refresh(A.state.sectionID)},methods:{refresh:function(t){var e,i=this;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return this.loading=!0,this.lastPress=-1,this.sectionsData=[],this.temporalCustomBoxes=[],this.data=[],A.commit("changeSection",t),n.next=8,regeneratorRuntime.awrap(v.doc(this.bookID).get().then((function(t){i.temporalCustomBoxes=t.data().customBoxes,i.book.sections=t.data().sections})));case 8:e=0;case 9:if(!(e<this.book.sections.length)){n.next=15;break}return n.next=12,regeneratorRuntime.awrap(g.doc(this.book.sections[e]).get().then((function(t){t.exists&&i.sectionsData.push({value:t.id,text:t.data().name})})));case 12:++e,n.next=9;break;case 15:return n.next=17,regeneratorRuntime.awrap(g.doc(t).get().then((function(t){i.sectionName=t.data().name,i.sectionID=t.id,i.nextSectionID=t.id,i.data=i.data.concat(t.data().gadgets)})));case 17:this.loading=!1;case 18:case"end":return n.stop()}}),null,this)},itemUp:function(t){if(t>0){var e=this.data[t];this.data.splice(t,1,this.data[t-1]),this.data.splice(t-1,1,e)}},itemDown:function(t){if(t<this.data.length-1){var e=this.data[t];this.data.splice(t,1,this.data[t+1]),this.data.splice(t+1,1,e)}},itemDelete:function(t){"CustomBox"===this.data[t].component&&"write"===this.data[t].mode&&this.checkRead(this.data[t].name),this.data.splice(t,1),0===this.data.length&&(this.lastPress=-1)},itemClone:function(t){if("Normal"===this.data[t].component)this.data.splice(t+1,0,{htmlText:this.data[t].htmlText,component:"Normal",componentName:"Texto normal"});else if("Header1"===this.data[t].component)this.data.splice(t+1,0,{plainText:this.data[t].plainText,htmlText:this.data[t].htmlText,component:"Header1",componentName:"Título"});else if("Header2"===this.data[t].component)this.data.splice(t+1,0,{plainText:this.data[t].plainText,htmlText:this.data[t].htmlText,component:"Header2",componentName:"Título"});else if("Header3"===this.data[t].component)this.data.splice(t+1,0,{plainText:this.data[t].plainText,htmlText:this.data[t].htmlText,component:"Header3",componentName:"Título"});else if("ExpandableText"===this.data[t].component)this.data.splice(t+1,0,{mainText:this.data[t].mainText,expandedText:this.data[t].expandedText,component:"ExpandableText",componentName:"Texto expandible"});else if("PopupText"===this.data[t].component)this.data.splice(t+1,0,{mainText:this.data[t].mainText,popupText:this.data[t].popupText,htmlText:this.data[t].htmlText,picture:this.data[t].picture,component:"PopupText",componentName:"Anotación"});else if("Hyperlink"===this.data[t].component)this.data.splice(t+1,0,{htmlText:this.data[t].htmlText,mainText:this.data[t].mainText,hyperlinkText:this.data[t].hyperlinkText,component:"Hyperlink",componentName:"Hipervínculo"});else if("Spoiler"===this.data[t].component)this.data.splice(t+1,0,{plainText:this.data[t].plainText,htmlText:this.data[t].htmlText,component:"Spoiler",componentName:"Spoiler"});else if("Picture"===this.data[t].component)this.data.splice(t+1,0,{htmlText:this.data[t].htmlText,url:this.data[t].url,component:"Picture",componentName:"Imagen"});else if("Video"===this.data[t].component)this.data.splice(t+1,0,{htmlText:this.data[t].htmlText,url:this.data[t].url,autoplay:this.data[t].autoplay,loop:this.data[t].loop,component:"Video",componentName:"Vídeo"});else if("ChangeSection"===this.data[t].component)this.data.splice(t+1,0,{plainText:this.data[t].plainText,htmlText:this.data[t].htmlText,next:this.data[t].next,component:"ChangeSection",componentName:"Cambio de sección"});else if("RepeatSection"===this.data[t].component)this.data.splice(t+1,0,{plainText:this.data[t].plainText,htmlText:this.data[t].htmlText,component:"RepeatSection",componentName:"Repetición de sección"});else if("DecisionMaking"===this.data[t].component){for(var e=[],i=0;i<this.data[t].choices.length;++i)e.push({plainText:this.data[t].choices[i].plainText,htmlText:this.data[t].choices[i].htmlText,choice:this.data[t].choices[i].choice,action:this.data[t].choices[i].action});this.data.splice(t+1,0,{choices:e,numberOfOptions:this.data[t].numberOfOptions,component:"DecisionMaking",componentName:"Toma de decisiones"})}else if("Riddle"===this.data[t].component)this.data.splice(t+1,0,{changeSectionWhenWrong:this.data[t].changeSectionWhenWrong,riddleText:this.data[t].riddleText,answerText:this.data[t].answerText,rightSection:this.data[t].rightSection,wrongSection:this.data[t].wrongSection,numberOfTries:this.data[t].numberOfTries,component:"Riddle",componentName:"Adivinanza"});else if("RandomNumber"===this.data[t].component){for(var n=[],s=0;s<this.data[t].conditions.length;++s)n.push({condition:this.data[t].conditions[s].condition,number:this.data[t].conditions[s].number,section:this.data[t].conditions[s].section});this.data.splice(t+1,0,{lowerLimit:this.data[t].lowerLimit,upperLimit:this.data[t].upperLimit,numberOfConditions:this.data[t].numberOfConditions,conditions:n,component:"RandomNumber",componentName:"Número aleatorio"})}else if("Sequence"===this.data[t].component){var a,o=[],r=[];for(a=0;a<this.data[t].sequence.length;++a)o.push({text:this.data[t].sequence[a].text});for(a=0;a<this.data[t].solution.length;++a)r.push({text:this.data[t].solution[a].text});this.data.splice(t+1,0,{numberOfTries:this.data[t].numberOfTries,sequence:o,solution:r,changeSectionWhenWrong:this.data[t].changeSectionWhenWrong,wrongSection:this.data[t].wrongSection,rightSection:this.data[t].rightSection,component:"Sequence",componentName:"Secuencia"})}else if("MemoryCards"===this.data[t].component)this.data.splice(this.lastPress+1,0,{numberOfPairs:this.data[t].numberOfPairs,maxNumberOfMoves:this.data[t].maxNumberOfMoves,sectionNoMoreMoves:this.data[t].sectionNoMoreMoves,sectionSolved:this.data[t].sectionSolved,changeSectionWhenWrong:this.data[t].changeSectionWhenWrong,customized:this.data[t].customized,typeChosen:this.data[t].typeChosen,customWords:this.data[t].customWords,customColors:this.data[t].customColors,component:"MemoryCards",componentName:"Tarjetas de memoria"});else if("CompleteClues"===this.data[t].component){var c,l=[],u=[];for(c=0;c<this.data[t].answers.length;++c)l.push({answer:this.data[t].answers[c].answer});for(c=0;c<this.data[t].clues.length;++c)u.push({clue:this.data[t].clues[c].clue});this.data.splice(t+1,0,{answers:l,answersNumber:this.data[t].answersNumber,clues:u,cluesNumber:this.data[t].cluesNumber,onGuess:this.data[t].onGuess,changeSectionWhenWrong:this.data[t].changeSectionWhenWrong,onWrong:this.data[t].onWrong,component:"CompleteClues",componentName:"Pistas"})}else"CustomBox"===this.data[t].component&&("write"===this.data[t].mode?this.data.splice(this.lastPress+1,0,{name:this.data[t].name,mode:"read",type:this.data[t].type,value:"",defaultValue:this.data[t].defaultValue,title:this.data[t].title,prevText:"",nextText:"",component:"CustomBox",componentName:"Casilla personalizada"}):this.data.splice(this.lastPress+1,0,{name:this.data[t].name,mode:this.data[t].mode,type:this.data[t].type,value:"",defaultValue:this.data[t].defaultValue,title:this.data[t].title,prevText:this.data[t].prevText,nextText:this.data[t].nextText,component:"CustomBox",componentName:"Casilla personalizada"}))},auxUpdateBookSections:function(t){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.updateBookSections(t));case 2:case"end":return e.stop()}}),null,this)},updateBookSections:function(t){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return this.book.sections=t,e.next=3,regeneratorRuntime.awrap(v.doc(this.book.ID).update({sections:t}));case 3:case"end":return e.stop()}}),null,this)},addNormal:function(){this.data.splice(this.lastPress+1,0,{htmlText:"",component:"Normal",componentName:"Texto normal"})},addTitle:function(){this.data.splice(this.lastPress+1,0,{plainText:"",htmlText:"<h1></h1>",component:"Header1",componentName:"Título"})},addExandableText:function(){this.data.splice(this.lastPress+1,0,{mainText:"",expandedText:"",component:"ExpandableText",componentName:"Texto expandible"})},addPopupText:function(){this.data.splice(this.lastPress+1,0,{mainText:"",popupText:"",htmlText:"",picture:"",component:"PopupText",componentName:"Anotación"})},addHyperlink:function(){this.data.splice(this.lastPress+1,0,{mainText:"",htmlText:"",hyperlinkText:"",component:"Hyperlink",componentName:"Hipervínculo"})},addSpoiler:function(){this.data.splice(this.lastPress+1,0,{plainText:"",htmlText:"<span></span>",component:"Spoiler",componentName:"Spoiler"})},addPicture:function(){this.data.splice(this.lastPress+1,0,{htmlText:"",url:"",component:"Picture",componentName:"Imagen"})},addVideo:function(){this.data.splice(this.lastPress+1,0,{htmlText:"",url:"",autoplay:"false",loop:"false",component:"Video",componentName:"Vídeo"})},addSectionChange:function(){this.sectionsData.length>1?this.data.splice(this.lastPress+1,0,{plainText:"",htmlText:"<span></span>",next:this.sectionsData[0].value,component:"ChangeSection",componentName:"Cambio de sección"}):window.alert("Para añadir un cambio de sección debes tener más de una sección creada")},addSectionRepeat:function(){this.data.splice(this.lastPress+1,0,{plainText:"",htmlText:"<span></span>",component:"RepeatSection",componentName:"Repetición de sección"})},addDecisionMaking:function(){this.sectionsData.length>1?this.data.splice(this.lastPress+1,0,{choices:[{plainText:"",htmlText:"<span></span>",choice:"Section",action:this.sectionsData[0].value},{plainText:"",htmlText:"<span></span>",choice:"Section",action:this.sectionsData[0].value}],numberOfOptions:2,component:"DecisionMaking",componentName:"Toma de decisiones"}):window.alert("Para añadir una toma de decisiones debes tener más de una sección creada")},addRiddle:function(){this.sectionsData.length>1?this.data.splice(this.lastPress+1,0,{changeSectionWhenWrong:!1,riddleText:"",answerText:"",rightSection:this.sectionsData[0].value,wrongSection:"",numberOfTries:"1",component:"Riddle",componentName:"Adivinanza"}):window.alert("Para añadir una adivinanza debes tener más de una sección creada")},addSequence:function(){this.sectionsData.length>1?this.data.splice(this.lastPress+1,0,{numberOfTries:1,sequence:[{text:""}],solution:[{text:""}],changeSectionWhenWrong:!1,wrongSection:"",rightSection:this.sectionsData[0].value,component:"Sequence",componentName:"Secuencia"}):window.alert("Para añadir una secuencia debes tener más de una sección creada")},addRandomNumber:function(){this.data.splice(this.lastPress+1,0,{lowerLimit:0,upperLimit:10,conditions:[],numberOfConditions:0,component:"RandomNumber",componentName:"Número aleatorio"})},addMemoryCards:function(){this.data.splice(this.lastPress+1,0,{numberOfPairs:2,maxNumberOfMoves:6,sectionNoMoreMoves:"",sectionSolved:"",changeSectionWhenWrong:!1,customized:!1,typeChosen:"",customWords:[],customColors:[],component:"MemoryCards",componentName:"Tarjetas de memoria"})},addClues:function(){this.data.splice(this.lastPress+1,0,{answers:[{answer:""}],answersNumber:1,clues:[{clue:""}],cluesNumber:1,onGuess:this.sectionsData[0].value,changeSectionWhenWrong:!1,onWrong:"",component:"CompleteClues",componentName:"Pistas"})},addCustomBox:function(){this.data.splice(this.lastPress+1,0,{name:"",mode:"write",type:"string",value:"",defaultValue:"",title:"",prevText:"",nextText:"",component:"CustomBox",componentName:"Casilla personalizada"})},checkStyles:function(){if(-1===this.lastPress)this.lastPress=0;else if(void 0===this.data[this.lastPress].component)return;"Normal"===this.data[this.lastPress].component&&(document.queryCommandState("Bold")?this.changeButtons("Bold",1):this.changeButtons("Bold",-1),document.queryCommandState("Italic")?this.changeButtons("Italic",1):this.changeButtons("Italic",-1),document.queryCommandState("Underline")?this.changeButtons("Underline",1):this.changeButtons("Underline",-1),document.queryCommandState("StrikeThrough")?this.changeButtons("StrikeThrough",1):this.changeButtons("StrikeThrough",-1)),"Header1"===this.data[this.lastPress].component?this.changeButtons("Header1",1):this.changeButtons("Header1",0),"Header2"===this.data[this.lastPress].component?this.changeButtons("Header2",1):this.changeButtons("Header2",0),"Header3"===this.data[this.lastPress].component?this.changeButtons("Header3",1):this.changeButtons("Header3",0)},checkDelete:function(t){this.data.splice(t,1)},lastElementPressed:function(t){this.lastPress=t},onLiveEditComponent:function(t,e){t.preventDefault(),-1===this.lastPress&&(this.lastPress=0);var i=this.data[this.lastPress].component;"Normal"===i?("Bold"===e&&(this.boldActive<=0?(this.boldActive=1,this.boldUse=!0):(this.boldActive=0,this.boldUse=!1)),"Italic"===e&&(this.italicActive<=0?(this.italicActive=1,this.italicUse=!0):(this.italicActive=0,this.italicUse=!1)),"Underline"===e&&(this.underlineActive<=0?(this.underlineActive=1,this.underlineUse=!0):(this.underlineActive=0,this.underlineUse=!1)),"StrikeThrough"===e&&(this.strikeThroughActive<=0?(this.strikeThroughActive=1,this.strikeThroughUse=!0):(this.strikeThroughActive=0,this.strikeThroughUse=!1))):"Header1"!==i&&"Header2"!==i&&"Header3"!==i||("Header1"===e?(this.data[this.lastPress].component="Header1",this.header1Active=1,this.header2Active=0,this.header3Active=0):"Header2"===e?(this.data[this.lastPress].component="Header2",this.header1Active=0,this.header2Active=1,this.header3Active=0):"Header3"===e&&(this.data[this.lastPress].component="Header3",this.header1Active=0,this.header2Active=0,this.header3Active=1))},changeButtons:function(t,e){"Bold"===t&&(e>0&&this.boldActive!==e&&!1===this.boldUse?(this.boldActive=e,this.boldUse=!0):e<0&&this.boldActive!==e&&!0===this.boldUse&&(this.boldUse=!1,this.boldActive=e)),"Italic"===t&&(e>0&&this.italicActive!==e&&!1===this.italicUse?(this.italicActive=e,this.italicUse=!0):e<0&&this.italicActive!==e&&!0===this.italicUse&&(this.italicUse=!1,this.italicActive=e)),"Underline"===t&&(e>0&&this.underlineActive!==e&&!1===this.underlineUse?(this.underlineActive=e,this.underlineUse=!0):e<0&&this.underlineActive!==e&&!0===this.underlineUse&&(this.underlineUse=!1,this.underlineActive=e)),"StrikeThrough"===t&&(e>0&&this.strikeThroughActive!==e&&!1===this.strikeThroughUse?(this.strikeThroughActive=e,this.strikeThroughUse=!0):e<0&&this.strikeThroughActive!==e&&!0===this.strikeThroughUse&&(this.strikeThroughUse=!1,this.strikeThroughActive=e)),"Header1"===t&&(this.header1Active=e),"Header2"===t&&(this.header2Active=e),"Header3"===t&&(this.header3Active=e)},checkRead:function(t){if(""!==t)for(var e=!1,i=0;i<this.temporalCustomBoxes.length&&!e;++i)this.temporalCustomBoxes[i].name===t&&(this.temporalCustomBoxes.splice(i,1),e=!0)},checkWrite:function(t,e,i,n){""!==t&&this.temporalCustomBoxes.push({name:t,type:e,value:i,defaultValue:n})},checkUpdate:function(t,e,i,n,s){for(var a=!1,o=0;o<this.temporalCustomBoxes.length&&!a;++o)if(this.temporalCustomBoxes[o].name===t){var r={name:e,type:i,value:n,defaultValue:s};this.$set(this.temporalCustomBoxes,o,r),a=!0}},auxDeleteCustomBoxes:function(t){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.deleteCustomBoxes(t));case 2:case"end":return e.stop()}}),null,this)},deleteCustomBoxes:function(t){var e;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:for(e=0;e<t.length;++e)"CustomBox"===t[e].component&&"write"===t[e].mode&&this.checkRead(t[e].name);return i.next=3,regeneratorRuntime.awrap(this.silentSave());case 3:case"end":return i.stop()}}),null,this)},openManagementSectionModal:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:if(t=!this.showManagementSectionModal,!t){e.next=4;break}return e.next=4,regeneratorRuntime.awrap(this.save());case 4:this.showManagementSectionModal=t;case 5:case"end":return e.stop()}}),null,this)},auxSave:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.save());case 2:case"end":return t.stop()}}),null,this)},save:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:if(this.saving=!0,""===this.sectionName){t.next=6;break}return t.next=4,regeneratorRuntime.awrap(this.silentSave());case 4:t.next=7;break;case 6:window.alert("Para guardar una sección, debes darla un nombre primero");case 7:this.saving=!1;case 8:case"end":return t.stop()}}),null,this)},silentSave:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(g.doc(this.sectionID).update({gadgets:this.data}));case 2:return t.next=4,regeneratorRuntime.awrap(v.doc(this.bookID).update({customBoxes:this.temporalCustomBoxes}));case 4:case"end":return t.stop()}}),null,this)},saveExpandableText:function(t,e,i){this.data[i].mainText=t,this.data[i].expandedText=e},savePopupText:function(t,e,i,n,s){this.data[s].mainText=t,this.data[s].popupText=e,this.data[s].htmlText=i,this.data[s].picture=n},saveHyperlink:function(t,e,i,n){this.data[n].htmlText=t,this.data[n].mainText=e,this.data[n].hyperlinkText=i},saveHTMLPicture:function(t,e,i){this.data[i].htmlText=t,this.data[i].url=e},saveHTMLVideo:function(t,e,i,n,s){this.data[s].htmlText=t,this.data[s].url=e,this.data[s].autoplay=i,this.data[s].loop=n},saveHTML:function(t,e){this.data[e].htmlText=t},savePlaneAndHTML:function(t,e,i){this.data[i].plainText=t,this.data[i].htmlText=e},saveHTMLAndSection:function(t,e,i,n){this.data[n].htmlText=t,this.data[n].plainText=e,this.data[n].next=i},saveChoices:function(t,e,i){this.data[i].choices=t,this.data[i].numberOfOptions=e},saveHTMLRiddle:function(t,e,i,n,s,a,o){this.data[o].riddleText=e,this.data[o].answerText=i,this.data[o].changeSectionWhenWrong=t,this.data[o].rightSection=n,this.data[o].wrongSection=s,this.data[o].numberOfTries=a},saveSequence:function(t,e,i,n,s,a,o){this.data[o].sequence=t,this.data[o].solution=e,this.data[o].changeSectionWhenWrong=i,this.data[o].wrongSection=n,this.data[o].rightSection=s,this.data[o].numberOfTries=a},saveRandomNumbers:function(t,e,i,n,s){this.data[s].conditions=t,this.data[s].numberOfConditions=e,this.data[s].lowerLimit=i,this.data[s].upperLimit=n},saveMemoryCards:function(t,e,i,n,s,a,o,r,c,l){this.data[l].numberOfPairs=t,this.data[l].maxNumberOfMoves=e,this.data[l].sectionNoMoreMoves=i,this.data[l].sectionSolved=n,this.data[l].changeSectionWhenWrong=s,this.data[l].customized=a,this.data[l].typeChosen=o,this.data[l].customWords=r,this.data[l].customColors=c},saveClues:function(t,e,i,n,s,a,o,r){this.data[r].answers=t,this.data[r].answersNumber=e,this.data[r].clues=i,this.data[r].cluesNumber=n,this.data[r].onGuess=s,this.data[r].changeSectionWhenWrong=a,this.data[r].onWrong=o},saveCustomBox:function(t,e,i,n,s,a,o,r,c){this.data[c].name=t,this.data[c].mode=e,this.data[c].type=i,this.data[c].value=n,this.data[c].defaultValue=s,this.data[c].title=a,this.data[c].prevText=o,this.data[c].nextText=r},saveLimitedCustomBox:function(t,e,i,n,s){this.data[s].mode=t,this.data[s].type=e,this.data[s].value=i,this.data[s].defaultValue=n},sectionPreview:function(){this.save(),this.showPreviewSection=!1,A.commit("changeSection",this.sectionID),A.commit("switchSectionPreview",!0),this.$router.push({name:"readBook"})},changeSection:function(t){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.save());case 2:this.refresh(t);case 3:case"end":return e.stop()}}),null,this)},goBack:function(){this.$router.replace({name:"readBook"})},goBackAndSave:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.save());case 2:this.goBack();case 3:case"end":return t.stop()}}),null,this)}}},En=zn,Rn=(i("7371"),Object(_["a"])(En,le,ue,!1,null,"23dd5978",null)),Wn=Rn.exports,$n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("LoadingModal"):t._e(),i("div",{staticClass:"buttons"},[i("div",{staticClass:"row d-flex justify-content-start"},[i("h3",{staticStyle:{"padding-top":"15px","text-align":"left"}},[i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"16px"},attrs:{variant:"light",title:"Volver"},on:{click:function(e){return t.goBack()}}},[i("b-icon",{attrs:{icon:"chevron-left"}})],1),t._v(" "+t._s(t.book.title)+" "),t.isBookOfLoggedUser()&&t.isNotPreview()?i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"16px"},attrs:{variant:"light",title:"Editar libro",disabled:!0===t.book.published},on:{click:function(e){return t.goEdit()}}},[i("b-icon",{attrs:{icon:"pencil"}})],1):t._e(),t.isBookOfLoggedUser()&&t.isNotPreview()?i("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticStyle:{"font-size":"16px"},attrs:{variant:"light",title:"Publicar"},on:{click:function(e){t.togglePublic(),t.showInfoModal()}}},[t.book.published?i("b-icon",{attrs:{icon:"eye"}}):i("b-icon",{attrs:{icon:"eye-slash"}})],1):t._e()],1)]),t.isBookOfLoggedUser()&&!0===t.book.published?i("span",{staticStyle:{color:"red","padding-left":"10px"}},[t._v("No se puede editar un libro si este se encuentra publicado")]):t._e()]),i("b-form-select",{staticClass:"section",staticStyle:{"max-width":"500px"},attrs:{options:t.sectionsData},on:{change:function(e){return t.loadSection(t.currentSectionID)}},model:{value:t.currentSectionID,callback:function(e){t.currentSectionID=e},expression:"currentSectionID"}}),t.emptyBook()&&t.sectionExists?i("div",[i("h4",[t._v("Sección vacía")])]):!t.emptyBook()&&t.sectionExists?i("div",{staticClass:"readBook"},t._l(t.sectionGadgets,(function(e,n){return i("div",{key:n},[t.basicGadget(e)?i("span",{staticStyle:{"word-wrap":"break-word"},domProps:{innerHTML:t._s(e.htmlText)}}):t._e(),"ChangeSection"===e.component&&t.book.sections.length>1?i("ChangeSectionReading",{attrs:{htmlText:e.htmlText,next:e.next},on:{change:t.loadSection}}):t._e(),"RepeatSection"===e.component?i("RepeatSectionReading",{attrs:{htmlText:e.htmlText,actual:t.currentSectionID},on:{change:t.loadSection}}):t._e(),"DecisionMaking"===e.component&&t.book.sections.length>1?i("DecisionMakingReading",{attrs:{choices:e.choices},on:{chose:t.loadSection}}):t._e(),"Riddle"===e.component&&t.book.sections.length>1?i("RiddleReading",{attrs:{numberOfTriesAux:e.numberOfTries,riddleText:e.riddleText,answerText:e.answerText,wrongSection:e.wrongSection,rightSection:e.rightSection},on:{answered:t.loadSection}}):t._e(),"RandomNumber"===e.component?i("RandomNumberReading",{attrs:{lowerLimit:e.lowerLimit,upperLimit:e.upperLimit,conditions:e.conditions},on:{change:t.loadSection}}):t._e(),"Sequence"===e.component?i("SequenceReading",{attrs:{numberOfTriesAux:e.numberOfTries,sequence:e.sequence,solution:e.solution,rightSection:e.rightSection,wrongSection:e.wrongSection,changeSectionWhenWrong:e.changeSectionWhenWrong},on:{answered:t.loadSection}}):t._e(),"ExpandableText"===e.component?i("ExpandableTextReading",{attrs:{mainText:e.mainText,expandedText:e.expandedText}}):t._e(),"PopupText"===e.component?i("PopupTextReading",{attrs:{mainText:e.mainText,popupText:e.popupText,htmlText:e.htmlText}}):t._e(),"MemoryCards"===e.component?i("MemoryCardsReading",{attrs:{numberOfPairs:e.numberOfPairs,maxNumberOfMoves:e.maxNumberOfMoves,sectionNoMoreMoves:e.sectionNoMoreMoves,sectionSolved:e.sectionSolved,changeSectionWhenWrong:e.changeSectionWhenWrong,customized:e.customized,typeChosen:e.typeChosen,customWords:e.customWords,customColors:e.customColors},on:{answered:t.loadSection}}):t._e(),"Spoiler"===e.component?i("SpoilerReading",{attrs:{htmlTextAux:e.htmlText}}):t._e(),"CompleteClues"===e.component?i("CompleteCluesReading",{attrs:{clues:e.clues,answers:e.answers,changeSectionWhenWrong:e.changeSectionWhenWrong,onGuess:e.onGuess,onWrong:e.onWrong},on:{answered:t.loadSection}}):t._e(),"CustomBox"===e.component&&""!=e.name?i("CustomBoxesReading",{staticStyle:{"min-height":"24px"},attrs:{name:e.name,mode:e.mode,type:e.type,value:e.value,defaultValue:e.defaultValue,title:e.title,prevText:e.prevText,nextText:e.nextText,customBoxes:t.customBoxes},on:{saveWrite:t.saveCustomBox}}):t._e()],1)})),0):i("div",[i("h1",[t._v("Vaya, parece que la sección a la que intentas acceder no existe :-(")])]),i("b-modal",{attrs:{"hide-header":"","hide-footer":"",centered:"","no-close-on-backdrop":""},model:{value:t.showInfoPublic,callback:function(e){t.showInfoPublic=e},expression:"showInfoPublic"}},[i("p",[t._v("Al publicar el libro este se vuelve visible para todo el mundo. Esta opción se puede cambiar cuando se quiera.")]),i("div",{staticClass:"d-flex justify-content-center"},[i("b-button",{staticStyle:{"font-size":"16px",width:"150px"},attrs:{size:"sm",variant:"success"},on:{click:function(e){t.showInfoPublic=!1}}},[t._v("Aceptar")])],1)])],1)},jn=[],qn=(i("d28b"),i("3ca3"),i("ddb0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"d-flex justify-content-start"},[i("span",{staticClass:"clickable",domProps:{innerHTML:t._s(t.htmlText)},on:{click:function(e){return t.change()}}}),i("span",[13!==t.htmlText.length?i("b-icon",{staticClass:"h4 clickable",staticStyle:{"margin-left":"10px"},attrs:{variant:"info",icon:"box-arrow-right"},on:{click:function(e){return t.change()}}}):i("b-icon",{staticClass:"h4 clickable",attrs:{variant:"info",icon:"box-arrow-right"},on:{click:function(e){return t.change()}}})],1)])])}),Un=[],Hn={name:"changeSectionReading",props:{htmlText:String,next:String},methods:{change:function(){this.$emit("change",this.next)}}},Vn=Hn,Fn=(i("31b2"),Object(_["a"])(Vn,qn,Un,!1,null,"2551cfe8",null)),Gn=Fn.exports,Kn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex justify-content-start"},[i("span",{staticClass:"clickable",domProps:{innerHTML:t._s(t.htmlText)},on:{click:function(e){return t.change()}}}),i("span",[13!==t.htmlText.length?i("b-icon",{staticClass:"h4 clickable",staticStyle:{"margin-left":"10px"},attrs:{variant:"info",icon:"arrow-repeat"},on:{click:function(e){return t.change()}}}):i("b-icon",{staticClass:"h4 clickable",attrs:{variant:"info",icon:"arrow-repeat"},on:{click:function(e){return t.change()}}})],1)])},Jn=[],Xn={name:"repeatSectionReading",props:{htmlText:String,actual:String},methods:{change:function(){this.$emit("change",this.actual)}}},Zn=Xn,Qn=(i("7a4b"),Object(_["a"])(Zn,Kn,Jn,!1,null,"c63e4e2e",null)),Yn=Qn.exports,ts=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"15px"}},[i("b-form-radio-group",{attrs:{options:t.options,stacked:""},on:{change:t.change},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)},es=[],is={name:"decisionMakingReading",props:{choices:Array},data:function(){return{selected:"",options:[]}},mounted:function(){this.refresh()},methods:{refresh:function(){this.options=[];for(var t=0;t<this.choices.length;++t)this.options.push({value:this.choices[t].action,html:this.choices[t].htmlText})},change:function(t){this.$emit("chose",t)}}},ns=is,ss=Object(_["a"])(ns,ts,es,!1,null,null,null),as=ss.exports,os=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-card",[i("p",[t._v(" "+t._s(t.riddleText))]),i("div",{staticClass:"d-flex"},[i("b-form-input",{staticStyle:{"margin-top":"5px"},attrs:{trim:"",formatter:t.formatAnswer,placeholder:"Respuesta"},model:{value:t.tryText,callback:function(e){t.tryText=e},expression:"tryText"}}),t.tryText.length>24?i("span",{staticStyle:{color:"red"}},[t._v("Estas cerca del limite de caracteres, llevas "+t._s(this.tryText.length)+" /30")]):t._e(),i("b-button",{staticStyle:{width:"150px","font-size":"16px"},attrs:{disabled:0===t.numberOfTries,variant:"primary",block:""},on:{click:function(e){return t.tryAnswer()}}},[t._v("Probar")])],1),!1===t.correctPreview?i("span",{staticStyle:{color:"red"}},[t._v(" ¡Has fallado! ")]):!0===t.correctPreview?i("span",{staticStyle:{color:"green"}},[t._v(" ¡Has acertado! ")]):t._e(),i("span",{staticStyle:{"font-size":"14px"}},[t._v(" Te quedan "+t._s(t.numberOfTries)+" intentos")]),""!=t.text?i("b",[t._v(" "+t._s(t.text)+" ")]):t._e()])],1)},rs=[],cs={name:"riddleReading",props:{numberOfTriesAux:String,riddleText:String,answerText:String,wrongSection:String,rightSection:String},data:function(){return{tryText:"",numberOfTries:parseInt(this.numberOfTriesAux,10),correctPreview:null,text:""}},methods:{tryAnswer:function(){var t=this;this.numberOfTries>0&&(this.numberOfTries--,this.tryText===this.answerText?(this.correctPreview=!0,setTimeout((function(){t.$emit("answered",t.rightSection)}),700)):(this.correctPreview=!1,0===this.numberOfTries&&""!==this.wrongSection?(setTimeout((function(){t.$emit("answered",t.wrongSection)}),700),this.correctPreview=null):0===this.numberOfTries&&""===this.wrongSection&&(this.text="¡Sigue leyendo!")))},formatMaxRiddle:function(t){return String(t).substring(0,2e3)},formatAnswer:function(t){var e=String(t).substring(0,30);return e.toLowerCase()}}},ls=cs,us=Object(_["a"])(ls,os,rs,!1,null,null,null),ds=us.exports,hs=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"15px"}},[t.pressed?i("span",[t._v("El número generado es "+t._s(this.number))]):i("b-button",{staticStyle:{"font-size":"16px"},attrs:{variant:"outline-info"},on:{click:function(e){t.generateRandom(),t.processConditions()}}},[i("b-icon",{attrs:{icon:"question-diamond"}})],1)],1)},ms=[],ps={name:"randomNumberReading",props:{lowerLimit:Number,upperLimit:Number,conditions:Array},data:function(){return{number:"",pressed:!1}},methods:{generateRandom:function(){this.number=Math.floor(Math.random()*(this.upperLimit-this.lowerLimit+1)+this.lowerLimit),this.number=parseInt(this.number,10),this.pressed=!0},processConditions:function(){var t=this;setTimeout((function(){for(var e=0;e<t.conditions.length;++e)">"===t.conditions[e].condition?t.number>t.conditions[e].number&&t.$emit("change",t.conditions[e].section):">="===t.conditions[e].condition?t.number>=t.conditions[e].number&&t.$emit("change",t.conditions[e].section):"<"===t.conditions[e].condition?t.number<t.conditions[e].number&&t.$emit("change",t.conditions[e].section):"<="===t.conditions[e].condition?t.number<=t.conditions[e].number&&t.$emit("change",t.conditions[e].section):"=="===t.conditions[e].condition&&t.number===t.conditions[e].number&&t.$emit("change",t.conditions[e].section)}),1200)}}},fs=ps,bs=Object(_["a"])(fs,hs,ms,!1,null,null,null),vs=bs.exports,xs=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("p",{staticStyle:{cursor:"pointer"},on:{click:function(e){t.show=!t.show}}},[t._v(t._s(t.mainText)+" "),t.show?i("b-icon",{attrs:{icon:"caret-up-fill"}}):i("b-icon",{attrs:{icon:"caret-down-fill"}})],1),i("p",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"container"},[t._v(t._s(t.expandedText))])])},gs=[],ws={name:"expandableTextReading",props:{mainText:String,expandedText:String},data:function(){return{show:!1}}},ys=ws,ks=(i("eb8f"),Object(_["a"])(ys,xs,gs,!1,null,"d1c19bd4",null)),Ss=ks.exports,_s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("span",[t._v(t._s(t.mainText)),i("span",{staticStyle:{cursor:"pointer",color:"#0a8df4"},on:{click:function(e){t.openPopupTextModal=!t.openPopupTextModal}}},[t._v(" [...]")])]),i("b-modal",{attrs:{"hide-footer":"","hide-header":"",scrollable:"",centered:""},model:{value:t.openPopupTextModal,callback:function(e){t.openPopupTextModal=e},expression:"openPopupTextModal"}},[i("p",[t._v(t._s(t.popupText))]),i("div",{domProps:{innerHTML:t._s(t.htmlText)}})])],1)},Cs=[],Ts={name:"popupTextReading",props:{mainText:String,popupText:String,htmlText:String},data:function(){return{openPopupTextModal:!1}}},Ps=Ts,Ns=Object(_["a"])(Ps,_s,Cs,!1,null,null,null),Os=Ns.exports,Ds=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-top":"20px","margin-bottom":"20px"}},[i("h5",[t._v("Completa la secuencia: ")]),i("div",{staticClass:"d-block text-center"},[i("div",[i("div",{staticClass:"row"},t._l(t.sequence,(function(e,n){return i("span",{key:n,staticStyle:{"margin-right":"10px","margin-left":"10px","font-size":"22px"}},[t._v(" "+t._s(e.text)+" ")])})),0),i("div",{staticClass:"d-flex"},[t._l(t.solution,(function(e,n){return i("b-form-input",{key:n,staticStyle:{"margin-top":"5px","margin-right":"5px","margin-left":"5px",width:"115px"},attrs:{trim:"",formatter:t.limit,placeholder:"Respuesta"},model:{value:t.answers[n],callback:function(e){t.$set(t.answers,n,e)},expression:"answers[index]"}})})),i("b-button",{staticStyle:{width:"100px","font-size":"16px"},attrs:{disabled:0===t.numberOfTries||t.answers.length!==t.solution.length,variant:"primary",block:""},on:{click:function(e){return t.confirm()}}},[t._v("Probar")])],2)]),!1===t.correctPreview?i("span",{staticStyle:{color:"red"}},[t._v(" ¡Has fallado! ")]):!0===t.correctPreview?i("span",{staticStyle:{color:"green"}},[t._v(" ¡Has acertado! ")]):t._e(),i("span",[t._v(" Te quedan "+t._s(t.numberOfTries)+" intentos")]),i("br"),0===t.numberOfTries&&!1===t.changeSectionWhenWrong?i("b",[t._v("¡Sigue leyendo!")]):t._e()])])},As=[],Ls={name:"sequenceReading",props:{numberOfTriesAux:Number,sequence:Array,solution:Array,rightSection:String,wrongSection:String,changeSectionWhenWrong:Boolean},data:function(){return{numberOfTries:this.numberOfTriesAux,answers:[],correctPreview:null}},methods:{confirm:function(){var t=this;if(this.numberOfTries>0){this.numberOfTries--;for(var e=!0,i=0;i<this.solution.length;++i)this.answers[i]!==this.solution[i].text&&(e=!1);!0===e?(this.correctPreview=!0,setTimeout((function(){t.$emit("answered",t.rightSection)}),700)):(this.correctPreview=!1,this.answers=[],0===this.numberOfTries&&!0===this.changeSectionWhenWrong&&(this.correctPreview=null,setTimeout((function(){t.$emit("answered",t.wrongSection)}),700)))}},limit:function(t){return String(t).substring(0,20)}}},Ms=Ls,Bs=Object(_["a"])(Ms,Ds,As,!1,null,null,null),Is=Bs.exports,zs=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h5",[t._v("Tarjetas de memoria")]),i("p",[t._v("¡Intenta emparejar todas las tarjetas!")]),!0===t.customized&&"words"===t.typeChosen?i("b-row",{staticStyle:{"margin-left":"15px"}},t._l(t.cards,(function(e,n){return i("div",{key:n},[!1===e.flipped?i("b-button",{staticClass:"card-text",staticStyle:{"margin-bottom":"10px"},attrs:{disabled:2===t.numberOfCardsFlipped||t.numberOfMoves===t.maxNumberOfMoves},on:{click:function(e){return t.flipCard(n)}}}):i("b-button",{staticClass:"memory-card-text",staticStyle:{"margin-bottom":"10px","font-weight":"bold","font-size":"20px"},attrs:{variant:"info"}},[t._v(t._s(e.text))])],1)})),0):i("b-row",{staticStyle:{"margin-left":"15px"}},t._l(t.cards,(function(e,n){return i("div",{key:n},[!1===e.flipped?i("b-button",{staticClass:"card-color",attrs:{disabled:2===t.numberOfCardsFlipped||t.numberOfMoves===t.maxNumberOfMoves},on:{click:function(e){return t.flipCard(n)}}}):i("b-button",{staticClass:"memory-card-color",style:e.color})],1)})),0),t.numberOfMoves===t.maxNumberOfMoves&&this.numberOfPairsMissing>0?i("p",{staticStyle:{color:"red"}},[t._v("Te has quedado sin movimientos :(")]):i("p",[t._v("Llevas "+t._s(t.numberOfMoves)+" movimientos de "+t._s(t.maxNumberOfMoves)+" disponibles! Te quedan "+t._s(t.maxNumberOfMoves-t.numberOfMoves)+"!! ")]),!0===t.solved?i("p",{staticStyle:{color:"green"}},[t._v("¡Has resuelto el puzzle!")]):t._e(),t.numberOfMoves===t.maxNumberOfMoves&&this.numberOfPairsMissing>0&&!1===t.changeSectionWhenWrong?i("b",[t._v("¡Sigue leyendo!")]):t._e()],1)},Es=[],Rs={name:"memoryCardsReading",props:{numberOfPairs:Number,maxNumberOfMoves:Number,sectionNoMoreMoves:String,sectionSolved:String,changeSectionWhenWrong:Boolean,customized:Boolean,typeChosen:String,customWords:Array,customColors:Array},data:function(){return{cardTypes:[{color:"#4CAF50"},{color:"#008CBA"},{color:"#FF9713"},{color:"#EE2A1C"},{color:"#A97FCB"},{color:"#F12CDF"},{color:"#18FCC5"},{color:"#5E22F1"},{color:"#F0A899"},{color:"#074F1D"},{color:"#5F380A"},{color:"#DEF122"}],cards:[],numberOfCardsFlipped:0,cardClickedBefore:"",numberOfPairsMissing:this.numberOfPairs,numberOfMoves:0,solved:!1}},mounted:function(){this.shuffleCards()},methods:{shuffleCards:function(){for(var t=0;t<2*this.numberOfPairs;++t)this.cards.push({color:"",flipped:Boolean,text:"",value:0});var e=1,i=0;while(i<2*this.numberOfPairs){var n=Math.floor(Math.random()*(2*this.numberOfPairs));0===this.cards[n].value&&(this.customized&&"words"===this.typeChosen?this.cards[n].text=this.customWords[i]:this.customized&&"color"===this.typeChosen?this.cards[n].color="background-color: "+this.customColors[e-1]+";":this.cards[n].color="background-color: "+this.cardTypes[e-1].color+";",this.cards[n].flipped=!1,this.cards[n].value=e,i++,i%2===0&&e++)}},flipCard:function(t){var e=this;this.numberOfCardsFlipped++,this.cards[t].flipped=!this.cards[t].flipped,this.numberOfMoves++,1===this.numberOfCardsFlipped&&(this.cardClickedBefore=t),2===this.numberOfCardsFlipped&&this.cards[t].value===this.cards[this.cardClickedBefore].value&&(this.numberOfCardsFlipped=0,this.numberOfPairsMissing--,0===this.numberOfPairsMissing&&(this.solved=!0),setTimeout((function(){0===e.numberOfPairsMissing&&e.checkAnswer()}),700)),this.numberOfMoves===this.maxNumberOfMoves&&this.numberOfPairsMissing>0&&this.checkAnswer(),2===this.numberOfCardsFlipped&&this.cards[this.cardClickedBefore].value!==this.cards[t].value&&setTimeout((function(){e.refresh(t)}),1e3)},refresh:function(t){this.cards[t].flipped=!1,this.cards[this.cardClickedBefore].flipped=!1,this.numberOfCardsFlipped=0},checkAnswer:function(){var t=this;""!==this.sectionSolved&&(!0===this.solved?setTimeout((function(){t.$emit("answered",t.sectionSolved)}),700):!0===this.changeSectionWhenWrong&&setTimeout((function(){t.$emit("answered",t.sectionNoMoreMoves)}),700))}}},Ws=Rs,$s=(i("f6ff"),Object(_["a"])(Ws,zs,Es,!1,null,null,null)),js=$s.exports,qs=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"spoiler",staticStyle:{"word-wrap":"break-word"},domProps:{innerHTML:t._s(t.htmlTextAux)}})},Us=[],Hs={name:"spoiler",props:{htmlTextAux:String}},Vs=Hs,Fs=(i("389d"),Object(_["a"])(Vs,qs,Us,!1,null,"5c7472ce",null)),Gs=Fs.exports,Ks=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"15px","margin-top":"15px"}},[t._l(t.data,(function(e,n){return i("div",{key:n,staticStyle:{"min-width":"200px",width:"200px","margin-top":"10px"}},[t.valid?i("b-form-select",{attrs:{options:t.options,size:"sm"},model:{value:t.data[n],callback:function(e){t.$set(t.data,n,e)},expression:"data[index]"}}):i("b-form-select",{attrs:{disabled:"",options:t.options,size:"sm"},model:{value:t.data[n],callback:function(e){t.$set(t.data,n,e)},expression:"data[index]"}})],1)})),i("p",{staticStyle:{"font-size":"14px"}},[t._v("Selecciona las repuestas correctas y pulsa solucionar")]),t.valid?i("b-button",{attrs:{variant:"outline-dark"},on:{click:function(e){return t.check()}}},[t._v("Solucionar")]):i("span",[t._v("Sigue leyendo!")])],2)},Js=[],Xs={name:"randomNumberReading",props:{clues:Array,answers:Array,changeSectionWhenWrong:Boolean,onGuess:String,onWrong:String},data:function(){return{data:[],options:[],valid:!0}},mounted:function(){this.data=[],this.options=[],this.valid=!0;for(var t=0;t<this.clues.length;++t)this.options.push({value:this.clues[t].clue,text:this.clues[t].clue});for(var e=0;e<this.answers.length;++e)this.data.push(this.clues[0].clue)},methods:{check:function(){for(var t=!1,e=0;e<this.answers.length&&!t;++e)this.answers[e].answer!==this.data[e]&&(t=!0);t?t&&this.changeSectionWhenWrong?this.$emit("answered",this.onWrong):t&&!this.changeSectionWhenWrong&&(this.valid=!1):this.$emit("answered",this.onGuess)}}},Zs=Xs,Qs=Object(_["a"])(Zs,Ks,Js,!1,null,null,null),Ys=Qs.exports,ta=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.valid?i("div",["read"==t.mode?i("div",[i("span",[t._v(t._s(t.prevText))]),i("span",{staticClass:"textColor"},[t._v(t._s(t.valueShow))]),i("span",[t._v(t._s(t.nextText))])]):"write"==t.mode||"modifyWrite"==t.mode?i("div",{staticClass:"write"},[i("br"),i("b-row",[i("b-col",{staticStyle:{"margin-bottom":"3px"},attrs:{cols:"3"}},[i("span",[t._v(" "+t._s(t.title)+": ")])]),i("b-col",{attrs:{cols:"6"}},["string"==t.type?i("b-form-input",{attrs:{placeholder:t.defaultValue,formatter:t.formatString,size:"sm"},nativeOn:{input:function(e){return t.updateValue(e)}},model:{value:t.writeVar,callback:function(e){t.writeVar=e},expression:"writeVar"}}):"number"==t.type?i("b-form-input",{attrs:{type:"number",placeholder:t.defaultValue,formatter:t.formatNumber,size:"sm"},nativeOn:{input:function(e){return t.updateValue(e)}},model:{value:t.writeVar,callback:function(e){t.writeVar=e},expression:"writeVar"}}):t._e()],1)],1),i("br")],1):t._e()]):t._e()},ea=[],ia={name:"customBoxReading",props:{name:String,mode:String,type:String,value:String,defaultValue:String,title:String,prevText:String,nextText:String,customBoxes:Array},data:function(){return{valueShow:"",writeVar:"",index:-1,valid:!0}},watch:{customBoxes:function(){this.refresh()}},mounted:function(){this.refresh()},methods:{refresh:function(){var t=!1;this.valid=!0;for(var e=0;e<this.customBoxes.length&&!t;++e)this.name===this.customBoxes[e].name&&("read"===this.mode?""!==this.customBoxes[e].value?this.valueShow=this.customBoxes[e].value:this.valueShow=this.customBoxes[e].defaultValue:"write"!==this.mode&&"modifyWrite"!==this.mode||(this.writeVar=this.customBoxes[e].value),this.index=e,t=!0);t||(this.valid=!1)},formatString:function(t){return String(t).substring(0,30)},formatNumber:function(t){return""===t?0:parseInt(String(t).substring(0,4))},updateValue:function(){this.$emit("saveWrite",this.writeVar,this.index)}}},na=ia,sa=(i("e852"),Object(_["a"])(na,ta,ea,!1,null,"a9277048",null)),aa=sa.exports,oa={name:"readBook",components:{LoadingModal:ke,ChangeSectionReading:Gn,RepeatSectionReading:Yn,DecisionMakingReading:as,RiddleReading:ds,RandomNumberReading:vs,ExpandableTextReading:Ss,PopupTextReading:Os,SequenceReading:Is,MemoryCardsReading:js,SpoilerReading:Gs,CompleteCluesReading:Ys,CustomBoxesReading:aa},data:function(){return{loading:!1,sectionExists:!0,searchNick:A.state.userNick.concat("_historial").toLowerCase(),currentSectionID:"",sectionGadgets:[],sectionsData:[],sectionName:"",book:A.state.openedBook,bookID:A.state.openBookID,customBoxes:[],showInfoPublic:!1}},mounted:function(){void 0!==this.bookID&&this.addBookToLibrary(),this.loadSection(A.state.sectionID),this.loadBook()},methods:{loadBook:function(){var t,e=this;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:return this.loading=!0,this.sectionsData=[],this.customBoxes=[],i.next=5,regeneratorRuntime.awrap(v.doc(this.bookID).get().then((function(t){e.customBoxes=t.data().customBoxes,e.book.sections=t.data().sections})));case 5:t=0;case 6:if(!(t<this.book.sections.length)){i.next=12;break}return i.next=9,regeneratorRuntime.awrap(g.doc(this.book.sections[t]).get().then((function(t){t.exists?(e.sectionExists=!0,e.sectionsData.push({value:t.id,text:t.data().name})):e.sectionExists=!1})));case 9:++t,i.next=6;break;case 12:this.loading=!1;case 13:case"end":return i.stop()}}),null,this)},loadSection:function(t){var e=this;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:if(""===t){i.next=8;break}return this.loading=!0,this.currentSectionID=t,this.sectionGadgets=[],this.sectionName="",i.next=7,regeneratorRuntime.awrap(g.doc(t).get().then((function(i){i.exists?(e.sectionExists=!0,e.sectionGadgets=i.data().gadgets,e.sectionName=i.data().name,A.commit("changeSection",t)):e.sectionExists=!1})));case 7:this.loading=!1;case 8:case"end":return i.stop()}}),null,this)},addBookToLibrary:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:if(""===this.bookID){e.next=7;break}return e.next=3,regeneratorRuntime.awrap(x.doc(this.searchNick).get().then((function(e){e.exists&&(t=e.data().array_keys)})));case 3:return t.unshift(this.bookID),t.length>20&&t.splice(20,t.length-20),e.next=7,regeneratorRuntime.awrap(x.doc(this.searchNick).update({array_keys:t}));case 7:case"end":return e.stop()}}),null,this)},basicGadget:function(t){return"Título"===t.componentName||"Texto normal"===t.componentName||"Picture"===t.component||"Hyperlink"===t.component||"Video"===t.component},saveCustomBox:function(t,e){var i=this.customBoxes[e];i.value=t,this.$set(this.customBoxes,e,i)},isBookOfLoggedUser:function(){return this.book.userID===A.state.userID},goEdit:function(){this.$router.replace({name:"editBook"})},togglePublic:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return this.book.published=!this.book.published,t.next=3,regeneratorRuntime.awrap(v.doc(this.bookID).update({published:this.book.published}));case 3:case"end":return t.stop()}}),null,this)},goBack:function(){!1===A.state.sectionPreview?A.commit("closeBook"):A.commit("switchSectionPreview",!1),this.$router.go(-1)},isNotPreview:function(){return!1===A.state.sectionPreview},emptyBook:function(){if(0===this.sectionGadgets.length)return!0;var t=["Normal","Header1","Header2","Header3","Picture","Video","ChangeSection","DecisionMaking","Riddle"],e=!0,i=!1,n=void 0;try{for(var s,a=this.sectionGadgets[Symbol.iterator]();!(e=(s=a.next()).done);e=!0){var o=s.value;if(!t.includes(o.component))return!1;if(("Header1"===o.component||"Header2"===o.component||"Header3"===o.component)&&""!==o.plainText)return!1;if(("Normal"===o.component||"Picture"===o.component||"Video"===o.component)&&""!==o.htmlText)return!1;if("CustomBox"===o.component&&""!==o.name)return!1;if(("ChangeSection"===o.component||"DecisionMaking"===o.component||"Riddle"===o.component)&&this.book.sections.length>1)return!1}}catch(r){i=!0,n=r}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}return!0},showInfoModal:function(){!0===this.book.published&&(this.showInfoPublic=!0)}}},ra=oa,ca=(i("5140"),Object(_["a"])(ra,$n,jn,!1,null,"590bfb92",null)),la=ca.exports;n["default"].use(H["a"]);var ua=[{path:"/user",name:"user",component:it},{path:"/",name:"home",component:pt},{path:"/books",name:"books",component:Lt},{path:"/libraries",name:"libraries",component:ie},{path:"/viewLibrary",name:"viewLibrary",component:ce,props:!0},{path:"/editBooks/readBook",name:"readBook",component:la,props:!0},{path:"/editBooks/editBook",name:"editBook",component:Wn,props:!0}],da=new H["a"]({routes:ua}),ha=da,ma=i("0ff2"),pa=i("5f5b"),fa=i("b1e0");i("f9e3"),i("2dd8");n["default"].use(pa["a"]),n["default"].use(fa["a"]),n["default"].use(ma["a"]),n["default"].config.productionTip=!1,new n["default"]({router:ha,store:void 0,render:function(t){return t(U)}}).$mount("#app")},"579b":function(t,e,i){},5940:function(t,e,i){},"594a":function(t,e,i){"use strict";var n=i("5940"),s=i.n(n);s.a},"5de4":function(t,e,i){},"5f05":function(t,e,i){"use strict";var n=i("4618"),s=i.n(n);s.a},6114:function(t,e,i){},"63f3":function(t,e,i){},"655c":function(t,e,i){"use strict";var n=i("7348"),s=i.n(n);s.a},"665a":function(t,e,i){},6961:function(t,e,i){},"703c":function(t,e,i){"use strict";var n=i("c519"),s=i.n(n);s.a},"71ee":function(t,e,i){"use strict";var n=i("18e5"),s=i.n(n);s.a},7348:function(t,e,i){},7371:function(t,e,i){"use strict";var n=i("9e6b"),s=i.n(n);s.a},7500:function(t,e,i){},"76da":function(t,e,i){"use strict";var n=i("4a83"),s=i.n(n);s.a},7759:function(t,e,i){"use strict";var n=i("7500"),s=i.n(n);s.a},"7a4b":function(t,e,i){"use strict";var n=i("1fbf"),s=i.n(n);s.a},"7c25":function(t,e,i){"use strict";var n=i("2e1f"),s=i.n(n);s.a},"7d9c":function(t,e,i){"use strict";var n=i("6961"),s=i.n(n);s.a},8261:function(t,e,i){"use strict";var n=i("5467"),s=i.n(n);s.a},"850d":function(t,e,i){"use strict";var n=i("fc1c"),s=i.n(n);s.a},"85ec":function(t,e,i){},"8d8f":function(t,e,i){},"8dab":function(t,e,i){"use strict";var n=i("b688"),s=i.n(n);s.a},9058:function(t,e,i){},9825:function(t,e,i){"use strict";var n=i("2bf7"),s=i.n(n);s.a},"9d28":function(t,e,i){"use strict";var n=i("e3b0"),s=i.n(n);s.a},"9e02":function(t,e,i){},"9e6b":function(t,e,i){},a244:function(t,e,i){"use strict";var n=i("025a"),s=i.n(n);s.a},a478:function(t,e,i){},a6ed:function(t,e,i){"use strict";var n=i("2ac2"),s=i.n(n);s.a},a90d:function(t,e,i){"use strict";var n=i("df1f"),s=i.n(n);s.a},b380:function(t,e,i){t.exports=i.p+"img/fiktin_logo_blanco.3bf7fb00.png"},b40d:function(t,e,i){},b628:function(t,e,i){},b688:function(t,e,i){},b96f:function(t,e,i){},baad:function(t,e,i){"use strict";var n=i("9058"),s=i.n(n);s.a},bad0:function(t,e,i){"use strict";var n=i("ddc5"),s=i.n(n);s.a},c098:function(t,e,i){},c143:function(t,e,i){"use strict";var n=i("324c"),s=i.n(n);s.a},c204:function(t,e,i){"use strict";var n=i("3f1e"),s=i.n(n);s.a},c252:function(t,e,i){"use strict";var n=i("579b"),s=i.n(n);s.a},c463:function(t,e,i){"use strict";var n=i("cb0b"),s=i.n(n);s.a},c519:function(t,e,i){},c531:function(t,e,i){"use strict";var n=i("0a98"),s=i.n(n);s.a},c85b:function(t,e,i){},c86d:function(t,e,i){"use strict";var n=i("9e02"),s=i.n(n);s.a},c9bd:function(t,e,i){},cb0b:function(t,e,i){},d3de:function(t,e,i){"use strict";var n=i("c098"),s=i.n(n);s.a},d72d:function(t,e,i){},d82ff:function(t,e,i){"use strict";var n=i("d72d"),s=i.n(n);s.a},ddc5:function(t,e,i){},df1f:function(t,e,i){},e16f:function(t,e,i){"use strict";var n=i("b40d"),s=i.n(n);s.a},e3b0:function(t,e,i){},e3e7:function(t,e,i){},e59b:function(t,e,i){},e852:function(t,e,i){"use strict";var n=i("b628"),s=i.n(n);s.a},eb8f:function(t,e,i){"use strict";var n=i("c85b"),s=i.n(n);s.a},f283:function(t,e,i){"use strict";var n=i("b96f"),s=i.n(n);s.a},f439:function(t,e,i){"use strict";var n=i("a478"),s=i.n(n);s.a},f6ff:function(t,e,i){"use strict";var n=i("63f3"),s=i.n(n);s.a},fa9c:function(t,e,i){"use strict";var n=i("557e"),s=i.n(n);s.a},fc1c:function(t,e,i){}});
//# sourceMappingURL=app.5d4c6ea5.js.map